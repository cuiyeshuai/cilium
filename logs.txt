level=debug msg="Skipped reading configuration file" error="Config File \"cilium\" Not Found in \"[/root]\"" subsys=config
level=info msg="Memory available for map entries (0.003% of 4124385280B): 10310963B" subsys=config
level=debug msg="Total memory for default map entries: 149422080" subsys=config
level=info msg="option bpf-ct-global-tcp-max set by dynamic sizing to 131072" subsys=config
level=info msg="option bpf-ct-global-any-max set by dynamic sizing to 65536" subsys=config
level=info msg="option bpf-nat-global-max set by dynamic sizing to 131072" subsys=config
level=info msg="option bpf-neigh-global-max set by dynamic sizing to 131072" subsys=config
level=info msg="option bpf-sock-rev-map-max set by dynamic sizing to 65536" subsys=config
level=info msg="  --agent-health-port='9879'" subsys=daemon
level=info msg="  --agent-labels=''" subsys=daemon
level=info msg="  --agent-not-ready-taint-key='node.cilium.io/agent-not-ready'" subsys=daemon
level=info msg="  --allocator-list-timeout='3m0s'" subsys=daemon
level=info msg="  --allow-icmp-frag-needed='true'" subsys=daemon
level=info msg="  --allow-localhost='auto'" subsys=daemon
level=info msg="  --annotate-k8s-node='false'" subsys=daemon
level=info msg="  --api-rate-limit=''" subsys=daemon
level=info msg="  --arping-refresh-period='30s'" subsys=daemon
level=info msg="  --auto-create-cilium-node-resource='true'" subsys=daemon
level=info msg="  --auto-direct-node-routes='true'" subsys=daemon
level=info msg="  --bgp-announce-lb-ip='false'" subsys=daemon
level=info msg="  --bgp-announce-pod-cidr='false'" subsys=daemon
level=info msg="  --bgp-config-path='/var/lib/cilium/bgp/config.yaml'" subsys=daemon
level=info msg="  --bpf-auth-map-max='524288'" subsys=daemon
level=info msg="  --bpf-ct-global-any-max='262144'" subsys=daemon
level=info msg="  --bpf-ct-global-tcp-max='524288'" subsys=daemon
level=info msg="  --bpf-ct-timeout-regular-any='1m0s'" subsys=daemon
level=info msg="  --bpf-ct-timeout-regular-tcp='6h0m0s'" subsys=daemon
level=info msg="  --bpf-ct-timeout-regular-tcp-fin='10s'" subsys=daemon
level=info msg="  --bpf-ct-timeout-regular-tcp-syn='1m0s'" subsys=daemon
level=info msg="  --bpf-ct-timeout-service-any='1m0s'" subsys=daemon
level=info msg="  --bpf-ct-timeout-service-tcp='6h0m0s'" subsys=daemon
level=info msg="  --bpf-ct-timeout-service-tcp-grace='1m0s'" subsys=daemon
level=info msg="  --bpf-filter-priority='1'" subsys=daemon
level=info msg="  --bpf-fragments-map-max='8192'" subsys=daemon
level=info msg="  --bpf-lb-acceleration='disabled'" subsys=daemon
level=info msg="  --bpf-lb-affinity-map-max='0'" subsys=daemon
level=info msg="  --bpf-lb-algorithm='random'" subsys=daemon
level=info msg="  --bpf-lb-dev-ip-addr-inherit=''" subsys=daemon
level=info msg="  --bpf-lb-dsr-dispatch='opt'" subsys=daemon
level=info msg="  --bpf-lb-dsr-l4-xlate='frontend'" subsys=daemon
level=info msg="  --bpf-lb-external-clusterip='false'" subsys=daemon
level=info msg="  --bpf-lb-maglev-hash-seed='JLfvgnHc2kaSUFaI'" subsys=daemon
level=info msg="  --bpf-lb-maglev-map-max='0'" subsys=daemon
level=info msg="  --bpf-lb-maglev-table-size='16381'" subsys=daemon
level=info msg="  --bpf-lb-map-max='65536'" subsys=daemon
level=info msg="  --bpf-lb-mode='snat'" subsys=daemon
level=info msg="  --bpf-lb-rev-nat-map-max='0'" subsys=daemon
level=info msg="  --bpf-lb-rss-ipv4-src-cidr=''" subsys=daemon
level=info msg="  --bpf-lb-rss-ipv6-src-cidr=''" subsys=daemon
level=info msg="  --bpf-lb-service-backend-map-max='0'" subsys=daemon
level=info msg="  --bpf-lb-service-map-max='0'" subsys=daemon
level=info msg="  --bpf-lb-sock='false'" subsys=daemon
level=info msg="  --bpf-lb-sock-hostns-only='true'" subsys=daemon
level=info msg="  --bpf-lb-source-range-map-max='0'" subsys=daemon
level=info msg="  --bpf-map-dynamic-size-ratio='0.0025'" subsys=daemon
level=info msg="  --bpf-map-event-buffers=''" subsys=daemon
level=info msg="  --bpf-nat-global-max='524288'" subsys=daemon
level=info msg="  --bpf-neigh-global-max='524288'" subsys=daemon
level=info msg="  --bpf-policy-map-max='16384'" subsys=daemon
level=info msg="  --bpf-root='/sys/fs/bpf'" subsys=daemon
level=info msg="  --bpf-sock-rev-map-max='262144'" subsys=daemon
level=info msg="  --bypass-ip-availability-upon-restore='false'" subsys=daemon
level=info msg="  --certificates-directory='/var/run/cilium/certs'" subsys=daemon
level=info msg="  --cflags=''" subsys=daemon
level=info msg="  --cgroup-root='/run/cilium/cgroupv2'" subsys=daemon
level=info msg="  --cilium-endpoint-gc-interval='5m0s'" subsys=daemon
level=info msg="  --cluster-health-port='4240'" subsys=daemon
level=info msg="  --cluster-id='0'" subsys=daemon
level=info msg="  --cluster-name='kind-kind'" subsys=daemon
level=info msg="  --clustermesh-config='/var/lib/cilium/clustermesh/'" subsys=daemon
level=info msg="  --cmdref=''" subsys=daemon
level=info msg="  --cni-chaining-mode='none'" subsys=daemon
level=info msg="  --cni-exclusive='true'" subsys=daemon
level=info msg="  --cni-log-file='/var/run/cilium/cilium-cni.log'" subsys=daemon
level=info msg="  --cnp-node-status-gc-interval='0s'" subsys=daemon
level=info msg="  --config=''" subsys=daemon
level=info msg="  --config-dir='/tmp/cilium/config-map'" subsys=daemon
level=info msg="  --config-sources='config-map:kube-system/cilium-config'" subsys=daemon
level=info msg="  --conntrack-gc-interval='0s'" subsys=daemon
level=info msg="  --crab='false'" subsys=daemon
level=info msg="  --crd-wait-timeout='5m0s'" subsys=daemon
level=info msg="  --custom-cni-conf='false'" subsys=daemon
level=info msg="  --datapath-mode='veth'" subsys=daemon
level=info msg="  --debug='true'" subsys=daemon
level=info msg="  --debug-verbose='datapath'" subsys=daemon
level=info msg="  --derive-masquerade-ip-addr-from-device=''" subsys=daemon
level=info msg="  --devices=''" subsys=daemon
level=info msg="  --direct-routing-device=''" subsys=daemon
level=info msg="  --disable-cnp-status-updates='true'" subsys=daemon
level=info msg="  --disable-endpoint-crd='false'" subsys=daemon
level=info msg="  --disable-envoy-version-check='false'" subsys=daemon
level=info msg="  --disable-iptables-feeder-rules=''" subsys=daemon
level=info msg="  --dns-max-ips-per-restored-rule='1000'" subsys=daemon
level=info msg="  --dns-policy-unload-on-shutdown='false'" subsys=daemon
level=info msg="  --dnsproxy-concurrency-limit='0'" subsys=daemon
level=info msg="  --dnsproxy-concurrency-processing-grace-period='0s'" subsys=daemon
level=info msg="  --dnsproxy-lock-count='128'" subsys=daemon
level=info msg="  --dnsproxy-lock-timeout='500ms'" subsys=daemon
level=info msg="  --egress-gateway-policy-map-max='16384'" subsys=daemon
level=info msg="  --egress-masquerade-interfaces=''" subsys=daemon
level=info msg="  --egress-multi-home-ip-rule-compat='false'" subsys=daemon
level=info msg="  --enable-auto-protect-node-port-range='true'" subsys=daemon
level=info msg="  --enable-bandwidth-manager='false'" subsys=daemon
level=info msg="  --enable-bbr='false'" subsys=daemon
level=info msg="  --enable-bgp-control-plane='false'" subsys=daemon
level=info msg="  --enable-bpf-clock-probe='true'" subsys=daemon
level=info msg="  --enable-bpf-masquerade='false'" subsys=daemon
level=info msg="  --enable-bpf-tproxy='false'" subsys=daemon
level=info msg="  --enable-cilium-api-server-access='*'" subsys=daemon
level=info msg="  --enable-cilium-endpoint-slice='false'" subsys=daemon
level=info msg="  --enable-cilium-health-api-server-access='*'" subsys=daemon
level=info msg="  --enable-custom-calls='false'" subsys=daemon
level=info msg="  --enable-endpoint-health-checking='true'" subsys=daemon
level=info msg="  --enable-endpoint-routes='false'" subsys=daemon
level=info msg="  --enable-envoy-config='false'" subsys=daemon
level=info msg="  --enable-external-ips='true'" subsys=daemon
level=info msg="  --enable-health-check-nodeport='true'" subsys=daemon
level=info msg="  --enable-health-checking='true'" subsys=daemon
level=info msg="  --enable-host-firewall='false'" subsys=daemon
level=info msg="  --enable-host-legacy-routing='false'" subsys=daemon
level=info msg="  --enable-host-port='true'" subsys=daemon
level=info msg="  --enable-hubble='true'" subsys=daemon
level=info msg="  --enable-hubble-recorder-api='true'" subsys=daemon
level=info msg="  --enable-icmp-rules='true'" subsys=daemon
level=info msg="  --enable-identity-mark='true'" subsys=daemon
level=info msg="  --enable-ip-masq-agent='false'" subsys=daemon
level=info msg="  --enable-ipsec='false'" subsys=daemon
level=info msg="  --enable-ipv4='true'" subsys=daemon
level=info msg="  --enable-ipv4-egress-gateway='false'" subsys=daemon
level=info msg="  --enable-ipv4-fragment-tracking='true'" subsys=daemon
level=info msg="  --enable-ipv4-masquerade='true'" subsys=daemon
level=info msg="  --enable-ipv6='false'" subsys=daemon
level=info msg="  --enable-ipv6-big-tcp='false'" subsys=daemon
level=info msg="  --enable-ipv6-masquerade='true'" subsys=daemon
level=info msg="  --enable-ipv6-ndp='false'" subsys=daemon
level=info msg="  --enable-k8s='true'" subsys=daemon
level=info msg="  --enable-k8s-api-discovery='false'" subsys=daemon
level=info msg="  --enable-k8s-endpoint-slice='true'" subsys=daemon
level=info msg="  --enable-k8s-event-handover='false'" subsys=daemon
level=info msg="  --enable-k8s-networkpolicy='true'" subsys=daemon
level=info msg="  --enable-k8s-terminating-endpoint='true'" subsys=daemon
level=info msg="  --enable-l2-neigh-discovery='true'" subsys=daemon
level=info msg="  --enable-l7-proxy='true'" subsys=daemon
level=info msg="  --enable-local-node-route='true'" subsys=daemon
level=info msg="  --enable-local-redirect-policy='false'" subsys=daemon
level=info msg="  --enable-mke='false'" subsys=daemon
level=info msg="  --enable-monitor='true'" subsys=daemon
level=info msg="  --enable-nat46x64-gateway='false'" subsys=daemon
level=info msg="  --enable-node-port='false'" subsys=daemon
level=info msg="  --enable-pmtu-discovery='false'" subsys=daemon
level=info msg="  --enable-policy='default'" subsys=daemon
level=info msg="  --enable-recorder='false'" subsys=daemon
level=info msg="  --enable-remote-node-identity='true'" subsys=daemon
level=info msg="  --enable-runtime-device-detection='false'" subsys=daemon
level=info msg="  --enable-sctp='false'" subsys=daemon
level=info msg="  --enable-service-topology='false'" subsys=daemon
level=info msg="  --enable-session-affinity='false'" subsys=daemon
level=info msg="  --enable-srv6='false'" subsys=daemon
level=info msg="  --enable-stale-cilium-endpoint-cleanup='true'" subsys=daemon
level=info msg="  --enable-svc-source-range-check='true'" subsys=daemon
level=info msg="  --enable-tracing='false'" subsys=daemon
level=info msg="  --enable-unreachable-routes='false'" subsys=daemon
level=info msg="  --enable-vtep='false'" subsys=daemon
level=info msg="  --enable-well-known-identities='false'" subsys=daemon
level=info msg="  --enable-wireguard='false'" subsys=daemon
level=info msg="  --enable-wireguard-userspace-fallback='false'" subsys=daemon
level=info msg="  --enable-xdp-prefilter='false'" subsys=daemon
level=info msg="  --enable-xt-socket-fallback='true'" subsys=daemon
level=info msg="  --encrypt-interface=''" subsys=daemon
level=info msg="  --encrypt-node='false'" subsys=daemon
level=info msg="  --endpoint-gc-interval='5m0s'" subsys=daemon
level=info msg="  --endpoint-queue-size='25'" subsys=daemon
level=info msg="  --endpoint-status=''" subsys=daemon
level=info msg="  --envoy-config-timeout='2m0s'" subsys=daemon
level=info msg="  --envoy-log=''" subsys=daemon
level=info msg="  --exclude-local-address=''" subsys=daemon
level=info msg="  --fixed-identity-mapping=''" subsys=daemon
level=info msg="  --fqdn-regex-compile-lru-size='1024'" subsys=daemon
level=info msg="  --gops-port='9890'" subsys=daemon
level=info msg="  --http-403-msg=''" subsys=daemon
level=info msg="  --http-idle-timeout='0'" subsys=daemon
level=info msg="  --http-max-grpc-timeout='0'" subsys=daemon
level=info msg="  --http-normalize-path='true'" subsys=daemon
level=info msg="  --http-request-timeout='3600'" subsys=daemon
level=info msg="  --http-retry-count='3'" subsys=daemon
level=info msg="  --http-retry-timeout='0'" subsys=daemon
level=info msg="  --hubble-disable-tls='false'" subsys=daemon
level=info msg="  --hubble-event-buffer-capacity='4095'" subsys=daemon
level=info msg="  --hubble-event-queue-size='0'" subsys=daemon
level=info msg="  --hubble-export-file-compress='false'" subsys=daemon
level=info msg="  --hubble-export-file-max-backups='5'" subsys=daemon
level=info msg="  --hubble-export-file-max-size-mb='10'" subsys=daemon
level=info msg="  --hubble-export-file-path=''" subsys=daemon
level=info msg="  --hubble-listen-address=':4244'" subsys=daemon
level=info msg="  --hubble-metrics=''" subsys=daemon
level=info msg="  --hubble-metrics-server=''" subsys=daemon
level=info msg="  --hubble-monitor-events=''" subsys=daemon
level=info msg="  --hubble-prefer-ipv6='false'" subsys=daemon
level=info msg="  --hubble-recorder-sink-queue-size='1024'" subsys=daemon
level=info msg="  --hubble-recorder-storage-path='/var/run/cilium/pcaps'" subsys=daemon
level=info msg="  --hubble-skip-unknown-cgroup-ids='true'" subsys=daemon
level=info msg="  --hubble-socket-path='/var/run/cilium/hubble.sock'" subsys=daemon
level=info msg="  --hubble-tls-cert-file='/var/lib/cilium/tls/hubble/server.crt'" subsys=daemon
level=info msg="  --hubble-tls-client-ca-files='/var/lib/cilium/tls/hubble/client-ca.crt'" subsys=daemon
level=info msg="  --hubble-tls-key-file='/var/lib/cilium/tls/hubble/server.key'" subsys=daemon
level=info msg="  --identity-allocation-mode='crd'" subsys=daemon
level=info msg="  --identity-change-grace-period='5s'" subsys=daemon
level=info msg="  --identity-gc-interval='15m0s'" subsys=daemon
level=info msg="  --identity-heartbeat-timeout='30m0s'" subsys=daemon
level=info msg="  --identity-restore-grace-period='10m0s'" subsys=daemon
level=info msg="  --install-egress-gateway-routes='false'" subsys=daemon
level=info msg="  --install-iptables-rules='true'" subsys=daemon
level=info msg="  --install-no-conntrack-iptables-rules='false'" subsys=daemon
level=info msg="  --ip-allocation-timeout='2m0s'" subsys=daemon
level=info msg="  --ip-masq-agent-config-path='/etc/config/ip-masq-agent'" subsys=daemon
level=info msg="  --ipam='kubernetes'" subsys=daemon
level=info msg="  --ipam-cilium-node-update-rate='15s'" subsys=daemon
level=info msg="  --ipsec-key-file=''" subsys=daemon
level=info msg="  --ipsec-key-rotation-duration='5m0s'" subsys=daemon
level=info msg="  --iptables-lock-timeout='5s'" subsys=daemon
level=info msg="  --iptables-random-fully='false'" subsys=daemon
level=info msg="  --ipv4-native-routing-cidr='10.0.0.0/24'" subsys=daemon
level=info msg="  --ipv4-node='auto'" subsys=daemon
level=info msg="  --ipv4-pod-subnets=''" subsys=daemon
level=info msg="  --ipv4-range='auto'" subsys=daemon
level=info msg="  --ipv4-service-loopback-address='169.254.42.1'" subsys=daemon
level=info msg="  --ipv4-service-range='auto'" subsys=daemon
level=info msg="  --ipv6-cluster-alloc-cidr='f00d::/64'" subsys=daemon
level=info msg="  --ipv6-mcast-device=''" subsys=daemon
level=info msg="  --ipv6-native-routing-cidr=''" subsys=daemon
level=info msg="  --ipv6-node='auto'" subsys=daemon
level=info msg="  --ipv6-pod-subnets=''" subsys=daemon
level=info msg="  --ipv6-range='auto'" subsys=daemon
level=info msg="  --ipv6-service-range='auto'" subsys=daemon
level=info msg="  --join-cluster='false'" subsys=daemon
level=info msg="  --k8s-api-server=''" subsys=daemon
level=info msg="  --k8s-client-burst='0'" subsys=daemon
level=info msg="  --k8s-client-qps='0'" subsys=daemon
level=info msg="  --k8s-heartbeat-timeout='30s'" subsys=daemon
level=info msg="  --k8s-kubeconfig-path=''" subsys=daemon
level=info msg="  --k8s-namespace='kube-system'" subsys=daemon
level=info msg="  --k8s-require-ipv4-pod-cidr='false'" subsys=daemon
level=info msg="  --k8s-require-ipv6-pod-cidr='false'" subsys=daemon
level=info msg="  --k8s-service-cache-size='128'" subsys=daemon
level=info msg="  --k8s-service-proxy-name=''" subsys=daemon
level=info msg="  --k8s-sync-timeout='3m0s'" subsys=daemon
level=info msg="  --k8s-watcher-endpoint-selector='metadata.name!=kube-scheduler,metadata.name!=kube-controller-manager,metadata.name!=etcd-operator,metadata.name!=gcp-controller-manager'" subsys=daemon
level=info msg="  --keep-config='false'" subsys=daemon
level=info msg="  --kube-proxy-replacement='strict'" subsys=daemon
level=info msg="  --kube-proxy-replacement-healthz-bind-address=''" subsys=daemon
level=info msg="  --kvstore=''" subsys=daemon
level=info msg="  --kvstore-connectivity-timeout='2m0s'" subsys=daemon
level=info msg="  --kvstore-lease-ttl='15m0s'" subsys=daemon
level=info msg="  --kvstore-max-consecutive-quorum-errors='2'" subsys=daemon
level=info msg="  --kvstore-opt=''" subsys=daemon
level=info msg="  --kvstore-periodic-sync='5m0s'" subsys=daemon
level=info msg="  --label-prefix-file=''" subsys=daemon
level=info msg="  --labels=''" subsys=daemon
level=info msg="  --lib-dir='/var/lib/cilium'" subsys=daemon
level=info msg="  --local-max-addr-scope='252'" subsys=daemon
level=info msg="  --local-router-ipv4=''" subsys=daemon
level=info msg="  --local-router-ipv6=''" subsys=daemon
level=info msg="  --log-driver=''" subsys=daemon
level=info msg="  --log-opt=''" subsys=daemon
level=info msg="  --log-system-load='false'" subsys=daemon
level=info msg="  --max-controller-interval='0'" subsys=daemon
level=info msg="  --mesh-auth-monitor-queue-size='1024'" subsys=daemon
level=info msg="  --mesh-auth-mtls-listener-port='0'" subsys=daemon
level=info msg="  --mesh-auth-rotated-identities-queue-size='1024'" subsys=daemon
level=info msg="  --mesh-auth-spiffe-trust-domain='spiffe.cilium'" subsys=daemon
level=info msg="  --mesh-auth-spire-admin-socket=''" subsys=daemon
level=info msg="  --metrics=''" subsys=daemon
level=info msg="  --mke-cgroup-mount=''" subsys=daemon
level=info msg="  --monitor-aggregation='none'" subsys=daemon
level=info msg="  --monitor-aggregation-flags='all'" subsys=daemon
level=info msg="  --monitor-aggregation-interval='5s'" subsys=daemon
level=info msg="  --monitor-queue-size='0'" subsys=daemon
level=info msg="  --mtu='0'" subsys=daemon
level=info msg="  --node-encryption-opt-out-labels='node-role.kubernetes.io/control-plane'" subsys=daemon
level=info msg="  --node-port-acceleration='disabled'" subsys=daemon
level=info msg="  --node-port-algorithm='random'" subsys=daemon
level=info msg="  --node-port-bind-protection='true'" subsys=daemon
level=info msg="  --node-port-mode='snat'" subsys=daemon
level=info msg="  --node-port-range='30000,32767'" subsys=daemon
level=info msg="  --nodes-gc-interval='5m0s'" subsys=daemon
level=info msg="  --operator-api-serve-addr='127.0.0.1:9234'" subsys=daemon
level=info msg="  --policy-audit-mode='false'" subsys=daemon
level=info msg="  --policy-queue-size='100'" subsys=daemon
level=info msg="  --policy-trigger-interval='1s'" subsys=daemon
level=info msg="  --pprof='false'" subsys=daemon
level=info msg="  --pprof-address='localhost'" subsys=daemon
level=info msg="  --pprof-port='6060'" subsys=daemon
level=info msg="  --preallocate-bpf-maps='false'" subsys=daemon
level=info msg="  --prepend-iptables-chains='true'" subsys=daemon
level=info msg="  --procfs='/host/proc'" subsys=daemon
level=info msg="  --prometheus-serve-addr=':9962'" subsys=daemon
level=info msg="  --proxy-connect-timeout='2'" subsys=daemon
level=info msg="  --proxy-gid='1337'" subsys=daemon
level=info msg="  --proxy-max-connection-duration-seconds='0'" subsys=daemon
level=info msg="  --proxy-max-requests-per-connection='0'" subsys=daemon
level=info msg="  --proxy-prometheus-port='0'" subsys=daemon
level=info msg="  --read-cni-conf=''" subsys=daemon
level=info msg="  --remove-cilium-node-taints='true'" subsys=daemon
level=info msg="  --restore='true'" subsys=daemon
level=info msg="  --route-metric='0'" subsys=daemon
level=info msg="  --routing-mode='native'" subsys=daemon
level=info msg="  --set-cilium-is-up-condition='true'" subsys=daemon
level=info msg="  --set-cilium-node-taints='true'" subsys=daemon
level=info msg="  --sidecar-istio-proxy-image='cilium/istio_proxy'" subsys=daemon
level=info msg="  --single-cluster-route='false'" subsys=daemon
level=info msg="  --skip-cnp-status-startup-clean='false'" subsys=daemon
level=info msg="  --socket-path='/var/run/cilium/cilium.sock'" subsys=daemon
level=info msg="  --srv6-encap-mode='reduced'" subsys=daemon
level=info msg="  --state-dir='/var/run/cilium'" subsys=daemon
level=info msg="  --synchronize-k8s-nodes='true'" subsys=daemon
level=info msg="  --tofqdns-dns-reject-response-code='refused'" subsys=daemon
level=info msg="  --tofqdns-enable-dns-compression='true'" subsys=daemon
level=info msg="  --tofqdns-endpoint-max-ip-per-hostname='50'" subsys=daemon
level=info msg="  --tofqdns-idle-connection-grace-period='0s'" subsys=daemon
level=info msg="  --tofqdns-max-deferred-connection-deletes='10000'" subsys=daemon
level=info msg="  --tofqdns-min-ttl='0'" subsys=daemon
level=info msg="  --tofqdns-pre-cache=''" subsys=daemon
level=info msg="  --tofqdns-proxy-port='0'" subsys=daemon
level=info msg="  --tofqdns-proxy-response-max-delay='100ms'" subsys=daemon
level=info msg="  --trace-payloadlen='128'" subsys=daemon
level=info msg="  --trace-sock='true'" subsys=daemon
level=info msg="  --tunnel=''" subsys=daemon
level=info msg="  --tunnel-port='0'" subsys=daemon
level=info msg="  --tunnel-protocol='vxlan'" subsys=daemon
level=info msg="  --unmanaged-pod-watcher-interval='15'" subsys=daemon
level=info msg="  --version='false'" subsys=daemon
level=info msg="  --vlan-bpf-bypass=''" subsys=daemon
level=info msg="  --vtep-cidr=''" subsys=daemon
level=info msg="  --vtep-endpoint=''" subsys=daemon
level=info msg="  --vtep-mac=''" subsys=daemon
level=info msg="  --vtep-mask=''" subsys=daemon
level=info msg="  --write-cni-conf-when-ready='/host/etc/cni/net.d/05-cilium.conflist'" subsys=daemon
level=debug msg="Enabling datapath debug messages" subsys=daemon
level=info msg="     _ _ _" subsys=daemon
level=info msg=" ___|_| |_|_ _ _____" subsys=daemon
level=info msg="|  _| | | | | |     |" subsys=daemon
level=info msg="|___|_|_|_|___|_|_|_|" subsys=daemon
level=info msg="Cilium 1.14.0-snapshot.2 57a56eb24e 2023-06-24T15:14:51+01:00 go version go1.20.3 linux/arm64" subsys=daemon
level=info msg="cilium-envoy  version: 3d6c80b860b9b39c616f835d9bdac281a81139ae/1.25.6/Distribution/RELEASE/BoringSSL" subsys=daemon
level=info msg="clang (10.0.0) and kernel (5.15.49) versions: OK!" subsys=linux-datapath
level=info msg="linking environment: OK!" subsys=linux-datapath
level=info msg="Detected mounted BPF filesystem at /sys/fs/bpf" subsys=bpf
level=info msg="Mounted cgroupv2 filesystem at /run/cilium/cgroupv2" subsys=cgroups
level=info msg="Parsing base label prefixes from default label list" subsys=labels-filter
level=info msg="Parsing additional label prefixes from user inputs: []" subsys=labels-filter
level=info msg="Final label prefixes to be used for identity evaluation:" subsys=labels-filter
level=info msg=" - reserved:.*" subsys=labels-filter
level=info msg=" - :io\\.kubernetes\\.pod\\.namespace" subsys=labels-filter
level=info msg=" - :io\\.cilium\\.k8s\\.namespace\\.labels" subsys=labels-filter
level=info msg=" - :app\\.kubernetes\\.io" subsys=labels-filter
level=info msg=" - !:io\\.kubernetes" subsys=labels-filter
level=info msg=" - !:kubernetes\\.io" subsys=labels-filter
level=info msg=" - !:.*beta\\.kubernetes\\.io" subsys=labels-filter
level=info msg=" - !:k8s\\.io" subsys=labels-filter
level=info msg=" - !:pod-template-generation" subsys=labels-filter
level=info msg=" - !:pod-template-hash" subsys=labels-filter
level=info msg=" - !:controller-revision-hash" subsys=labels-filter
level=info msg=" - !:annotation.*" subsys=labels-filter
level=info msg=" - !:etcd_node" subsys=labels-filter
level=info msg="Auto-disabling \"enable-bpf-clock-probe\" feature since KERNEL_HZ cannot be determined" error="open /proc/schedstat: no such file or directory" subsys=daemon
level=info msg="Using autogenerated IPv4 allocation range" subsys=node v4Prefix=10.2.0.0/16
level=debug msg=Invoking function="pprof.glob..func1 (cell.go:51)" subsys=hive
level=info msg=Invoked duration="787.834µs" function="pprof.glob..func1 (cell.go:51)" subsys=hive
level=debug msg=Invoking function="gops.registerGopsHooks (cell.go:39)" subsys=hive
level=info msg=Invoked duration="33.459µs" function="gops.registerGopsHooks (cell.go:39)" subsys=hive
level=debug msg=Invoking function="cmd.glob..func3 (daemon_main.go:1581)" subsys=hive
level=debug msg="getting identity cache for identity allocator manager" subsys=identity-cache
level=info msg="Spire Delegate API Client is disabled as no socket path is configured" subsys=spire-delegate
level=info msg="mTLS Auth Handler is disabled as no port is configured" subsys=auth-manager
level=info msg=Invoked duration=78.647292ms function="cmd.glob..func3 (daemon_main.go:1581)" subsys=hive
level=debug msg=Invoking function="utime.initUtimeSync (cell.go:30)" subsys=hive
level=info msg=Invoked duration="10.208µs" function="utime.initUtimeSync (cell.go:30)" subsys=hive
level=info msg=Starting subsys=hive
level=debug msg="Executing start hook" function="gops.registerGopsHooks.func1 (cell.go:44)" subsys=hive
level=info msg="Started gops server" address="127.0.0.1:9890" subsys=gops
level=info msg="Start hook executed" duration="793.083µs" function="gops.registerGopsHooks.func1 (cell.go:44)" subsys=hive
level=debug msg="Executing start hook" function="client.(*compositeClientset).onStart" subsys=hive
level=info msg="Establishing connection to apiserver" host="https://10.96.0.1:443" subsys=k8s-client
level=info msg="Connected to apiserver" subsys=k8s-client
level=debug msg="Starting new controller" name=k8s-heartbeat subsys=controller uuid=8b179a2a-bc87-4c5e-a743-24af6100c990
level=debug msg="Skipping Leases support fallback discovery" subsys=k8s
level=info msg="Start hook executed" duration=13.341875ms function="client.(*compositeClientset).onStart" subsys=hive
level=debug msg="Executing start hook" function="authmap.newAuthMap.func1 (cell.go:28)" subsys=hive
level=debug msg="Controller func execution time: 1.611584ms" name=k8s-heartbeat subsys=controller uuid=8b179a2a-bc87-4c5e-a743-24af6100c990
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_auth_map subsys=ebpf
level=info msg="Start hook executed" duration=4.470458ms function="authmap.newAuthMap.func1 (cell.go:28)" subsys=hive
level=debug msg="Executing start hook" function="configmap.newMap.func1 (cell.go:24)" subsys=hive
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_runtime_config subsys=bpf
level=info msg="Start hook executed" duration="109.375µs" function="configmap.newMap.func1 (cell.go:24)" subsys=hive
level=debug msg="Executing start hook" function="datapath.newDatapath.func1 (cells.go:85)" subsys=hive
level=info msg="Start hook executed" duration=32.612ms function="datapath.newDatapath.func1 (cells.go:85)" subsys=hive
level=debug msg="Executing start hook" function="*resource.resource[*github.com/cilium/cilium/pkg/k8s/slim/k8s/api/core/v1.Service].Start" subsys=hive
level=info msg="Start hook executed" duration="35.875µs" function="*resource.resource[*github.com/cilium/cilium/pkg/k8s/slim/k8s/api/core/v1.Service].Start" subsys=hive
level=debug msg="Executing start hook" function="*gobgp.diffStore[*github.com/cilium/cilium/pkg/k8s/slim/k8s/api/core/v1.Service].Start" subsys=hive
level=info msg="Start hook executed" duration=200.343125ms function="*gobgp.diffStore[*github.com/cilium/cilium/pkg/k8s/slim/k8s/api/core/v1.Service].Start" subsys=hive
level=debug msg="Executing start hook" function="*resource.resource[*k8s.io/api/core/v1.Node].Start" subsys=hive
level=info msg="Start hook executed" duration="2.667µs" function="*resource.resource[*k8s.io/api/core/v1.Node].Start" subsys=hive
level=debug msg="Executing start hook" function="*resource.resource[*github.com/cilium/cilium/pkg/k8s/apis/cilium.io/v2.CiliumNode].Start" subsys=hive
level=info msg="Start hook executed" duration="1.75µs" function="*resource.resource[*github.com/cilium/cilium/pkg/k8s/apis/cilium.io/v2.CiliumNode].Start" subsys=hive
level=debug msg="Executing start hook" function="*resource.resource[*github.com/cilium/cilium/pkg/k8s/slim/k8s/api/core/v1.Namespace].Start" subsys=hive
level=info msg="Start hook executed" duration="1.125µs" function="*resource.resource[*github.com/cilium/cilium/pkg/k8s/slim/k8s/api/core/v1.Namespace].Start" subsys=hive
level=debug msg="Executing start hook" function="*resource.resource[*github.com/cilium/cilium/pkg/k8s/apis/cilium.io/v2alpha1.CiliumLoadBalancerIPPool].Start" subsys=hive
level=info msg="Start hook executed" duration="1.083µs" function="*resource.resource[*github.com/cilium/cilium/pkg/k8s/apis/cilium.io/v2alpha1.CiliumLoadBalancerIPPool].Start" subsys=hive
level=debug msg="Executing start hook" function="*resource.resource[*github.com/cilium/cilium/pkg/k8s/apis/cilium.io/v2.CiliumIdentity].Start" subsys=hive
level=info msg="Start hook executed" duration=958ns function="*resource.resource[*github.com/cilium/cilium/pkg/k8s/apis/cilium.io/v2.CiliumIdentity].Start" subsys=hive
level=debug msg="Executing start hook" function="*resource.resource[*github.com/cilium/cilium/pkg/k8s/apis/cilium.io/v2.CiliumNetworkPolicy].Start" subsys=hive
level=info msg="Start hook executed" duration="8.25µs" function="*resource.resource[*github.com/cilium/cilium/pkg/k8s/apis/cilium.io/v2.CiliumNetworkPolicy].Start" subsys=hive
level=debug msg="Executing start hook" function="*resource.resource[*github.com/cilium/cilium/pkg/k8s/apis/cilium.io/v2.CiliumClusterwideNetworkPolicy].Start" subsys=hive
level=info msg="Start hook executed" duration="1.167µs" function="*resource.resource[*github.com/cilium/cilium/pkg/k8s/apis/cilium.io/v2.CiliumClusterwideNetworkPolicy].Start" subsys=hive
level=debug msg="Executing start hook" function="*resource.resource[*github.com/cilium/cilium/pkg/k8s/apis/cilium.io/v2alpha1.CiliumCIDRGroup].Start" subsys=hive
level=info msg="Start hook executed" duration="2.166µs" function="*resource.resource[*github.com/cilium/cilium/pkg/k8s/apis/cilium.io/v2alpha1.CiliumCIDRGroup].Start" subsys=hive
level=debug msg="Executing start hook" function="endpointmanager.newDefaultEndpointManager.func1 (cell.go:185)" subsys=hive
level=debug msg="Starting new controller" name=endpoint-gc subsys=controller uuid=a5d94e43-7098-4151-93ff-a023c449f453
level=info msg="Start hook executed" duration="16.792µs" function="endpointmanager.newDefaultEndpointManager.func1 (cell.go:185)" subsys=hive
level=debug msg="Executing start hook" function="cmd.newPolicyTrifecta.func1 (policy.go:129)" subsys=hive
level=debug msg="creating new EventQueue" name=repository-change-queue numBufferedEvents=100 subsys=eventqueue
level=debug msg="Controller func execution time: 1.834µs" name=endpoint-gc subsys=controller uuid=a5d94e43-7098-4151-93ff-a023c449f453
level=debug msg="creating new EventQueue" name=repository-reaction-queue numBufferedEvents=100 subsys=eventqueue
level=info msg="Start hook executed" duration="65.25µs" function="cmd.newPolicyTrifecta.func1 (policy.go:129)" subsys=hive
level=debug msg="Executing start hook" function="*manager.manager.Start" subsys=hive
level=info msg="Start hook executed" duration="281.792µs" function="*manager.manager.Start" subsys=hive
level=debug msg="Executing start hook" function="monitor.(*dropMonitor).OnStart" subsys=hive
level=info msg="Start hook executed" duration="12.666µs" function="monitor.(*dropMonitor).OnStart" subsys=hive
level=debug msg="Executing start hook" function="*cni.cniConfigManager.Start" subsys=hive
level=debug msg="Performing regular background work" subsys=nodemanager syncInterval=1m0s
level=debug msg="Starting new controller" name=write-cni-file subsys=controller uuid=864959ad-961f-4293-bc43-6b31b80f1fbe
level=info msg="Start hook executed" duration="430.25µs" function="*cni.cniConfigManager.Start" subsys=hive
level=debug msg="Executing start hook" function="cmd.newDaemonPromise.func1 (daemon_main.go:1629)" subsys=hive
level=info msg="Generating CNI configuration file with mode none" subsys=cni-config
level=info msg="Auto-enabling \"enable-node-port\", \"enable-external-ips\", \"bpf-lb-sock\", \"enable-host-port\", \"enable-session-affinity\" features" subsys=daemon
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_test subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_test subsys=bpf
level=debug msg="enabling events buffer" file-path= name=cilium_lb4_services_v2 size=128 subsys=bpf ttl=0s
level=debug msg="enabling events buffer" file-path= name=cilium_lb4_backends_v2 size=128 subsys=bpf ttl=0s
level=debug msg="enabling events buffer" file-path= name=cilium_lb4_backends_v3 size=128 subsys=bpf ttl=0s
level=debug msg="enabling events buffer" file-path= name=cilium_lb4_reverse_nat size=128 subsys=bpf ttl=0s
level=debug msg="enabling events buffer" file-path= name=cilium_lb_affinity_match size=128 subsys=bpf ttl=0s
level=debug msg="enabling events buffer" file-path= name=cilium_lb4_source_range size=128 subsys=bpf ttl=0s
level=info msg="Activity in /host/etc/cni/net.d/, re-generating CNI configuration" subsys=cni-config
level=info msg="Activity in /host/etc/cni/net.d/, re-generating CNI configuration" subsys=cni-config
level=info msg="Activity in /host/etc/cni/net.d/, re-generating CNI configuration" subsys=cni-config
level=info msg="Activity in /host/etc/cni/net.d/, re-generating CNI configuration" subsys=cni-config
level=info msg="Inheriting MTU from external network interface" device=eth0 ipAddr=172.27.0.2 mtu=1500 subsys=mtu
level=debug msg="enabling events buffer" file-path= name=cilium_ipcache size=1024 subsys=bpf ttl=0s
level=debug msg="creating new EventQueue" name=config-modify-queue numBufferedEvents=10 subsys=eventqueue
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ipcache subsys=bpf
level=info msg="Wrote CNI configuration file to /host/etc/cni/net.d/05-cilium.conflist" subsys=cni-config
level=info msg="Activity in /host/etc/cni/net.d/, re-generating CNI configuration" subsys=cni-config
level=info msg="Activity in /host/etc/cni/net.d/, re-generating CNI configuration" subsys=cni-config
level=debug msg="Controller func execution time: 2.386292ms" name=write-cni-file subsys=controller uuid=864959ad-961f-4293-bc43-6b31b80f1fbe
level=debug msg="Controller run succeeded; waiting for next controller update or stop" name=write-cni-file subsys=controller uuid=864959ad-961f-4293-bc43-6b31b80f1fbe
level=info msg="Generating CNI configuration file with mode none" subsys=cni-config
level=debug msg="Existing CNI configuration file /host/etc/cni/net.d/05-cilium.conflist unchanged" subsys=cni-config
level=debug msg="Controller func execution time: 139.708µs" name=write-cni-file subsys=controller uuid=864959ad-961f-4293-bc43-6b31b80f1fbe
level=debug msg="Controller run succeeded; waiting for next controller update or stop" name=write-cni-file subsys=controller uuid=864959ad-961f-4293-bc43-6b31b80f1fbe
level=info msg="Envoy: Starting xDS gRPC server listening on /var/run/cilium/xds.sock" subsys=envoy-manager
level=debug msg="enabling events buffer" file-path= name=cilium_lxc size=128 subsys=bpf ttl=0s
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_lxc subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ipcache subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_node_map subsys=ebpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_metrics subsys=ebpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_lb4_reverse_sk subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_lb4_reverse_sk subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_lb4_services_v2 subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_lb4_backends_v3 subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_lb4_reverse_nat subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_events subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_events subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_signals subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_signals subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_call_policy subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_call_policy subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_nodeport_neigh4 subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_nodeport_neigh4 subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ipv4_frag_datagrams subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ipv4_frag_datagrams subsys=bpf
level=debug msg="Starting new controller" name=metricsmap-bpf-prom-sync subsys=controller uuid=e93fb8e5-7d52-4e3b-a7c4-8bc7f60ca14d
level=debug msg="Controller func execution time: 18.875µs" name=metricsmap-bpf-prom-sync subsys=controller uuid=e93fb8e5-7d52-4e3b-a7c4-8bc7f60ca14d
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_lb_affinity_match subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_lb4_affinity subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_lb4_source_range subsys=bpf
level=info msg="Restored 0 node IDs from the BPF map" subsys=linux-datapath
level=info msg="Restored services from maps" failedServices=0 restoredServices=0 subsys=service
level=info msg="Restored backends from maps" failedBackends=0 restoredBackends=0 skippedBackends=0 subsys=service
level=info msg="Reading old endpoints..." subsys=daemon
level=info msg="No old endpoints found." subsys=daemon
level=debug msg="Starting new controller" name=dns-garbage-collector-job subsys=controller uuid=e84919a0-1308-4b66-97c6-479199643df7
level=debug msg="Running 'iptables -t mangle -n -L CILIUM_PRE_mangle' command" subsys=iptables
level=debug msg="Controller func execution time: 2.25µs" name=dns-garbage-collector-job subsys=controller uuid=e84919a0-1308-4b66-97c6-479199643df7
level=debug msg="DNS Proxy port is configured to 0. A random port will be assigned by the OS." subsys=fqdn/dnsproxy
level=debug msg="DNS Proxy bound to address" address="[::]:38031" subsys=fqdn/dnsproxy
level=info msg="Waiting until all Cilium CRDs are available" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="crd:ciliumclusterwidenetworkpolicies.cilium.io" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="crd:ciliumidentities.cilium.io" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="crd:ciliumnodes.cilium.io" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="crd:ciliumnodeconfigs.cilium.io" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="crd:ciliumcidrgroups.cilium.io" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="crd:ciliumloadbalancerippools.cilium.io" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="crd:ciliumendpoints.cilium.io" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="crd:ciliumnetworkpolicies.cilium.io" subsys=k8s
level=debug msg="cache synced" kubernetesResource="crd:ciliumnetworkpolicies.cilium.io" subsys=k8s
level=debug msg="cache synced" kubernetesResource="crd:ciliumcidrgroups.cilium.io" subsys=k8s
level=debug msg="cache synced" kubernetesResource="crd:ciliumidentities.cilium.io" subsys=k8s
level=debug msg="cache synced" kubernetesResource="crd:ciliumnodes.cilium.io" subsys=k8s
level=debug msg="cache synced" kubernetesResource="crd:ciliumnodeconfigs.cilium.io" subsys=k8s
level=debug msg="cache synced" kubernetesResource="crd:ciliumendpoints.cilium.io" subsys=k8s
level=debug msg="cache synced" kubernetesResource="crd:ciliumloadbalancerippools.cilium.io" subsys=k8s
level=debug msg="cache synced" kubernetesResource="crd:ciliumclusterwidenetworkpolicies.cilium.io" subsys=k8s
level=info msg="All Cilium CRDs have been found and are available" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="core/v1::Node" subsys=k8s
level=debug msg="cache synced" kubernetesResource="core/v1::Node" subsys=k8s
level=info msg="Retrieved node information from kubernetes node" nodeName=kind-worker2 subsys=k8s
level=info msg="Received own node information from API server" ipAddr.ipv4=172.27.0.2 ipAddr.ipv6="fc00:c111::2" k8sNodeIP=172.27.0.2 labels="map[beta.kubernetes.io/arch:arm64 beta.kubernetes.io/os:linux kubernetes.io/arch:arm64 kubernetes.io/hostname:kind-worker2 kubernetes.io/os:linux]" nodeName=kind-worker2 subsys=k8s v4Prefix=10.244.3.0/24 v6Prefix="fd00:10:244:3::/64"
level=info msg="k8s mode: Allowing localhost to reach local endpoints" subsys=daemon
level=info msg="Direct routing device detected" direct-routing-device=eth0 subsys=linux-datapath
level=info msg="Detected devices" devices="[eth0]" subsys=linux-datapath
level=info msg="BPF host routing requires enable-bpf-masquerade. Falling back to legacy host routing (enable-host-legacy-routing=true)." subsys=daemon
level=info msg="Enabling k8s event listener" subsys=k8s-watcher
level=debug msg="waiting for cache to synchronize" kubernetesResource="core/v1::Service" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="core/v1::Namespace" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="core/v1::Pods" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="networking.k8s.io/v1::NetworkPolicy" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="discovery/v1::EndpointSlice" subsys=k8s
level=debug msg="Skip pod event using host networking" hostIP=172.27.0.2 k8sNamespace=kube-system k8sPodName=kube-proxy-p52ms podIP=172.27.0.2 podIPs="[{172.27.0.2} {fc00:c111::2}]" subsys=k8s-watcher
level=debug msg="Skip pod event using host networking" hostIP=172.27.0.2 k8sNamespace=kube-system k8sPodName=cilium-cp565 podIP=172.27.0.2 podIPs="[{172.27.0.2} {fc00:c111::2}]" subsys=k8s-watcher
level=debug msg="Processing 1 endpoints for EndpointSlice kubernetes" subsys=k8s
level=debug msg="EndpointSlice kubernetes has 1 backends" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="cilium/v2::CiliumNode" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="cilium/v2::CiliumClusterwideNetworkPolicy" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="cilium/v2alpha1::CiliumCIDRGroup" subsys=k8s
level=debug msg="waiting for cache to synchronize" kubernetesResource="cilium/v2::CiliumEndpoint" subsys=k8s
level=debug msg="Kubernetes service definition changed" action=service-updated endpoints="172.27.0.4:6443/TCP" k8sNamespace=default k8sSvcName=kubernetes old-service=nil service="frontends:[10.96.0.1]/ports=[https]/selector=map[]" subsys=k8s-watcher
level=info msg="Removing stale endpoint interfaces" subsys=daemon
level=debug msg="Upserting service" backends="[172.27.0.4:6443]" l7LBFrontendPorts="[]" l7LBProxyPort=0 loadBalancerSourceRanges="[]" serviceIP="{10.96.0.1 {TCP 443} 0}" serviceName=kubernetes serviceNamespace=default sessionAffinity=false sessionAffinityTimeout=0 subsys=service svcExtTrafficPolicy=Cluster svcHealthCheckNodePort=0 svcIntTrafficPolicy=Cluster svcType=ClusterIP
level=debug msg="Resolving service" l3n4Addr="{AddrCluster:10.96.0.1 L4Addr:{Protocol:TCP Port:443} Scope:0}" subsys=service
level=debug msg="Acquired service ID" backends="[172.27.0.4:6443]" l7LBFrontendPorts="[]" l7LBProxyPort=0 loadBalancerSourceRanges="[]" serviceID=1 serviceIP="{10.96.0.1 {TCP 443} 0}" serviceName=kubernetes serviceNamespace=default sessionAffinity=false sessionAffinityTimeout=0 subsys=service svcExtTrafficPolicy=Cluster svcHealthCheckNodePort=0 svcIntTrafficPolicy=Cluster svcType=ClusterIP
level=debug msg="Deleting backends from session affinity match" backends="[]" serviceID=1 subsys=service
level=debug msg="Adding new backend" backendID=1 backendWeight=100 backends="[172.27.0.4:6443]" l3n4Addr="{172.27.0.4 {TCP 6443} 0}" l7LBFrontendPorts="[]" l7LBProxyPort=0 loadBalancerSourceRanges="[]" serviceID=1 serviceIP="{10.96.0.1 {TCP 443} 0}" serviceName=kubernetes serviceNamespace=default sessionAffinity=false sessionAffinityTimeout=0 subsys=service svcExtTrafficPolicy=Cluster svcHealthCheckNodePort=0 svcIntTrafficPolicy=Cluster svcType=ClusterIP
level=info msg="Skipping kvstore configuration" subsys=daemon
level=info msg="Initializing node addressing" subsys=daemon
level=info msg="Initializing kubernetes IPAM" subsys=ipam v4Prefix=10.244.3.0/24 v6Prefix="<nil>"
level=debug msg="Upserted service entry" backendSlot=1 subsys=map-lb svcKey="10.96.0.1:47873" svcVal="1 0 (256) [0x0 0x0]"
level=debug msg="Upserted service entry" backendSlot=0 subsys=map-lb svcKey="10.96.0.1:47873" svcVal="0 1 (256) [0x0 0x0]"
level=debug msg="Adding backends to affinity match map" backends="[]" serviceID=1 subsys=service
level=debug msg="waiting for cache to synchronize" kubernetesResource="cilium/v2::CiliumNetworkPolicy" subsys=k8s
level=info msg="Waiting until local node addressing before starting watchers depending on it" subsys=k8s-watcher
level=debug msg="Starting new controller" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Processing 0 endpoints for EndpointSlice kube-dns-pnq7d" subsys=k8s
level=debug msg="EndpointSlice kube-dns-pnq7d has 0 backends" subsys=k8s
level=debug msg="Kubernetes service definition changed" action=service-updated endpoints= k8sNamespace=kube-system k8sSvcName=kube-dns old-service=nil service="frontends:[10.96.0.10]/ports=[dns dns-tcp metrics]/selector=map[k8s-app:kube-dns]" subsys=k8s-watcher
level=debug msg="Upserting service" backends="[]" l7LBFrontendPorts="[]" l7LBProxyPort=0 loadBalancerSourceRanges="[]" serviceIP="{10.96.0.10 {TCP 9153} 0}" serviceName=kube-dns serviceNamespace=kube-system sessionAffinity=false sessionAffinityTimeout=0 subsys=service svcExtTrafficPolicy=Cluster svcHealthCheckNodePort=0 svcIntTrafficPolicy=Cluster svcType=ClusterIP
level=debug msg="Resolving service" l3n4Addr="{AddrCluster:10.96.0.10 L4Addr:{Protocol:TCP Port:9153} Scope:0}" subsys=service
level=debug msg="Acquired service ID" backends="[]" l7LBFrontendPorts="[]" l7LBProxyPort=0 loadBalancerSourceRanges="[]" serviceID=2 serviceIP="{10.96.0.10 {TCP 9153} 0}" serviceName=kube-dns serviceNamespace=kube-system sessionAffinity=false sessionAffinityTimeout=0 subsys=service svcExtTrafficPolicy=Cluster svcHealthCheckNodePort=0 svcIntTrafficPolicy=Cluster svcType=ClusterIP
level=debug msg="Deleting backends from session affinity match" backends="[]" serviceID=2 subsys=service
level=info msg="Restoring endpoints..." subsys=daemon
level=debug msg="Upserted service entry" backendSlot=0 subsys=map-lb svcKey="10.96.0.10:49443" svcVal="0 0 (512) [0x0 0x0]"
level=debug msg="Adding backends to affinity match map" backends="[]" serviceID=2 subsys=service
level=debug msg="Upserting service" backends="[]" l7LBFrontendPorts="[]" l7LBProxyPort=0 loadBalancerSourceRanges="[]" serviceIP="{10.96.0.10 {UDP 53} 0}" serviceName=kube-dns serviceNamespace=kube-system sessionAffinity=false sessionAffinityTimeout=0 subsys=service svcExtTrafficPolicy=Cluster svcHealthCheckNodePort=0 svcIntTrafficPolicy=Cluster svcType=ClusterIP
level=debug msg="Resolving service" l3n4Addr="{AddrCluster:10.96.0.10 L4Addr:{Protocol:UDP Port:53} Scope:0}" subsys=service
level=debug msg="Acquired service ID" backends="[]" l7LBFrontendPorts="[]" l7LBProxyPort=0 loadBalancerSourceRanges="[]" serviceID=3 serviceIP="{10.96.0.10 {UDP 53} 0}" serviceName=kube-dns serviceNamespace=kube-system sessionAffinity=false sessionAffinityTimeout=0 subsys=service svcExtTrafficPolicy=Cluster svcHealthCheckNodePort=0 svcIntTrafficPolicy=Cluster svcType=ClusterIP
level=debug msg="Deleting backends from session affinity match" backends="[]" serviceID=3 subsys=service
level=debug msg="Upserted service entry" backendSlot=0 subsys=map-lb svcKey="10.96.0.10:13568" svcVal="0 0 (768) [0x0 0x0]"
level=debug msg="Adding backends to affinity match map" backends="[]" serviceID=3 subsys=service
level=info msg="Endpoints restored" failed=0 restored=0 subsys=daemon
level=debug msg="Allocated random IP" ip=10.244.3.93 owner=router pool=default subsys=ipam
level=info msg="Addressing information:" subsys=daemon
level=info msg="  Cluster-Name: kind-kind" subsys=daemon
level=info msg="  Cluster-ID: 0" subsys=daemon
level=info msg="  Local node-name: kind-worker2" subsys=daemon
level=info msg="  Node-IPv6: fc00:c111::2" subsys=daemon
level=info msg="  External-Node IPv4: 172.27.0.2" subsys=daemon
level=info msg="  Internal-Node IPv4: 10.244.3.93" subsys=daemon
level=info msg="  IPv4 allocation prefix: 10.244.3.0/24" subsys=daemon
level=info msg="  IPv4 native routing prefix: 10.0.0.0/24" subsys=daemon
level=info msg="  Loopback IPv4: 169.254.42.1" subsys=daemon
level=debug msg="Resolving identity" identityLabels="cidr:172.27.0.4/32,reserved:kube-apiserver,reserved:world" subsys=identity-cache
level=debug msg="UpdateIdentities: Adding a new identity" identity=16777217 labels="[cidr:0.0.0.0/0 cidr:128.0.0.0/1 cidr:128.0.0.0/2 cidr:160.0.0.0/3 cidr:160.0.0.0/4 cidr:168.0.0.0/5 cidr:172.0.0.0/10 cidr:172.0.0.0/11 cidr:172.0.0.0/6 cidr:172.0.0.0/7 cidr:172.0.0.0/8 cidr:172.0.0.0/9 cidr:172.16.0.0/12 cidr:172.24.0.0/13 cidr:172.24.0.0/14 cidr:172.26.0.0/15 cidr:172.27.0.0/16 cidr:172.27.0.0/17 cidr:172.27.0.0/18 cidr:172.27.0.0/19 cidr:172.27.0.0/20 cidr:172.27.0.0/21 cidr:172.27.0.0/22 cidr:172.27.0.0/23 cidr:172.27.0.0/24 cidr:172.27.0.0/25 cidr:172.27.0.0/26 cidr:172.27.0.0/27 cidr:172.27.0.0/28 cidr:172.27.0.0/29 cidr:172.27.0.4/30 cidr:172.27.0.4/31 cidr:172.27.0.4/32 reserved:kube-apiserver reserved:world]" subsys=policy
level=debug msg="Waiting for proxy updates to complete..." subsys=endpoint-manager
level=debug msg="Wait time for proxy updates: 14.375µs" subsys=endpoint-manager
level=debug msg="Upserting IP into ipcache layer" identity="{16777217 kube-apiserver [] false true}" ipAddr=172.27.0.4/32 key=0 subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{16777217 kube-apiserver [] false true}" ipAddr="{172.27.0.4 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Controller func execution time: 976.125µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller run succeeded; waiting for next controller update or stop" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=info msg="  Local IPv4 addresses:" subsys=daemon
level=info msg="  - 172.27.0.2" subsys=daemon
level=debug msg="UpdateIdentities: Skipping add of an existing identical identity" identity=16777217 subsys=policy
level=debug msg="Regenerating all endpoints" subsys=policy
level=info msg="regenerating all endpoints" reason="one or more identities created or deleted" subsys=endpoint-manager
level=debug msg="Allocated random IP" ip=10.244.3.193 owner=health pool=default subsys=ipam
level=debug msg="IPv4 health endpoint address: 10.244.3.193" subsys=daemon
level=debug msg="Received node update event from local: types.Node{Name:\"kind-worker2\", Cluster:\"kind-kind\", IPAddresses:[]types.Address{types.Address{Type:\"InternalIP\", IP:net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xac, 0x1b, 0x0, 0x2}}, types.Address{Type:\"InternalIP\", IP:net.IP{0xfc, 0x0, 0xc1, 0x11, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2}}, types.Address{Type:\"CiliumInternalIP\", IP:net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xa, 0xf4, 0x3, 0x5d}}}, IPv4AllocCIDR:(*cidr.CIDR)(0x40010ec610), IPv4SecondaryAllocCIDRs:[]*cidr.CIDR(nil), IPv6AllocCIDR:(*cidr.CIDR)(nil), IPv6SecondaryAllocCIDRs:[]*cidr.CIDR(nil), IPv4HealthIP:net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xa, 0xf4, 0x3, 0xc1}, IPv6HealthIP:net.IP(nil), IPv4IngressIP:net.IP(nil), IPv6IngressIP:net.IP(nil), ClusterID:0x0, Source:\"local\", EncryptionKey:0x0, Labels:map[string]string{\"beta.kubernetes.io/arch\":\"arm64\", \"beta.kubernetes.io/os\":\"linux\", \"kubernetes.io/arch\":\"arm64\", \"kubernetes.io/hostname\":\"kind-worker2\", \"kubernetes.io/os\":\"linux\"}, Annotations:map[string]string(nil), NodeIdentity:0x1, WireguardPubKey:\"\"}" subsys=nodemanager
level=debug msg="Received node update event from custom-resource: types.Node{Name:\"kind-worker3\", Cluster:\"kind-kind\", IPAddresses:[]types.Address{types.Address{Type:\"InternalIP\", IP:net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xac, 0x1b, 0x0, 0x5}}, types.Address{Type:\"InternalIP\", IP:net.IP{0xfc, 0x0, 0xc1, 0x11, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x5}}, types.Address{Type:\"CiliumInternalIP\", IP:net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xa, 0xf4, 0x1, 0xaa}}}, IPv4AllocCIDR:(*cidr.CIDR)(0x4000b82728), IPv4SecondaryAllocCIDRs:[]*cidr.CIDR(nil), IPv6AllocCIDR:(*cidr.CIDR)(nil), IPv6SecondaryAllocCIDRs:[]*cidr.CIDR(nil), IPv4HealthIP:net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xa, 0xf4, 0x1, 0xb6}, IPv6HealthIP:net.IP(nil), IPv4IngressIP:net.IP(nil), IPv6IngressIP:net.IP(nil), ClusterID:0x0, Source:\"custom-resource\", EncryptionKey:0x0, Labels:map[string]string{\"beta.kubernetes.io/arch\":\"arm64\", \"beta.kubernetes.io/os\":\"linux\", \"kubernetes.io/arch\":\"arm64\", \"kubernetes.io/hostname\":\"kind-worker3\", \"kubernetes.io/os\":\"linux\"}, Annotations:map[string]string(nil), NodeIdentity:0x0, WireguardPubKey:\"\"}" subsys=nodemanager
level=debug msg="Running 'ipset create cilium_node_set_v4 iphash family inet -exist' command" subsys=iptables
level=debug msg="Running 'ipset create cilium_node_set_v4 iphash family inet -exist' command" subsys=iptables
level=info msg="Adding local node to cluster" node="{kind-worker2 kind-kind [{InternalIP 172.27.0.2} {InternalIP fc00:c111::2} {CiliumInternalIP 10.244.3.93}] 10.244.3.0/24 [] <nil> [] 10.244.3.193 <nil> <nil> <nil> 0 local 0 map[beta.kubernetes.io/arch:arm64 beta.kubernetes.io/os:linux kubernetes.io/arch:arm64 kubernetes.io/hostname:kind-worker2 kubernetes.io/os:linux] map[] 1 }" subsys=nodediscovery
level=debug msg="Running 'ipset add cilium_node_set_v4 172.27.0.5 -exist' command" subsys=iptables
level=debug msg="Running 'ipset add cilium_node_set_v4 172.27.0.2 -exist' command" subsys=iptables
level=debug msg="Upserting IP into ipcache layer" identity="{remote-node custom-resource [] false false}" ipAddr=172.27.0.5/32 key=0 subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{remote-node custom-resource [] false false}" ipAddr="{172.27.0.5 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Updating existing controller" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller update time: 12.542µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Running 'ipset create cilium_node_set_v6 iphash family inet6 -exist' command" subsys=iptables
level=debug msg="Resolving identity" identityLabels="reserved:remote-node" subsys=identity-cache
level=debug msg="Resolved reserved identity" identity=remote-node identityLabels="reserved:remote-node" isNew=false subsys=identity-cache
level=debug msg="Controller func execution time: 38.125µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller run succeeded; waiting for next controller update or stop" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Upserting IP into ipcache layer" identity="{host local [] false false}" ipAddr=172.27.0.2/32 key=0 subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{host local [] false false}" ipAddr="{172.27.0.2 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Updating existing controller" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller update time: 4.792µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Running 'ipset create cilium_node_set_v6 iphash family inet6 -exist' command" subsys=iptables
level=debug msg="Controller func execution time: 5.667µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller run succeeded; waiting for next controller update or stop" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Running 'ipset add cilium_node_set_v6 fc00:c111::5 -exist' command" subsys=iptables
level=debug msg="Running 'ipset add cilium_node_set_v6 fc00:c111::2 -exist' command" subsys=iptables
level=debug msg="Upserting IP into ipcache layer" identity="{remote-node custom-resource [] false false}" ipAddr="fc00:c111::5/128" key=0 subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{remote-node custom-resource [] false false}" ipAddr="{fc00:c111::5 ffffffffffffffffffffffffffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Updating existing controller" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller update time: 5.791µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Upserting IP into ipcache layer" identity="{remote-node custom-resource [] false false}" ipAddr=10.244.1.170/32 key=0 subsys=ipcache
level=debug msg="Allocated new node ID for node IP address" ipAddr=172.27.0.5 nodeID=61962 subsys=linux-datapath
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{remote-node custom-resource [] false false}" ipAddr="{10.244.1.170 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Updating existing controller" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller update time: 4.375µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Upserting IP into ipcache layer" identity="{health custom-resource [] false false}" ipAddr=10.244.1.182 key=0 subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{health custom-resource [] false false}" ipAddr="{10.244.1.182 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Resolving identity" identityLabels="reserved:remote-node" subsys=identity-cache
level=debug msg="Resolved reserved identity" identity=remote-node identityLabels="reserved:remote-node" isNew=false subsys=identity-cache
level=debug msg="Upserting IP into ipcache layer" identity="{host local [] false false}" ipAddr="fc00:c111::2/128" key=0 subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{host local [] false false}" ipAddr="{fc00:c111::2 ffffffffffffffffffffffffffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Resolving identity" identityLabels="reserved:remote-node" subsys=identity-cache
level=debug msg="Resolved reserved identity" identity=remote-node identityLabels="reserved:remote-node" isNew=false subsys=identity-cache
level=debug msg="Controller func execution time: 93.542µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller run succeeded; waiting for next controller update or stop" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Updating existing controller" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller update time: 4.584µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Upserting IP into ipcache layer" identity="{host local [] false false}" ipAddr=10.244.3.93/32 key=0 subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{host local [] false false}" ipAddr="{10.244.3.93 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Controller func execution time: 36.958µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller run succeeded; waiting for next controller update or stop" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Updating existing controller" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller update time: 4.125µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Upserting IP into ipcache layer" identity="{health local [] false false}" ipAddr=10.244.3.193 key=0 subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{health local [] false false}" ipAddr="{10.244.3.193 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=info msg="Creating or updating CiliumNode resource" node=kind-worker2 subsys=nodediscovery
level=debug msg="Controller func execution time: 120.459µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller run succeeded; waiting for next controller update or stop" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller func execution time: 2.417µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller run succeeded; waiting for next controller update or stop" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=info msg="Waiting until all pre-existing resources have been received" subsys=k8s-watcher
level=debug msg="stopped waiting for caches to be synced" kubernetesResource="core/v1::Node" subsys=k8s
level=debug msg="resource \"core/v1::Node\" cache has synced, stopping timeout watcher" subsys=k8s
level=debug msg="resource \"discovery/v1beta1::EndpointSlice\" cache has synced, stopping timeout watcher" subsys=k8s
level=debug msg="resource \"core/v1::Endpoint\" cache has synced, stopping timeout watcher" subsys=k8s
level=warning msg="Unable to get node resource" error="ciliumnodes.cilium.io \"kind-worker2\" not found" subsys=nodediscovery
level=info msg="Successfully created CiliumNode resource" subsys=nodediscovery
level=debug msg="Annotate k8s node is disabled." subsys=daemon
level=info msg="Initializing identity allocator" subsys=identity-cache
level=info msg="Allocating identities between range" cluster-id=0 max=65535 min=256 subsys=identity-cache
level=info msg="Cluster-ID is not specified, skipping ClusterMesh initialization" subsys=daemon
level=debug msg="Starting new controller" name=template-dir-watcher subsys=controller uuid=8ac065b2-38c5-424d-a256-aa83a031eaf8
level=debug msg="writing configuration" file-path=netdev_config.h subsys=datapath-loader
level=info msg="Setting up BPF datapath" bpfClockSource=ktime bpfInsnSet="<nil>" subsys=datapath-loader
level=info msg="Setting sysctl" subsys=sysctl sysParamName=net.core.bpf_jit_enable sysParamValue=1
level=debug msg="Identity allocation backed by CRD" subsys=identity-cache
level=warning msg="Unable to ensure that BPF JIT compilation is enabled. This can be ignored when Cilium is running inside non-host network namespace (e.g. with kind or minikube)" error="could not open the sysctl file /host/proc/sys/net/core/bpf_jit_enable: open /host/proc/sys/net/core/bpf_jit_enable: no such file or directory" subsys=sysctl sysParamName=net.core.bpf_jit_enable sysParamValue=1
level=info msg="Setting sysctl" subsys=sysctl sysParamName=net.ipv4.conf.all.rp_filter sysParamValue=0
level=info msg="Setting sysctl" subsys=sysctl sysParamName=net.ipv4.fib_multipath_use_neigh sysParamValue=1
level=info msg="Setting sysctl" subsys=sysctl sysParamName=kernel.unprivileged_bpf_disabled sysParamValue=1
level=info msg="Setting sysctl" subsys=sysctl sysParamName=kernel.timer_migration sysParamValue=0
level=info msg="Setting sysctl" subsys=sysctl sysParamName=net.ipv4.conf.cilium_host.forwarding sysParamValue=1
level=info msg="Setting sysctl" subsys=sysctl sysParamName=net.ipv4.conf.cilium_host.rp_filter sysParamValue=0
level=info msg="Setting sysctl" subsys=sysctl sysParamName=net.ipv4.conf.cilium_host.accept_local sysParamValue=1
level=info msg="Setting sysctl" subsys=sysctl sysParamName=net.ipv4.conf.cilium_host.send_redirects sysParamValue=0
level=info msg="Setting sysctl" subsys=sysctl sysParamName=net.ipv4.conf.cilium_net.forwarding sysParamValue=1
level=info msg="Setting sysctl" subsys=sysctl sysParamName=net.ipv4.conf.cilium_net.rp_filter sysParamValue=0
level=info msg="Setting sysctl" subsys=sysctl sysParamName=net.ipv4.conf.cilium_net.accept_local sysParamValue=1
level=info msg="Setting sysctl" subsys=sysctl sysParamName=net.ipv4.conf.cilium_net.send_redirects sysParamValue=0
level=debug msg="cache synced" kubernetesResource="core/v1::Service" subsys=k8s
level=debug msg="stopped waiting for caches to be synced" kubernetesResource="core/v1::Service" subsys=k8s
level=debug msg="resource \"core/v1::Service\" cache has synced, stopping timeout watcher" subsys=k8s
level=debug msg="cache synced" kubernetesResource="networking.k8s.io/v1::NetworkPolicy" subsys=k8s
level=debug msg="stopped waiting for caches to be synced" kubernetesResource="networking.k8s.io/v1::NetworkPolicy" subsys=k8s
level=debug msg="resource \"networking.k8s.io/v1::NetworkPolicy\" cache has synced, stopping timeout watcher" subsys=k8s
level=debug msg="cache synced" kubernetesResource="discovery/v1::EndpointSlice" subsys=k8s
level=debug msg="cache synced" kubernetesResource="core/v1::Pods" subsys=k8s
level=debug msg="stopped waiting for caches to be synced" kubernetesResource="core/v1::Pods" subsys=k8s
level=debug msg="resource \"core/v1::Pods\" cache has synced, stopping timeout watcher" subsys=k8s
level=debug msg="cache synced" kubernetesResource="cilium/v2::CiliumEndpoint" subsys=k8s
level=debug msg="stopped waiting for caches to be synced" kubernetesResource="cilium/v2::CiliumEndpoint" subsys=k8s
level=debug msg="resource \"cilium/v2::CiliumEndpoint\" cache has synced, stopping timeout watcher" subsys=k8s
level=debug msg="cache synced" kubernetesResource="cilium/v2::CiliumClusterwideNetworkPolicy" subsys=k8s
level=debug msg="stopped waiting for caches to be synced" kubernetesResource="cilium/v2::CiliumClusterwideNetworkPolicy" subsys=k8s
level=debug msg="resource \"cilium/v2::CiliumClusterwideNetworkPolicy\" cache has synced, stopping timeout watcher" subsys=k8s
level=debug msg="cache synced" kubernetesResource="cilium/v2::CiliumNode" subsys=k8s
level=debug msg="stopped waiting for caches to be synced" kubernetesResource="cilium/v2::CiliumNode" subsys=k8s
level=debug msg="resource \"cilium/v2::CiliumNode\" cache has synced, stopping timeout watcher" subsys=k8s
level=debug msg="cache synced" kubernetesResource="cilium/v2alpha1::CiliumCIDRGroup" subsys=k8s
level=debug msg="stopped waiting for caches to be synced" kubernetesResource="cilium/v2alpha1::CiliumCIDRGroup" subsys=k8s
level=debug msg="resource \"cilium/v2alpha1::CiliumCIDRGroup\" cache has synced, stopping timeout watcher" subsys=k8s
level=debug msg="cache synced" kubernetesResource="cilium/v2::CiliumNetworkPolicy" subsys=k8s
level=debug msg="stopped waiting for caches to be synced" kubernetesResource="cilium/v2::CiliumNetworkPolicy" subsys=k8s
level=debug msg="resource \"cilium/v2::CiliumNetworkPolicy\" cache has synced, stopping timeout watcher" subsys=k8s
level=debug msg="Launching compiler" args="[-emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -DCALLS_MAP=cilium_calls_lb -I/var/run/cilium/state/globals -I/var/run/cilium/state -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_sock.c -o -]" subsys=datapath-loader target=clang
level=debug msg="Initial list of identities received" subsys=allocator
level=debug msg="Received node update event from custom-resource: types.Node{Name:\"kind-control-plane\", Cluster:\"kind-kind\", IPAddresses:[]types.Address{types.Address{Type:\"InternalIP\", IP:net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xac, 0x1b, 0x0, 0x4}}, types.Address{Type:\"InternalIP\", IP:net.IP{0xfc, 0x0, 0xc1, 0x11, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4}}, types.Address{Type:\"CiliumInternalIP\", IP:net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xa, 0xf4, 0x0, 0xbb}}}, IPv4AllocCIDR:(*cidr.CIDR)(0x4000b82840), IPv4SecondaryAllocCIDRs:[]*cidr.CIDR(nil), IPv6AllocCIDR:(*cidr.CIDR)(nil), IPv6SecondaryAllocCIDRs:[]*cidr.CIDR(nil), IPv4HealthIP:net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xa, 0xf4, 0x0, 0xf5}, IPv6HealthIP:net.IP(nil), IPv4IngressIP:net.IP(nil), IPv6IngressIP:net.IP(nil), ClusterID:0x0, Source:\"custom-resource\", EncryptionKey:0x0, Labels:map[string]string{\"beta.kubernetes.io/arch\":\"arm64\", \"beta.kubernetes.io/os\":\"linux\", \"kubernetes.io/arch\":\"arm64\", \"kubernetes.io/hostname\":\"kind-control-plane\", \"kubernetes.io/os\":\"linux\", \"node-role.kubernetes.io/control-plane\":\"\", \"node.kubernetes.io/exclude-from-external-load-balancers\":\"\"}, Annotations:map[string]string(nil), NodeIdentity:0x0, WireguardPubKey:\"\"}" subsys=nodemanager
level=debug msg="Running 'ipset create cilium_node_set_v4 iphash family inet -exist' command" subsys=iptables
level=debug msg="Running 'ipset add cilium_node_set_v4 172.27.0.4 -exist' command" subsys=iptables
level=debug msg="Updating existing controller" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller update time: 71.667µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Running 'ipset create cilium_node_set_v6 iphash family inet6 -exist' command" subsys=iptables
level=debug msg="Resolving identity" identityLabels="reserved:kube-apiserver,reserved:remote-node" subsys=identity-cache
level=debug msg="Resolved reserved identity" identity=kube-apiserver identityLabels="reserved:kube-apiserver,reserved:remote-node" isNew=false subsys=identity-cache
level=debug msg="UpdateIdentities: Skipping add of an existing identical identity" identity=kube-apiserver subsys=policy
level=debug msg="Waiting for proxy updates to complete..." subsys=endpoint-manager
level=debug msg="Wait time for proxy updates: 52.75µs" subsys=endpoint-manager
level=debug msg="Upserting IP into ipcache layer" identity="{kube-apiserver kube-apiserver [] false true}" ipAddr=172.27.0.4/32 key=0 subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{kube-apiserver kube-apiserver [] false true}" ipAddr="{172.27.0.4 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="UpdateIdentities: Deleting identity" identity=16777217 labels="[cidr:0.0.0.0/0 cidr:128.0.0.0/1 cidr:128.0.0.0/2 cidr:160.0.0.0/3 cidr:160.0.0.0/4 cidr:168.0.0.0/5 cidr:172.0.0.0/10 cidr:172.0.0.0/11 cidr:172.0.0.0/6 cidr:172.0.0.0/7 cidr:172.0.0.0/8 cidr:172.0.0.0/9 cidr:172.16.0.0/12 cidr:172.24.0.0/13 cidr:172.24.0.0/14 cidr:172.26.0.0/15 cidr:172.27.0.0/16 cidr:172.27.0.0/17 cidr:172.27.0.0/18 cidr:172.27.0.0/19 cidr:172.27.0.0/20 cidr:172.27.0.0/21 cidr:172.27.0.0/22 cidr:172.27.0.0/23 cidr:172.27.0.0/24 cidr:172.27.0.0/25 cidr:172.27.0.0/26 cidr:172.27.0.0/27 cidr:172.27.0.0/28 cidr:172.27.0.0/29 cidr:172.27.0.4/30 cidr:172.27.0.4/31 cidr:172.27.0.4/32 reserved:kube-apiserver reserved:world]" subsys=policy
level=debug msg="Waiting for proxy updates to complete..." subsys=endpoint-manager
level=debug msg="Wait time for proxy updates: 25.125µs" subsys=endpoint-manager
level=debug msg="Controller func execution time: 422.333µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller run succeeded; waiting for next controller update or stop" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=warning msg="UpdateIdentities: Skipping Delete of a non-existing identity" identity=16777217 subsys=policy
level=debug msg="Running 'ipset add cilium_node_set_v6 fc00:c111::4 -exist' command" subsys=iptables
level=debug msg="Upserting IP into ipcache layer" identity="{remote-node custom-resource [] false false}" ipAddr="fc00:c111::4/128" key=0 subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{remote-node custom-resource [] false false}" ipAddr="{fc00:c111::4 ffffffffffffffffffffffffffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Updating existing controller" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller update time: 31.208µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Upserting IP into ipcache layer" identity="{remote-node custom-resource [] false false}" ipAddr=10.244.0.187/32 key=0 subsys=ipcache
level=debug msg="Allocated new node ID for node IP address" ipAddr=172.27.0.4 nodeID=53302 subsys=linux-datapath
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{remote-node custom-resource [] false false}" ipAddr="{10.244.0.187 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Resolving identity" identityLabels="reserved:remote-node" subsys=identity-cache
level=debug msg="Resolved reserved identity" identity=remote-node identityLabels="reserved:remote-node" isNew=false subsys=identity-cache
level=debug msg="Controller func execution time: 200.917µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller run succeeded; waiting for next controller update or stop" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Updating existing controller" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller update time: 109.375µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Upserting IP into ipcache layer" identity="{health custom-resource [] false false}" ipAddr=10.244.0.245 key=0 subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{health custom-resource [] false false}" ipAddr="{10.244.0.245 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Resolving identity" identityLabels="reserved:remote-node" subsys=identity-cache
level=debug msg="Resolved reserved identity" identity=remote-node identityLabels="reserved:remote-node" isNew=false subsys=identity-cache
level=debug msg="Controller func execution time: 164.125µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller run succeeded; waiting for next controller update or stop" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="cache synced" kubernetesResource="core/v1::Namespace" subsys=k8s
level=debug msg="stopped waiting for caches to be synced" kubernetesResource="core/v1::Namespace" subsys=k8s
level=debug msg="resource \"core/v1::Namespace\" cache has synced, stopping timeout watcher" subsys=k8s
level=info msg="No existing link found at /sys/fs/bpf/cilium/socketlb/links/cgroup/cil_sock4_connect for program cil_sock4_connect" subsys=socketlb
level=debug msg="Program cil_sock4_connect attached using bpf_link" subsys=socketlb
level=info msg="No existing link found at /sys/fs/bpf/cilium/socketlb/links/cgroup/cil_sock4_recvmsg for program cil_sock4_recvmsg" subsys=socketlb
level=debug msg="Program cil_sock4_recvmsg attached using bpf_link" subsys=socketlb
level=info msg="No existing link found at /sys/fs/bpf/cilium/socketlb/links/cgroup/cil_sock4_getpeername for program cil_sock4_getpeername" subsys=socketlb
level=debug msg="Program cil_sock4_getpeername attached using bpf_link" subsys=socketlb
level=info msg="No existing link found at /sys/fs/bpf/cilium/socketlb/links/cgroup/cil_sock6_post_bind for program cil_sock6_post_bind" subsys=socketlb
level=debug msg="Program cil_sock6_post_bind attached using bpf_link" subsys=socketlb
level=debug msg="No pinned link '/sys/fs/bpf/cilium/socketlb/links/cgroup/cil_sock6_pre_bind', querying cgroup" subsys=socketlb
level=debug msg="No programs in cgroup /run/cilium/cgroupv2 with attach type CGroupInet6Bind" subsys=socketlb
level=info msg="No existing link found at /sys/fs/bpf/cilium/socketlb/links/cgroup/cil_sock4_sendmsg for program cil_sock4_sendmsg" subsys=socketlb
level=debug msg="Program cil_sock4_sendmsg attached using bpf_link" subsys=socketlb
level=info msg="No existing link found at /sys/fs/bpf/cilium/socketlb/links/cgroup/cil_sock4_post_bind for program cil_sock4_post_bind" subsys=socketlb
level=debug msg="Program cil_sock4_post_bind attached using bpf_link" subsys=socketlb
level=debug msg="No pinned link '/sys/fs/bpf/cilium/socketlb/links/cgroup/cil_sock4_pre_bind', querying cgroup" subsys=socketlb
level=debug msg="No programs in cgroup /run/cilium/cgroupv2 with attach type CGroupInet4Bind" subsys=socketlb
level=info msg="No existing link found at /sys/fs/bpf/cilium/socketlb/links/cgroup/cil_sock6_connect for program cil_sock6_connect" subsys=socketlb
level=debug msg="Program cil_sock6_connect attached using bpf_link" subsys=socketlb
level=info msg="No existing link found at /sys/fs/bpf/cilium/socketlb/links/cgroup/cil_sock6_sendmsg for program cil_sock6_sendmsg" subsys=socketlb
level=debug msg="Program cil_sock6_sendmsg attached using bpf_link" subsys=socketlb
level=info msg="No existing link found at /sys/fs/bpf/cilium/socketlb/links/cgroup/cil_sock6_recvmsg for program cil_sock6_recvmsg" subsys=socketlb
level=debug msg="Program cil_sock6_recvmsg attached using bpf_link" subsys=socketlb
level=info msg="No existing link found at /sys/fs/bpf/cilium/socketlb/links/cgroup/cil_sock6_getpeername for program cil_sock6_getpeername" subsys=socketlb
level=debug msg="Program cil_sock6_getpeername attached using bpf_link" subsys=socketlb
level=debug msg="Finalizing bpffs map migration" subsys=socketlb
level=debug msg="Launching compiler" args="[-emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_alignchecker.c -o -]" subsys=datapath-loader target=clang
level=debug msg="Updating direct route" addedCIDRs="[10.244.1.0/24]" newIP=172.27.0.5 oldIP="<nil>" removedCIDRs="[]" subsys=linux-datapath
level=debug msg="Updating direct route" addedCIDRs="[10.244.0.0/24]" newIP=172.27.0.4 oldIP="<nil>" removedCIDRs="[]" subsys=linux-datapath
level=debug msg="Running 'iptables -t nat -S' command" subsys=iptables
level=debug msg="Unable to insert new next hop" error="invalid argument" interface=eth0 ipAddr="fc00:c111::4" neighbor="{LinkIndex:160 Family:0 State:4 Type:0 Flags:16 FlagsExt:0 IP:fc00:c111::4 HardwareAddr: LLIPAddr:<nil> Vlan:0 VNI:0 MasterIndex:0}" nextHop="fc00:c111::4" subsys=node-neigh-debug
level=debug msg="Unable to insert new next hop" error="invalid argument" interface=eth0 ipAddr="fc00:c111::5" neighbor="{LinkIndex:160 Family:0 State:4 Type:0 Flags:16 FlagsExt:0 IP:fc00:c111::5 HardwareAddr: LLIPAddr:<nil> Vlan:0 VNI:0 MasterIndex:0}" nextHop="fc00:c111::5" subsys=node-neigh-debug
level=debug msg="Running 'ip6tables -t nat -S' command" subsys=iptables
level=debug msg="Running 'iptables -t mangle -S' command" subsys=iptables
level=debug msg="Running 'ip6tables -t mangle -S' command" subsys=iptables
level=debug msg="Running 'iptables -t raw -S' command" subsys=iptables
level=debug msg="Running 'ip6tables -t raw -S' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -S' command" subsys=iptables
level=debug msg="Running 'ip6tables -t filter -S' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -S OLD_CILIUM_INPUT' command" subsys=iptables
level=debug msg="Running 'ip6tables -t filter -S OLD_CILIUM_INPUT' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -S OLD_CILIUM_OUTPUT' command" subsys=iptables
level=debug msg="Running 'ip6tables -t filter -S OLD_CILIUM_OUTPUT' command" subsys=iptables
level=debug msg="Running 'iptables -t raw -S OLD_CILIUM_OUTPUT_raw' command" subsys=iptables
level=debug msg="Running 'ip6tables -t raw -S OLD_CILIUM_OUTPUT_raw' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -S OLD_CILIUM_POST_nat' command" subsys=iptables
level=debug msg="Running 'ip6tables -t nat -S OLD_CILIUM_POST_nat' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -S OLD_CILIUM_OUTPUT_nat' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -S OLD_CILIUM_PRE_nat' command" subsys=iptables
level=debug msg="Running 'iptables -t mangle -S OLD_CILIUM_POST_mangle' command" subsys=iptables
level=debug msg="Running 'iptables -t mangle -S OLD_CILIUM_PRE_mangle' command" subsys=iptables
level=debug msg="Running 'ip6tables -t mangle -S OLD_CILIUM_PRE_mangle' command" subsys=iptables
level=debug msg="Running 'iptables -t raw -S OLD_CILIUM_PRE_raw' command" subsys=iptables
level=debug msg="Running 'ip6tables -t raw -S OLD_CILIUM_PRE_raw' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -S OLD_CILIUM_FORWARD' command" subsys=iptables
level=debug msg="Running 'ip6tables -t filter -S OLD_CILIUM_FORWARD' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -S CILIUM_INPUT' command" subsys=iptables
level=debug msg="Running 'ip6tables -t filter -S CILIUM_INPUT' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -S CILIUM_OUTPUT' command" subsys=iptables
level=debug msg="Running 'ip6tables -t filter -S CILIUM_OUTPUT' command" subsys=iptables
level=debug msg="Running 'iptables -t raw -S CILIUM_OUTPUT_raw' command" subsys=iptables
level=debug msg="Running 'ip6tables -t raw -S CILIUM_OUTPUT_raw' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -S CILIUM_POST_nat' command" subsys=iptables
level=debug msg="Running 'ip6tables -t nat -S CILIUM_POST_nat' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -S CILIUM_OUTPUT_nat' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -S CILIUM_PRE_nat' command" subsys=iptables
level=debug msg="Running 'iptables -t mangle -S CILIUM_POST_mangle' command" subsys=iptables
level=debug msg="Running 'iptables -t mangle -S CILIUM_PRE_mangle' command" subsys=iptables
level=debug msg="Running 'ip6tables -t mangle -S CILIUM_PRE_mangle' command" subsys=iptables
level=debug msg="Running 'iptables -t raw -S CILIUM_PRE_raw' command" subsys=iptables
level=debug msg="Running 'ip6tables -t raw -S CILIUM_PRE_raw' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -S CILIUM_FORWARD' command" subsys=iptables
level=debug msg="Running 'ip6tables -t filter -S CILIUM_FORWARD' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -N CILIUM_INPUT' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -N CILIUM_OUTPUT' command" subsys=iptables
level=debug msg="Running 'iptables -t raw -N CILIUM_OUTPUT_raw' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -N CILIUM_POST_nat' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -N CILIUM_OUTPUT_nat' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -N CILIUM_PRE_nat' command" subsys=iptables
level=debug msg="Running 'iptables -t mangle -N CILIUM_POST_mangle' command" subsys=iptables
level=debug msg="Running 'iptables -t mangle -N CILIUM_PRE_mangle' command" subsys=iptables
level=debug msg="Running 'iptables -t raw -N CILIUM_PRE_raw' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -N CILIUM_FORWARD' command" subsys=iptables
level=debug msg="Running 'iptables -t raw -A CILIUM_PRE_raw -m mark --mark 0x00000200/0x00000f00 -m comment --comment cilium: NOTRACK for proxy traffic -j CT --notrack' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -A CILIUM_INPUT -m mark --mark 0x00000200/0x00000f00 -m comment --comment cilium: ACCEPT for proxy traffic -j ACCEPT' command" subsys=iptables
level=debug msg="Running 'iptables -t raw -A CILIUM_OUTPUT_raw -o lxc+ -m mark --mark 0x00000a00/0xfffffeff -m comment --comment cilium: NOTRACK for proxy return traffic -j CT --notrack' command" subsys=iptables
level=debug msg="Running 'iptables -t raw -A CILIUM_OUTPUT_raw -o cilium_host -m mark --mark 0x00000a00/0xfffffeff -m comment --comment cilium: NOTRACK for proxy return traffic -j CT --notrack' command" subsys=iptables
level=debug msg="Running 'iptables -t raw -A CILIUM_OUTPUT_raw -o lxc+ -m mark --mark 0x00000800/0x00000e00 -m comment --comment cilium: NOTRACK for L7 proxy upstream traffic -j CT --notrack' command" subsys=iptables
level=debug msg="Running 'iptables -t raw -A CILIUM_OUTPUT_raw -o cilium_host -m mark --mark 0x00000800/0x00000e00 -m comment --comment cilium: NOTRACK for L7 proxy upstream traffic -j CT --notrack' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -A CILIUM_OUTPUT -m mark --mark 0x00000a00/0xfffffeff -m comment --comment cilium: ACCEPT for proxy return traffic -j ACCEPT' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -A CILIUM_OUTPUT -m mark --mark 0x00000800/0x00000e00 -m comment --comment cilium: ACCEPT for l7 proxy upstream traffic -j ACCEPT' command" subsys=iptables
level=debug msg="Running 'iptables -t mangle -A CILIUM_PRE_mangle -m socket --transparent -m comment --comment cilium: any->pod redirect proxied traffic to host proxy -j MARK --set-mark 0x00000200' command" subsys=iptables
level=debug msg="Running 'iptables -A CILIUM_FORWARD -o cilium_host -m comment --comment cilium: any->cluster on cilium_host forward accept -j ACCEPT' command" subsys=iptables
level=debug msg="Running 'iptables -A CILIUM_FORWARD -i cilium_host -m comment --comment cilium: cluster->any on cilium_host forward accept (nodeport) -j ACCEPT' command" subsys=iptables
level=debug msg="Running 'iptables -A CILIUM_FORWARD -i lxc+ -m comment --comment cilium: cluster->any on lxc+ forward accept -j ACCEPT' command" subsys=iptables
level=debug msg="Running 'iptables -A CILIUM_FORWARD -i cilium_net -m comment --comment cilium: cluster->any on cilium_net forward accept (nodeport) -j ACCEPT' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -A CILIUM_OUTPUT -m mark ! --mark 0x00000e00/0x00000f00 -m mark ! --mark 0x00000d00/0x00000f00 -m mark ! --mark 0x00000a00/0x00000e00 -m mark ! --mark 0x00000800/0x00000e00 -m mark ! --mark 0x00000f00/0x00000f00 -m comment --comment cilium: host->any mark as from host -j MARK --set-xmark 0x00000c00/0x00000f00' command" subsys=iptables
level=debug msg="Running 'ipset create cilium_node_set_v4 iphash family inet -exist' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -A CILIUM_POST_nat -s 10.244.3.0/24 -m set --match-set cilium_node_set_v4 dst -m comment --comment exclude traffic to cluster nodes from masquerade -j ACCEPT' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -A CILIUM_POST_nat ! -d 10.0.0.0/24 -s 10.244.3.0/24 ! -o cilium_+ -m comment --comment cilium masquerade non-cluster -j MASQUERADE' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -A CILIUM_POST_nat -m mark --mark 0x00000a00/0x00000e00 -m comment --comment exclude proxy return traffic from masquerade -j ACCEPT' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -A CILIUM_POST_nat -s 127.0.0.1 -o cilium_host -m comment --comment cilium host->cluster from 127.0.0.1 masquerade -j SNAT --to-source 10.244.3.93' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -A CILIUM_POST_nat -m mark --mark 0x00000f00/0x00000f00 -o cilium_host -m conntrack --ctstate DNAT -m comment --comment hairpin traffic that originated from a local pod -j SNAT --to-source 10.244.3.93' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -I INPUT -m comment --comment cilium-feeder: CILIUM_INPUT -j CILIUM_INPUT' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -I OUTPUT -m comment --comment cilium-feeder: CILIUM_OUTPUT -j CILIUM_OUTPUT' command" subsys=iptables
level=debug msg="Running 'iptables -t raw -I OUTPUT -m comment --comment cilium-feeder: CILIUM_OUTPUT_raw -j CILIUM_OUTPUT_raw' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -I POSTROUTING -m comment --comment cilium-feeder: CILIUM_POST_nat -j CILIUM_POST_nat' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -I OUTPUT -m comment --comment cilium-feeder: CILIUM_OUTPUT_nat -j CILIUM_OUTPUT_nat' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -I PREROUTING -m comment --comment cilium-feeder: CILIUM_PRE_nat -j CILIUM_PRE_nat' command" subsys=iptables
level=debug msg="Running 'iptables -t mangle -I POSTROUTING -m comment --comment cilium-feeder: CILIUM_POST_mangle -j CILIUM_POST_mangle' command" subsys=iptables
level=debug msg="Running 'iptables -t mangle -I PREROUTING -m comment --comment cilium-feeder: CILIUM_PRE_mangle -j CILIUM_PRE_mangle' command" subsys=iptables
level=debug msg="Running 'iptables -t raw -I PREROUTING -m comment --comment cilium-feeder: CILIUM_PRE_raw -j CILIUM_PRE_raw' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -I FORWARD -m comment --comment cilium-feeder: CILIUM_FORWARD -j CILIUM_FORWARD' command" subsys=iptables
level=debug msg="Received node update event from custom-resource: types.Node{Name:\"kind-worker\", Cluster:\"kind-kind\", IPAddresses:[]types.Address{types.Address{Type:\"InternalIP\", IP:net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xac, 0x1b, 0x0, 0x3}}, types.Address{Type:\"InternalIP\", IP:net.IP{0xfc, 0x0, 0xc1, 0x11, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x3}}, types.Address{Type:\"CiliumInternalIP\", IP:net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xa, 0xf4, 0x2, 0x22}}}, IPv4AllocCIDR:(*cidr.CIDR)(0x40005af550), IPv4SecondaryAllocCIDRs:[]*cidr.CIDR(nil), IPv6AllocCIDR:(*cidr.CIDR)(nil), IPv6SecondaryAllocCIDRs:[]*cidr.CIDR(nil), IPv4HealthIP:net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xa, 0xf4, 0x2, 0xae}, IPv6HealthIP:net.IP(nil), IPv4IngressIP:net.IP(nil), IPv6IngressIP:net.IP(nil), ClusterID:0x0, Source:\"custom-resource\", EncryptionKey:0x0, Labels:map[string]string{\"beta.kubernetes.io/arch\":\"arm64\", \"beta.kubernetes.io/os\":\"linux\", \"kubernetes.io/arch\":\"arm64\", \"kubernetes.io/hostname\":\"kind-worker\", \"kubernetes.io/os\":\"linux\"}, Annotations:map[string]string(nil), NodeIdentity:0x0, WireguardPubKey:\"\"}" subsys=nodemanager
level=debug msg="Running 'ipset create cilium_node_set_v4 iphash family inet -exist' command" subsys=iptables
level=debug msg="Running 'iptables -t mangle -S' command" subsys=iptables
level=debug msg="Running 'ipset add cilium_node_set_v4 172.27.0.3 -exist' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -S' command" subsys=iptables
level=debug msg="Upserting IP into ipcache layer" identity="{remote-node custom-resource [] false false}" ipAddr=172.27.0.3/32 key=0 subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{remote-node custom-resource [] false false}" ipAddr="{172.27.0.3 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Updating existing controller" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller update time: 32.209µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Running 'ipset create cilium_node_set_v6 iphash family inet6 -exist' command" subsys=iptables
level=debug msg="Resolving identity" identityLabels="reserved:remote-node" subsys=identity-cache
level=debug msg="Resolved reserved identity" identity=remote-node identityLabels="reserved:remote-node" isNew=false subsys=identity-cache
level=debug msg="Controller func execution time: 140.75µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller run succeeded; waiting for next controller update or stop" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Running 'ip6tables -t nat -S' command" subsys=iptables
level=debug msg="Running 'ipset add cilium_node_set_v6 fc00:c111::3 -exist' command" subsys=iptables
level=debug msg="Running 'iptables -t mangle -S' command" subsys=iptables
level=debug msg="Upserting IP into ipcache layer" identity="{remote-node custom-resource [] false false}" ipAddr="fc00:c111::3/128" key=0 subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{remote-node custom-resource [] false false}" ipAddr="{fc00:c111::3 ffffffffffffffffffffffffffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Updating existing controller" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller update time: 1.5745ms" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Upserting IP into ipcache layer" identity="{remote-node custom-resource [] false false}" ipAddr=10.244.2.34/32 key=0 subsys=ipcache
level=debug msg="Allocated new node ID for node IP address" ipAddr=172.27.0.3 nodeID=42963 subsys=linux-datapath
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{remote-node custom-resource [] false false}" ipAddr="{10.244.2.34 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Running 'ip6tables -t mangle -S' command" subsys=iptables
level=debug msg="Resolving identity" identityLabels="reserved:remote-node" subsys=identity-cache
level=debug msg="Resolved reserved identity" identity=remote-node identityLabels="reserved:remote-node" isNew=false subsys=identity-cache
level=debug msg="Controller func execution time: 368.417µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller run succeeded; waiting for next controller update or stop" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Updating existing controller" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller update time: 84.834µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Upserting IP into ipcache layer" identity="{health custom-resource [] false false}" ipAddr=10.244.2.174 key=0 subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{health custom-resource [] false false}" ipAddr="{10.244.2.174 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Updating direct route" addedCIDRs="[10.244.2.0/24]" newIP=172.27.0.3 oldIP="<nil>" removedCIDRs="[]" subsys=linux-datapath
level=debug msg="Resolving identity" identityLabels="reserved:remote-node" subsys=identity-cache
level=debug msg="Resolved reserved identity" identity=remote-node identityLabels="reserved:remote-node" isNew=false subsys=identity-cache
level=debug msg="Controller func execution time: 500.541µs" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Controller run succeeded; waiting for next controller update or stop" name=ipcache-inject-labels subsys=controller uuid=e19d3d77-6eac-418c-bd3b-bede93c4591d
level=debug msg="Unable to insert new next hop" error="invalid argument" interface=eth0 ipAddr=172.27.0.3 neighbor="{LinkIndex:160 Family:0 State:4 Type:0 Flags:16 FlagsExt:0 IP:172.27.0.3 HardwareAddr: LLIPAddr:<nil> Vlan:0 VNI:0 MasterIndex:0}" nextHop=172.27.0.3 subsys=node-neigh-debug
level=debug msg="Unable to insert new next hop" error="invalid argument" interface=eth0 ipAddr="fc00:c111::3" neighbor="{LinkIndex:160 Family:0 State:4 Type:0 Flags:16 FlagsExt:0 IP:fc00:c111::3 HardwareAddr: LLIPAddr:<nil> Vlan:0 VNI:0 MasterIndex:0}" nextHop="fc00:c111::3" subsys=node-neigh-debug
level=debug msg="Running 'iptables -t raw -S' command" subsys=iptables
level=debug msg="Running 'ip6tables -t raw -S' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -S' command" subsys=iptables
level=debug msg="Running 'ip6tables -t filter -S' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -S OLD_CILIUM_INPUT' command" subsys=iptables
level=debug msg="Running 'ip6tables -t filter -S OLD_CILIUM_INPUT' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -S OLD_CILIUM_OUTPUT' command" subsys=iptables
level=debug msg="Running 'ip6tables -t filter -S OLD_CILIUM_OUTPUT' command" subsys=iptables
level=debug msg="Running 'iptables -t raw -S OLD_CILIUM_OUTPUT_raw' command" subsys=iptables
level=debug msg="Running 'ip6tables -t raw -S OLD_CILIUM_OUTPUT_raw' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -S OLD_CILIUM_POST_nat' command" subsys=iptables
level=debug msg="Running 'ip6tables -t nat -S OLD_CILIUM_POST_nat' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -S OLD_CILIUM_OUTPUT_nat' command" subsys=iptables
level=debug msg="Running 'iptables -t nat -S OLD_CILIUM_PRE_nat' command" subsys=iptables
level=debug msg="Running 'iptables -t mangle -S OLD_CILIUM_POST_mangle' command" subsys=iptables
level=debug msg="Running 'iptables -t mangle -S OLD_CILIUM_PRE_mangle' command" subsys=iptables
level=debug msg="Running 'ip6tables -t mangle -S OLD_CILIUM_PRE_mangle' command" subsys=iptables
level=debug msg="Running 'iptables -t raw -S OLD_CILIUM_PRE_raw' command" subsys=iptables
level=debug msg="Running 'ip6tables -t raw -S OLD_CILIUM_PRE_raw' command" subsys=iptables
level=debug msg="Running 'iptables -t filter -S OLD_CILIUM_FORWARD' command" subsys=iptables
level=debug msg="Running 'ip6tables -t filter -S OLD_CILIUM_FORWARD' command" subsys=iptables
level=debug msg="Running 'ipset create cilium_node_set_v4 iphash family inet -exist' command" subsys=iptables
level=info msg="Iptables rules installed" subsys=iptables
level=info msg="Adding new proxy port rules for cilium-dns-egress:38031" id=cilium-dns-egress subsys=proxy
level=debug msg="Running 'iptables -t mangle -S' command" subsys=iptables
level=debug msg="Running 'iptables -t mangle -A CILIUM_PRE_mangle -p tcp -m mark --mark 0x8f940200 -m comment --comment cilium: TPROXY to host cilium-dns-egress proxy -j TPROXY --tproxy-mark 0x200 --on-ip 0.0.0.0 --on-port 38031' command" subsys=iptables
level=debug msg="Running 'iptables -t mangle -A CILIUM_PRE_mangle -p udp -m mark --mark 0x8f940200 -m comment --comment cilium: TPROXY to host cilium-dns-egress proxy -j TPROXY --tproxy-mark 0x200 --on-ip 0.0.0.0 --on-port 38031' command" subsys=iptables
level=info msg="Iptables proxy rules installed" subsys=iptables
level=debug msg="AckProxyPort: acked proxy port 38031 ({true dns false 38031 1 true 38031 false})" id=cilium-dns-egress subsys=proxy
level=debug msg="Group not found" error="group: unknown group cilium" file-path=/var/run/cilium/monitor1_2.sock group=cilium subsys=api
level=info msg="Serving cilium node monitor v1.2 API at unix:///var/run/cilium/monitor1_2.sock" subsys=monitor-agent
level=debug msg="Starting new controller" name=sync-host-ips subsys=controller uuid=99e72456-ce3b-472e-982a-faa2f5333f38
level=info msg="Beginning to read perf buffer" startTime="2023-06-24 17:28:40.629900292 +0000 UTC m=+2.851713044" subsys=monitor-agent
level=debug msg="Added local ip to endpoint map" ipAddr=10.244.3.93 subsys=daemon
level=debug msg="New endpoint IP started shadowing existing CIDR to identity mapping" identity="{host local [] false false}" ipAddr=10.244.3.93 key=0 subsys=ipcache
level=debug msg="Upserting IP into ipcache layer" identity="{host local [] false false}" ipAddr=10.244.3.93 key=0 subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{host local [] false false}" ipAddr="{10.244.3.93 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Added local ip to endpoint map" ipAddr=172.27.0.2 subsys=daemon
level=debug msg="Upserting IP into ipcache layer" identity="{host local [] false false}" ipAddr=172.27.0.2 key=0 subsys=ipcache
level=debug msg="Upserting IP into ipcache layer" identity="{world local [] false false}" ipAddr=0.0.0.0/0 key=0 subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{world local [] false false}" ipAddr="{0.0.0.0 00000000}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Controller func execution time: 1.112333ms" name=sync-host-ips subsys=controller uuid=99e72456-ce3b-472e-982a-faa2f5333f38
level=info msg="Start hook executed" duration=1.92603396s function="cmd.newDaemonPromise.func1 (daemon_main.go:1629)" subsys=hive
level=debug msg="Executing start hook" function="utime.initUtimeSync.func1 (cell.go:34)" subsys=hive
level=debug msg="Starting new controller" name=sync-utime subsys=controller uuid=133d8f24-4110-4f06-bf21-73892506e3ef
level=info msg="Start hook executed" duration="10.875µs" function="utime.initUtimeSync.func1 (cell.go:34)" subsys=hive
level=info msg="Starting IP identity watcher" subsys=ipcache
level=info msg="Initializing daemon" subsys=daemon
level=info msg="Validating configured node address ranges" subsys=daemon
level=info msg="Starting connection tracking garbage collector" subsys=daemon
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=info msg="Datapath signal listener running" subsys=signal
level=debug msg="Controller func execution time: 67.292µs" name=sync-utime subsys=controller uuid=133d8f24-4110-4f06-bf21-73892506e3ef
level=info msg="Initial scan of connection tracking completed" subsys=ct-gc
level=info msg="Regenerating restored endpoints" numRestored=0 subsys=daemon
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Couldn't open CT map for upgrade" error="Unable to get object /sys/fs/bpf/tc/globals/cilium_ct6_global: no such file or directory" file-path=/sys/fs/bpf/tc/globals/cilium_ct6_global subsys=map-ct
level=debug msg="Couldn't open CT map for upgrade" error="Unable to get object /sys/fs/bpf/tc/globals/cilium_ct_any6_global: no such file or directory" file-path=/sys/fs/bpf/tc/globals/cilium_ct_any6_global subsys=map-ct
level=info msg="Creating host endpoint" subsys=daemon
level=info msg="Finished regenerating restored endpoints" regenerated=0 subsys=daemon total=0
level=debug msg="Starting new controller" name=sync-lb-maps-with-k8s-services subsys=controller uuid=57ebd3f8-5918-4d34-a128-fd81be7d35ae
level=debug msg="Endpoint creation" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=0 endpointState=waiting-for-identity ipv4= ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="Starting new controller" name=endpoint-115-regeneration-recovery subsys=controller uuid=39c2be7b-9db3-4ca1-8bc6-8c16588fa641
level=debug msg="creating new EventQueue" name=endpoint-115 numBufferedEvents=25 subsys=eventqueue
level=info msg="New endpoint" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=115 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=info msg="Deleted orphan backends" orphanBackends=0 subsys=service
level=debug msg="Controller func execution time: 400.583µs" name=sync-lb-maps-with-k8s-services subsys=controller uuid=57ebd3f8-5918-4d34-a128-fd81be7d35ae
level=debug msg="Controller run succeeded; waiting for next controller update or stop" name=sync-lb-maps-with-k8s-services subsys=controller uuid=57ebd3f8-5918-4d34-a128-fd81be7d35ae
level=debug msg="Starting new controller" name="sync-to-k8s-ciliumendpoint (115)" subsys=controller uuid=55b3147b-84ec-49ec-bbb8-6a00014f0e98
level=debug msg="Refreshing labels of endpoint" containerID= endpointID=115 identityLabels="reserved:host" infoLabels="reserved:host" subsys=endpoint
level=debug msg="Assigning information label" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=115 ipv4= ipv6= k8sPodName=/ obj="{Key:host Value: Source:reserved}" subsys=endpoint
level=debug msg="Assigning security relevant label" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=115 ipv4= ipv6= k8sPodName=/ obj="{Key:host Value: Source:reserved}" subsys=endpoint
level=info msg="Resolving identity labels (blocking)" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=115 identityLabels="reserved:host" ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Resolving identity for labels" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=115 identityLabels="reserved:host" ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Resolving identity" identityLabels="reserved:host" subsys=identity-cache
level=debug msg="Resolved reserved identity" identity=host identityLabels="reserved:host" isNew=false subsys=identity-cache
level=debug msg="Assigned new identity to endpoint" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=115 identity=1 identityLabels="reserved:host" ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing old and adding new identity" new=1 old="<nil>" subsys=identitymanager
level=debug msg="Set identity for this endpoint" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=115 endpointState=ready ipv4= ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=info msg="Identity of endpoint changed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=115 identity=1 identityLabels="reserved:host" ipv4= ipv6= k8sPodName=/ oldIdentity="no identity" subsys=endpoint
level=debug msg="Triggering endpoint regeneration due to updated security labels" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=115 endpointState=waiting-to-regenerate identity=1 ipv4= ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="Starting new controller" name=resolve-identity-115 subsys=controller uuid=ff8bbb67-ce09-4cc0-b8a0-a34fb507a63a
level=info msg="Launching Cilium health daemon" subsys=daemon
level=debug msg="Endpoint labels unchanged, skipping resolution of identity" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=115 identity=1 identityLabels="reserved:host" ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Controller func execution time: 236µs" name=resolve-identity-115 subsys=controller uuid=ff8bbb67-ce09-4cc0-b8a0-a34fb507a63a
level=debug msg="Dequeued endpoint from build queue" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Regenerating endpoint" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ reason="updated security labels" startTime="2023-06-24 17:28:40.637370584 +0000 UTC m=+2.859183294" subsys=endpoint
level=debug msg="Regenerating endpoint: updated security labels" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=115 endpointState=regenerating identity=1 ipv4= ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 directory=115_next endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_policy_00115 subsys=bpf
level=debug msg="Starting policy recalculation..." containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Forced policy recalculation" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Completed endpoint policy recalculation" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=115 forcedRegeneration=true identity=1 ipv4= ipv6= k8sPodName=/ policyCalculation="&{{{{{0 0} 0 0 {{} 0} {{} 0}}}} {0 0 <nil>} 8459 0}" subsys=endpoint waitingForIdentityCache="&{{{{{0 0} 0 0 {{} 0} {{} 0}}}} {0 0 <nil>} 0 0}" waitingForPolicyRepository="&{{{{{0 0} 0 0 {{} 0} {{} 0}}}} {0 0 <nil>} 458 0}"
level=debug msg="Endpoint has no IP addresses" endpointID=115 subsys=envoy-manager
level=debug msg="Skipping CiliumEndpoint update because it has no k8s pod name" containerID= controller="sync-to-k8s-ciliumendpoint (115)" datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpointsynchronizer
level=debug msg="Controller func execution time: 1.884792ms" name="sync-to-k8s-ciliumendpoint (115)" subsys=controller uuid=55b3147b-84ec-49ec-bbb8-6a00014f0e98
level=debug msg="BPF header file hashed (was: \"\")" bpfHeaderfileHash=3220e44a09dc8d4bf52bbe0f0d21194b0666f7f31a079839165e075980b8f5da containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=115 file-path=115_next/ep_config.h identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file with DNSRules" DNSRules="map[]" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=115 file-path=115_next/ep_config.h identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Skipping CiliumEndpoint update because it has no k8s pod name" containerID= controller="sync-to-k8s-ciliumendpoint (115)" datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpointsynchronizer
level=debug msg="Controller func execution time: 864.25µs" name="sync-to-k8s-ciliumendpoint (115)" subsys=controller uuid=55b3147b-84ec-49ec-bbb8-6a00014f0e98
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=info msg="Launching Cilium health endpoint" subsys=daemon
level=debug msg="Starting new controller" name=cilium-health-ep subsys=controller uuid=8cd01771-86f6-407a-a0eb-178aada883f5
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Preparing to compile BPF" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ regeneration-level=rewrite+load subsys=endpoint
level=info msg="Serving prometheus metrics on :9962" subsys=daemon
level=debug msg="Cannot establish connection to local cilium instance" error="Get \"http://%2Fvar%2Frun%2Fcilium%2Fcilium.sock/v1/healthz\": dial unix /var/run/cilium/cilium.sock: connect: no such file or directory" subsys=cilium-health-launcher
level=debug msg="Killing old health endpoint process" pidfile=/var/run/cilium/state/health-endpoint.pid subsys=cilium-health-launcher
level=debug msg="Didn't find existing cilium-health endpoint to delete" subsys=daemon
level=debug msg="Didn't find existing device" error="Link not found" subsys=cilium-health-launcher veth=cilium_health
level=debug msg="Didn't find existing device" error="Link not found" subsys=cilium-health-launcher veth=lxc_health
level=debug msg="Load 1-min: 3.33 5-min: 1.60 15min: 1.11" endpointID=115 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1744 (44.35%) Free: 185 Buffers: 50 Cached: 1952" endpointID=115 subsys=endpoint
level=info msg="Started healthz status API server" address="127.0.0.1:9879" subsys=daemon
level=info msg="Processing queued endpoint deletion requests from /var/run/cilium/deleteQueue" subsys=daemon
level=debug msg="Swap: Total: 1023 Used: 509 (49.74%) Free: 514" endpointID=115 subsys=endpoint
level=info msg="processing 0 queued deletion requests" subsys=daemon
level=info msg="Initializing Cilium API" subsys=daemon
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 9.88% MEM: 2.41% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 94 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="Unable to remove cilium-health namespace" error="Unable to delete named netns cilium-health: Cannot remove namespace file \"/var/run/netns/cilium-health\": No such file or directory\n exit status 1" subsys=cilium-health-launcher
level=debug msg="Starting new controller" name=neighbor-table-refresh subsys=controller uuid=0eb6e128-86c5-4262-b8bb-0e4370feeb67
level=info msg="Daemon initialization completed" bootstrapTime=2.66883846s subsys=daemon
level=debug msg="Starting new controller" name=link-cache subsys=controller uuid=6343ab4f-0ec4-4e9c-b348-16ed3270a4cd
level=debug msg="Controller func execution time: 322.792µs" name=neighbor-table-refresh subsys=controller uuid=0eb6e128-86c5-4262-b8bb-0e4370feeb67
level=debug msg="Controller func execution time: 76.458µs" name=link-cache subsys=controller uuid=6343ab4f-0ec4-4e9c-b348-16ed3270a4cd
level=info msg="Configuring Hubble server" eventQueueSize=5120 maxFlows=4095 subsys=hubble
level=debug msg="Group not found" error="group: unknown group cilium" file-path=/var/run/cilium/hubble.sock group=cilium subsys=api
level=info msg="Starting local Hubble server" address="unix:///var/run/cilium/hubble.sock" subsys=hubble
level=debug msg="TLS configuration ready" config=tls-server subsys=hubble
level=info msg="Starting Hubble server" address=":4244" subsys=hubble
level=debug msg="Created veth pair" subsys=endpoint-connector vethPair="[cilium lxc_health]"
level=debug msg="Group not found" error="group: unknown group cilium" file-path=/var/run/cilium/cilium.sock group=cilium subsys=api
level=info msg="Serving cilium API at unix:///var/run/cilium/cilium.sock" subsys=daemon
level=debug msg="Spawning health endpoint with command \"ip\" [\"netns\" \"exec\" \"cilium-health\" \"cilium-health-responder\" \"--listen\" \"4240\" \"--pidfile\" \"/var/run/cilium/state/health-endpoint.pid\"]" subsys=cilium-health-launcher
level=debug msg="Compiling datapath" clang="clang version 10.0.0 (https://github.com/llvm/llvm-project.git f5ae66a41b809db97c4fc34b29bb76be3a86fbe9)\nTarget: x86_64-unknown-linux-gnu\nThread model: posix\nInstalledDir: /usr/local/bin\n" debug=true llc="LLVM (http://llvm.org/):\n  LLVM version 10.0.0\n  Optimized build.\n  Default target: x86_64-unknown-linux-gnu\n  Host CPU: (unknown)\n\n  Registered Targets:\n    bpf   - BPF (host endian)\n    bpfeb - BPF (big endian)\n    bpfel - BPF (little endian)\n" subsys=datapath-loader
level=debug msg="Launching compiler" args="[-emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43 -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_host.c -o -]" subsys=datapath-loader target=clang
level=debug msg="Endpoint creation" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=0 endpointState=waiting-for-identity ipv4= ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="Regenerating all endpoints" subsys=policy
level=info msg="regenerating all endpoints" reason="one or more identities created or deleted" subsys=endpoint-manager
level=debug msg="Triggering endpoint regeneration due to one or more identities created or deleted" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=115 endpointState=waiting-to-regenerate identity=1 ipv4= ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Sending request for /cluster/nodes ..." subsys=health-server
level=debug msg="Got cilium /cluster/nodes" subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.4 nodeName=kind-kind/kind-control-plane primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::4" nodeName=kind-kind/kind-control-plane primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.0.245 nodeName=kind-kind/kind-control-plane primary=false protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-control-plane primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.0.187 nodeName=kind-kind/kind-control-plane primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.2 nodeName=kind-kind/kind-worker2 primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::2" nodeName=kind-kind/kind-worker2 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.3.193 nodeName=kind-kind/kind-worker2 primary=false protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-worker2 primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.3.93 nodeName=kind-kind/kind-worker2 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.2 nodeName=kind-kind/kind-worker2 primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::2" nodeName=kind-kind/kind-worker2 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.3.193 nodeName=kind-kind/kind-worker2 primary=false protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-worker2 primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.3.93 nodeName=kind-kind/kind-worker2 primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.1.170 nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.5 nodeName=kind-kind/kind-worker3 primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::5" nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.1.182 nodeName=kind-kind/kind-worker3 primary=false protocol=icmp subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.4 nodeName=kind-kind/kind-control-plane primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::4" nodeName=kind-kind/kind-control-plane primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.0.245 nodeName=kind-kind/kind-control-plane primary=false protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-control-plane primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.0.187 nodeName=kind-kind/kind-control-plane primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.2 nodeName=kind-kind/kind-worker2 primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::2" nodeName=kind-kind/kind-worker2 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.3.193 nodeName=kind-kind/kind-worker2 primary=false protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-worker2 primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.3.93 nodeName=kind-kind/kind-worker2 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.2 nodeName=kind-kind/kind-worker2 primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::2" nodeName=kind-kind/kind-worker2 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.3.193 nodeName=kind-kind/kind-worker2 primary=false protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-worker2 primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.3.93 nodeName=kind-kind/kind-worker2 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.4 nodeName=kind-kind/kind-control-plane primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::4" nodeName=kind-kind/kind-control-plane primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.0.245 nodeName=kind-kind/kind-control-plane primary=false protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-control-plane primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.0.187 nodeName=kind-kind/kind-control-plane primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.5 nodeName=kind-kind/kind-worker3 primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::5" nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.1.182 nodeName=kind-kind/kind-worker3 primary=false protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.1.170 nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.2.174 nodeName=kind-kind/kind-worker primary=false protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-worker primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.2.34 nodeName=kind-kind/kind-worker primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.3 nodeName=kind-kind/kind-worker primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::3" nodeName=kind-kind/kind-worker primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.1.182 nodeName=kind-kind/kind-worker3 primary=false protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.1.170 nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.5 nodeName=kind-kind/kind-worker3 primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::5" nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.4 nodeName=kind-kind/kind-control-plane primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::4" nodeName=kind-kind/kind-control-plane primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.0.245 nodeName=kind-kind/kind-control-plane primary=false protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-control-plane primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.0.187 nodeName=kind-kind/kind-control-plane primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-worker primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.2.34 nodeName=kind-kind/kind-worker primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.3 nodeName=kind-kind/kind-worker primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::3" nodeName=kind-kind/kind-worker primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.2.174 nodeName=kind-kind/kind-worker primary=false protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-worker primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.2.34 nodeName=kind-kind/kind-worker primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.3 nodeName=kind-kind/kind-worker primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::3" nodeName=kind-kind/kind-worker primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.2.174 nodeName=kind-kind/kind-worker primary=false protocol=icmp subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.3 nodeName=kind-kind/kind-worker primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::3" nodeName=kind-kind/kind-worker primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.2.174 nodeName=kind-kind/kind-worker primary=false protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-worker primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.2.34 nodeName=kind-kind/kind-worker primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.5 nodeName=kind-kind/kind-worker3 primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::5" nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.1.182 nodeName=kind-kind/kind-worker3 primary=false protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.1.170 nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.1.170 nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.5 nodeName=kind-kind/kind-worker3 primary=true protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::5" nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.1.182 nodeName=kind-kind/kind-worker3 primary=false protocol=icmp subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Load 1-min: 3.33 5-min: 1.60 15min: 1.11" endpointID=115 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1819 (46.27%) Free: 108 Buffers: 45 Cached: 1959" endpointID=115 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 511 (49.97%) Free: 512" endpointID=115 subsys=endpoint
level=debug msg="Probe successful" ipAddr=172.27.0.4 nodeName=kind-kind/kind-control-plane rtt="375.959µs" subsys=health-server
level=debug msg="Probe successful" ipAddr=172.27.0.3 nodeName=kind-kind/kind-worker rtt="433.375µs" subsys=health-server
level=debug msg="Probe successful" ipAddr=172.27.0.2 nodeName=kind-kind/kind-worker2 rtt="465µs" subsys=health-server
level=debug msg="Probe successful" ipAddr=172.27.0.5 nodeName=kind-kind/kind-worker3 rtt="502.041µs" subsys=health-server
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 8.18% MEM: 2.46% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 96 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="NAME clang STATUS [zombie] PID 268 CPU: 51.03% MEM: 0.00% CMDLINE:  MEM-EXT: RSS: 0 VMS: 0 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="NAME llc STATUS [running] PID 269 CPU: 1.82% MEM: 0.58% CMDLINE: llc -march=bpf -mcpu=v3 -filetype=obj -o /var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43/bpf_host.dbg.o MEM-EXT: RSS: 22 VMS: 36 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="Skip pod event using host networking" k8sNamespace=kube-system k8sPodName=cilium-cp565 new-hostIP=172.27.0.2 new-podIP=172.27.0.2 new-podIPs="[{172.27.0.2} {fc00:c111::2}]" old-hostIP=172.27.0.2 old-podIP=172.27.0.2 old-podIPs="[{172.27.0.2} {fc00:c111::2}]" subsys=k8s-watcher
level=debug msg="cilium-health agent running" pidfile=/var/run/cilium/state/health-endpoint.pid subsys=cilium-health-launcher
level=debug msg="Adding route" command="ip route add 10.244.3.93/32 dev cilium" netns=cilium-health subsys=cilium-health-launcher
level=debug msg="Adding route" command="ip route add 0.0.0.0/0 via 10.244.3.93 mtu 1500 dev cilium" netns=cilium-health subsys=cilium-health-launcher
level=debug msg="Running \"ip [netns exec cilium-health bash -c ip route add 10.244.3.93/32 dev cilium && ip route add 0.0.0.0/0 via 10.244.3.93 mtu 1500 dev cilium]\"" subsys=cilium-health-launcher
level=debug msg="Starting new controller" name=endpoint-705-regeneration-recovery subsys=controller uuid=4ccac62f-bde0-4fd5-820e-748cf19b0bd1
level=debug msg="creating new EventQueue" name=endpoint-705 numBufferedEvents=25 subsys=eventqueue
level=info msg="New endpoint" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=705 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Starting new controller" name="sync-to-k8s-ciliumendpoint (705)" subsys=controller uuid=5ad2e8d2-4085-4019-b249-dd5bcaf8e742
level=debug msg="Refreshing labels of endpoint" containerID= endpointID=705 identityLabels="reserved:health" infoLabels= subsys=endpoint
level=debug msg="Assigning security relevant label" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=705 ipv4=10.244.3.193 ipv6= k8sPodName=/ obj="{Key:health Value: Source:reserved}" subsys=endpoint
level=info msg="Resolving identity labels (blocking)" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=705 identityLabels="reserved:health" ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Skipping CiliumEndpoint update because it has no k8s pod name" containerID= controller="sync-to-k8s-ciliumendpoint (705)" datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=705 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpointsynchronizer
level=debug msg="Controller func execution time: 154.042µs" name="sync-to-k8s-ciliumendpoint (705)" subsys=controller uuid=5ad2e8d2-4085-4019-b249-dd5bcaf8e742
level=debug msg="Resolving identity for labels" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=705 identityLabels="reserved:health" ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Resolving identity" identityLabels="reserved:health" subsys=identity-cache
level=debug msg="Resolved reserved identity" identity=health identityLabels="reserved:health" isNew=false subsys=identity-cache
level=debug msg="Assigned new identity to endpoint" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=705 identity=4 identityLabels="reserved:health" ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing old and adding new identity" new=4 old="<nil>" subsys=identitymanager
level=debug msg="Set identity for this endpoint" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=705 endpointState=ready ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=info msg="Identity of endpoint changed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=705 identity=4 identityLabels="reserved:health" ipv4=10.244.3.193 ipv6= k8sPodName=/ oldIdentity="no identity" subsys=endpoint
level=debug msg="Triggering endpoint regeneration due to updated security labels" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=705 endpointState=waiting-to-regenerate identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="Starting new controller" name=resolve-identity-705 subsys=controller uuid=2d9d8394-aad9-4bb3-9012-558ab54fbdb4
level=debug msg="Controller func execution time: 1.070411834s" name=cilium-health-ep subsys=controller uuid=8cd01771-86f6-407a-a0eb-178aada883f5
level=debug msg="Endpoint labels unchanged, skipping resolution of identity" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=705 identity=4 identityLabels="reserved:health" ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Controller func execution time: 55.417µs" name=resolve-identity-705 subsys=controller uuid=2d9d8394-aad9-4bb3-9012-558ab54fbdb4
level=debug msg="Dequeued endpoint from build queue" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Regenerating endpoint" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ reason="updated security labels" startTime="2023-06-24 17:28:41.711576001 +0000 UTC m=+3.933388711" subsys=endpoint
level=debug msg="Regenerating endpoint: updated security labels" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=705 endpointState=regenerating identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 directory=705_next endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_policy_00705 subsys=bpf
level=debug msg="Starting policy recalculation..." containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Forced policy recalculation" containerID= datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Completed endpoint policy recalculation" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 forcedRegeneration=true identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyCalculation="&{{{{{0 0} 0 0 {{} 0} {{} 0}}}} {0 0 <nil>} 17208 0}" subsys=endpoint waitingForIdentityCache="&{{{{{0 0} 0 0 {{} 0} {{} 0}}}} {0 0 <nil>} 0 0}" waitingForPolicyRepository="&{{{{{0 0} 0 0 {{} 0} {{} 0}}}} {0 0 <nil>} 541 0}"
level=debug msg="Skipping CiliumEndpoint update because it has no k8s pod name" containerID= controller="sync-to-k8s-ciliumendpoint (705)" datapathPolicyRevision=0 desiredPolicyRevision=0 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpointsynchronizer
level=debug msg="Controller func execution time: 1.392792ms" name="sync-to-k8s-ciliumendpoint (705)" subsys=controller uuid=5ad2e8d2-4085-4019-b249-dd5bcaf8e742
level=debug msg="preparing new cache transaction: upserting 1 entries, deleting 0 entries" subsys=xds xdsCachedVersion=2 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="inserting resource into cache" subsys=xds xdsCachedVersion=2 xdsResourceName=705 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="committing cache transaction and notifying of new version" subsys=xds xdsCachedVersion=2 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="BPF header file hashed (was: \"\")" bpfHeaderfileHash=86bea98f3e604d817401ad2b9fa935bde199f4e73c922857c07ae0ae05ed07ce containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/ep_config.h identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file with DNSRules" DNSRules="map[]" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/ep_config.h identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Preparing to compile BPF" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ regeneration-level=rewrite+load subsys=endpoint
level=debug msg="Load 1-min: 3.33 5-min: 1.60 15min: 1.11" endpointID=705 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1816 (46.18%) Free: 99 Buffers: 45 Cached: 1972" endpointID=705 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 511 (49.97%) Free: 512" endpointID=705 subsys=endpoint
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 8.27% MEM: 2.46% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 96 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="NAME clang STATUS [zombie] PID 268 CPU: 48.97% MEM: 0.00% CMDLINE:  MEM-EXT: RSS: 0 VMS: 0 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="NAME llc STATUS [running] PID 269 CPU: 4.66% MEM: 0.65% CMDLINE: llc -march=bpf -mcpu=v3 -filetype=obj -o /var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43/bpf_host.dbg.o MEM-EXT: RSS: 25 VMS: 37 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="Compiling datapath" clang="clang version 10.0.0 (https://github.com/llvm/llvm-project.git f5ae66a41b809db97c4fc34b29bb76be3a86fbe9)\nTarget: x86_64-unknown-linux-gnu\nThread model: posix\nInstalledDir: /usr/local/bin\n" debug=true llc="LLVM (http://llvm.org/):\n  LLVM version 10.0.0\n  Optimized build.\n  Default target: x86_64-unknown-linux-gnu\n  Host CPU: (unknown)\n\n  Registered Targets:\n    bpf   - BPF (host endian)\n    bpfeb - BPF (big endian)\n    bpfel - BPF (little endian)\n" subsys=datapath-loader
level=debug msg="Launching compiler" args="[-emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_lxc.c -o -]" subsys=datapath-loader target=clang
level=debug msg="Launching compiler" args="[-emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43 -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_host.c -o -]" subsys=datapath-loader target=clang
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Load 1-min: 3.33 5-min: 1.60 15min: 1.11" endpointID=115 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1841 (46.82%) Free: 103 Buffers: 42 Cached: 1945" endpointID=115 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 511 (49.98%) Free: 512" endpointID=115 subsys=endpoint
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 6.90% MEM: 2.44% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 96 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="NAME clang STATUS [zombie] PID 294 CPU: 32.13% MEM: 0.00% CMDLINE:  MEM-EXT: RSS: 0 VMS: 0 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="NAME llc STATUS [running] PID 295 CPU: 3.64% MEM: 0.66% CMDLINE: llc -march=bpf -mcpu=v3 -filetype=obj -o /var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d/bpf_lxc.dbg.o MEM-EXT: RSS: 26 VMS: 35 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="NAME clang STATUS [running] PID 296 CPU: 4.62% MEM: 0.89% CMDLINE: clang -emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43 -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_host.c -o - MEM-EXT: RSS: 34 VMS: 76 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-worker primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.2.34 nodeName=kind-kind/kind-worker primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.3 nodeName=kind-kind/kind-worker primary=true protocol=http subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::3" nodeName=kind-kind/kind-worker primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.2.174 nodeName=kind-kind/kind-worker primary=false protocol=http subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-control-plane primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.0.187 nodeName=kind-kind/kind-control-plane primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.4 nodeName=kind-kind/kind-control-plane primary=true protocol=http subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::4" nodeName=kind-kind/kind-control-plane primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.0.245 nodeName=kind-kind/kind-control-plane primary=false protocol=http subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::2" nodeName=kind-kind/kind-worker2 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.3.193 nodeName=kind-kind/kind-worker2 primary=false protocol=http subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-worker2 primary=false subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.3.93 nodeName=kind-kind/kind-worker2 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.2 nodeName=kind-kind/kind-worker2 primary=true protocol=http subsys=health-server
level=debug msg="Skipping probe for address" ipAddr=10.244.1.170 nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=172.27.0.5 nodeName=kind-kind/kind-worker3 primary=true protocol=http subsys=health-server
level=debug msg="Skipping probe for address" ipAddr="fc00:c111::5" nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Probing for connectivity to node" ipAddr=10.244.1.182 nodeName=kind-kind/kind-worker3 primary=false protocol=http subsys=health-server
level=debug msg="Skipping probe for address" ipAddr= nodeName=kind-kind/kind-worker3 primary=false subsys=health-server
level=debug msg="Greeting host" host="http://172.27.0.3:4240" ipAddr=172.27.0.3 nodeName=kind-kind/kind-worker path="Via L3" subsys=health-server
level=debug msg="Greeting successful" host="http://172.27.0.3:4240" ipAddr=172.27.0.3 nodeName=kind-kind/kind-worker path="Via L3" rtt=7.017ms subsys=health-server
level=debug msg="Greeting host" host="http://10.244.2.174:4240" ipAddr=10.244.2.174 nodeName=kind-kind/kind-worker path="Via L3" subsys=health-server
level=debug msg="Load 1-min: 3.33 5-min: 1.60 15min: 1.11" endpointID=705 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1856 (47.20%) Free: 88 Buffers: 42 Cached: 1945" endpointID=705 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 511 (49.98%) Free: 512" endpointID=705 subsys=endpoint
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 6.82% MEM: 2.45% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 96 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="NAME clang STATUS [zombie] PID 294 CPU: 30.80% MEM: 0.00% CMDLINE:  MEM-EXT: RSS: 0 VMS: 0 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="NAME llc STATUS [running] PID 295 CPU: 5.23% MEM: 0.74% CMDLINE: llc -march=bpf -mcpu=v3 -filetype=obj -o /var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d/bpf_lxc.dbg.o MEM-EXT: RSS: 29 VMS: 38 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="NAME clang STATUS [running] PID 296 CPU: 6.93% MEM: 0.99% CMDLINE: clang -emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43 -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_host.c -o - MEM-EXT: RSS: 39 VMS: 79 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="Launching compiler" args="[-emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_lxc.c -o -]" subsys=datapath-loader target=clang
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Load 1-min: 3.33 5-min: 1.60 15min: 1.11" endpointID=115 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1886 (47.97%) Free: 64 Buffers: 42 Cached: 1939" endpointID=115 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 511 (49.97%) Free: 512" endpointID=115 subsys=endpoint
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 5.86% MEM: 2.44% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 96 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="NAME clang STATUS [running] PID 296 CPU: 33.29% MEM: 1.41% CMDLINE: clang -emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43 -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_host.c -o - MEM-EXT: RSS: 55 VMS: 90 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="NAME clang STATUS [running] PID 298 CPU: 23.00% MEM: 1.30% CMDLINE: clang -emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_lxc.c -o - MEM-EXT: RSS: 51 VMS: 86 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="Load 1-min: 3.33 5-min: 1.60 15min: 1.11" endpointID=705 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1890 (48.06%) Free: 72 Buffers: 42 Cached: 1927" endpointID=705 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 511 (49.97%) Free: 512" endpointID=705 subsys=endpoint
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 5.95% MEM: 2.43% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 95 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="NAME clang STATUS [running] PID 296 CPU: 34.24% MEM: 1.40% CMDLINE: clang -emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43 -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_host.c -o - MEM-EXT: RSS: 55 VMS: 90 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="NAME clang STATUS [running] PID 298 CPU: 25.53% MEM: 1.32% CMDLINE: clang -emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_lxc.c -o - MEM-EXT: RSS: 52 VMS: 86 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="Controller func execution time: 31.417µs" name=metricsmap-bpf-prom-sync subsys=controller uuid=e93fb8e5-7d52-4e3b-a7c4-8bc7f60ca14d
level=debug msg="Launching compiler" args="[-E -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_lxc.c -o /var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d/bpf_lxc.c]" subsys=datapath-loader target=clang
level=debug msg="Launching compiler" args="[-emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_lxc.c -o -]" subsys=datapath-loader target=clang
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Load 1-min: 3.33 5-min: 1.60 15min: 1.11" endpointID=115 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1896 (48.21%) Free: 61 Buffers: 42 Cached: 1933" endpointID=115 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 511 (49.95%) Free: 512" endpointID=115 subsys=endpoint
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 5.35% MEM: 2.43% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 95 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="NAME clang STATUS [zombie] PID 296 CPU: 32.74% MEM: 0.00% CMDLINE:  MEM-EXT: RSS: 0 VMS: 0 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="NAME llc STATUS [running] PID 297 CPU: 8.28% MEM: 1.10% CMDLINE: llc -march=bpf -mcpu=v3 -filetype=asm -o /var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43/bpf_host.asm MEM-EXT: RSS: 43 VMS: 53 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="NAME clang STATUS [running] PID 312 CPU: 12.16% MEM: 1.15% CMDLINE: clang -emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_lxc.c -o - MEM-EXT: RSS: 45 VMS: 82 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="Load 1-min: 3.33 5-min: 1.60 15min: 1.11" endpointID=705 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1902 (48.36%) Free: 64 Buffers: 42 Cached: 1924" endpointID=705 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 511 (49.95%) Free: 512" endpointID=705 subsys=endpoint
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 5.31% MEM: 2.44% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 95 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="NAME clang STATUS [zombie] PID 296 CPU: 31.93% MEM: 0.00% CMDLINE:  MEM-EXT: RSS: 0 VMS: 0 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="NAME llc STATUS [running] PID 297 CPU: 9.54% MEM: 1.13% CMDLINE: llc -march=bpf -mcpu=v3 -filetype=asm -o /var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43/bpf_host.asm MEM-EXT: RSS: 44 VMS: 54 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="NAME clang STATUS [running] PID 312 CPU: 15.18% MEM: 1.22% CMDLINE: clang -emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_lxc.c -o - MEM-EXT: RSS: 48 VMS: 84 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="Launching compiler" args="[-E -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43 -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_host.c -o /var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43/bpf_host.c]" subsys=datapath-loader target=clang
level=debug msg="Launching compiler" args="[-emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43 -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_host.c -o -]" subsys=datapath-loader target=clang
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Load 1-min: 3.79 5-min: 1.72 15min: 1.15" endpointID=115 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1837 (46.71%) Free: 111 Buffers: 42 Cached: 1942" endpointID=115 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 511 (49.95%) Free: 512" endpointID=115 subsys=endpoint
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 4.73% MEM: 2.43% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 95 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="NAME clang STATUS [zombie] PID 312 CPU: 31.94% MEM: 0.00% CMDLINE:  MEM-EXT: RSS: 0 VMS: 0 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="NAME llc STATUS [running] PID 313 CPU: 1.81% MEM: 0.56% CMDLINE: llc -march=bpf -mcpu=v3 -filetype=obj -o /var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d/bpf_lxc.o MEM-EXT: RSS: 22 VMS: 33 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="NAME clang STATUS [running] PID 315 CPU: 8.43% MEM: 1.22% CMDLINE: clang -emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43 -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_host.c -o - MEM-EXT: RSS: 48 VMS: 83 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="Load 1-min: 3.79 5-min: 1.72 15min: 1.15" endpointID=705 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1851 (47.07%) Free: 97 Buffers: 42 Cached: 1942" endpointID=705 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 511 (49.95%) Free: 512" endpointID=705 subsys=endpoint
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 4.70% MEM: 2.43% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 95 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="NAME clang STATUS [zombie] PID 312 CPU: 30.71% MEM: 0.00% CMDLINE:  MEM-EXT: RSS: 0 VMS: 0 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="NAME llc STATUS [running] PID 313 CPU: 4.63% MEM: 0.74% CMDLINE: llc -march=bpf -mcpu=v3 -filetype=obj -o /var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d/bpf_lxc.o MEM-EXT: RSS: 29 VMS: 38 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="NAME clang STATUS [running] PID 315 CPU: 9.85% MEM: 1.22% CMDLINE: clang -emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43 -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_host.c -o - MEM-EXT: RSS: 48 VMS: 83 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=info msg="Compiled new BPF template" BPFCompilationTime=4.454374627s file-path=/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d/bpf_lxc.o subsys=datapath-loader
level=debug msg="Watching template path" file-path=/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d/bpf_lxc.o subsys=datapath-loader
level=debug msg="Found variable with offset 85756" subsys=elf symbol=LXC_ID
level=debug msg="Found variable with offset 85752" subsys=elf symbol=LXC_IPV4
level=debug msg="Found variable with offset 85736" subsys=elf symbol=LXC_IP_1
level=debug msg="Found variable with offset 85740" subsys=elf symbol=LXC_IP_2
level=debug msg="Found variable with offset 85744" subsys=elf symbol=LXC_IP_3
level=debug msg="Found variable with offset 85748" subsys=elf symbol=LXC_IP_4
level=debug msg="Found variable with offset 85760" subsys=elf symbol=NODE_MAC_1
level=debug msg="Found variable with offset 85764" subsys=elf symbol=NODE_MAC_2
level=debug msg="Found variable with offset 85776" subsys=elf symbol=POLICY_VERDICT_LOG_FILTER
level=debug msg="Found variable with offset 85768" subsys=elf symbol=SECLABEL
level=debug msg="Found variable with offset 85772" subsys=elf symbol=SECLABEL_NB
level=debug msg="Found symbol referring to unknown section id 30" subsys=elf symbol=____license
level=debug msg="Skipping __send_drop_notify" subsys=elf
level=debug msg="Skipping cil_from_container" subsys=elf
level=debug msg="Skipping cil_to_container" subsys=elf
level=debug msg="Found symbol with offset 839416" subsys=elf symbol=cilium_auth_map
level=debug msg="Found symbol with offset 839048" subsys=elf symbol=cilium_call_policy
level=debug msg="Found symbol with offset 842501" subsys=elf symbol=cilium_calls_65535
level=debug msg="Found symbol with offset 839510" subsys=elf symbol=cilium_ct4_global
level=debug msg="Found symbol with offset 839488" subsys=elf symbol=cilium_ct_any4_global
level=debug msg="Found symbol with offset 839588" subsys=elf symbol=cilium_encrypt_state
level=debug msg="Found symbol with offset 839181" subsys=elf symbol=cilium_events
level=debug msg="Found symbol with offset 839654" subsys=elf symbol=cilium_ipcache
level=debug msg="Found symbol with offset 839242" subsys=elf symbol=cilium_ipv4_frag_datagrams
level=debug msg="Found symbol with offset 839009" subsys=elf symbol=cilium_lb4_affinity
level=debug msg="Found symbol with offset 843574" subsys=elf symbol=cilium_lb4_backends_v3
level=debug msg="Found symbol with offset 839158" subsys=elf symbol=cilium_lb4_reverse_nat
level=debug msg="Found symbol with offset 844261" subsys=elf symbol=cilium_lb4_services_v2
level=debug msg="Found symbol with offset 839669" subsys=elf symbol=cilium_lb4_source_range
level=debug msg="Found symbol with offset 839528" subsys=elf symbol=cilium_lb_affinity_match
level=debug msg="Found symbol with offset 839693" subsys=elf symbol=cilium_lxc
level=debug msg="Found symbol with offset 839302" subsys=elf symbol=cilium_metrics
level=debug msg="Found symbol with offset 839432" subsys=elf symbol=cilium_node_map
level=debug msg="Found symbol with offset 842883" subsys=elf symbol=cilium_nodeport_neigh4
level=debug msg="Found symbol with offset 842481" subsys=elf symbol=cilium_policy_65535
level=debug msg="Found symbol with offset 839553" subsys=elf symbol=cilium_runtime_config
level=debug msg="Found symbol with offset 839269" subsys=elf symbol=cilium_signals
level=debug msg="Found symbol with offset 839464" subsys=elf symbol=cilium_snat_v4_external
level=debug msg="Found symbol with offset 842858" subsys=elf symbol=cilium_tail_call_buffer4
level=debug msg="Skipping handle_policy" subsys=elf
level=debug msg="Skipping tail_handle_arp" subsys=elf
level=debug msg="Skipping tail_handle_ipv4" subsys=elf
level=debug msg="Skipping tail_handle_ipv4_cont" subsys=elf
level=debug msg="Skipping tail_handle_snat_fwd_ipv4" subsys=elf
level=debug msg="Skipping tail_ipv4_ct_egress" subsys=elf
level=debug msg="Skipping tail_ipv4_ct_ingress" subsys=elf
level=debug msg="Skipping tail_ipv4_to_endpoint" subsys=elf
level=debug msg="Skipping tail_rev_nodeport_lb4" subsys=elf
level=debug msg="Found section with offset 839105" subsys=elf symbol=.BTF.ext
level=debug msg="Found section with offset 839288" subsys=elf symbol=.debug_ranges
level=debug msg="Found section with offset 839368" subsys=elf symbol=to-container
level=debug msg="Found section with offset 839385" subsys=elf symbol=from-container
level=debug msg="Found section with offset 839452" subsys=elf symbol=.debug_info
level=debug msg="Found section with offset 839579" subsys=elf symbol=1/0xffff
level=debug msg="Found section with offset 839625" subsys=elf symbol=.debug_line
level=debug msg="Found section with offset 839641" subsys=elf symbol=.debug_frame
level=debug msg="Found section with offset 839708" subsys=elf symbol=.debug_loc
level=debug msg="Found section with offset 839790" subsys=elf symbol=.BTF
level=debug msg="Found section with offset 840219" subsys=elf symbol=2/29
level=debug msg="Found section with offset 840685" subsys=elf symbol=2/38
level=debug msg="Found section with offset 841389" subsys=elf symbol=2/27
level=debug msg="Found section with offset 841460" subsys=elf symbol=2/17
level=debug msg="Found section with offset 841507" subsys=elf symbol=2/7
level=debug msg="Found section with offset 842088" subsys=elf symbol=2/6
level=debug msg="Found section with offset 842677" subsys=elf symbol=2/25
level=debug msg="Found section with offset 844183" subsys=elf symbol=2/13
level=debug msg="Found section with offset 845521" subsys=elf symbol=2/1
level=debug msg="Finished writing ELF" error="<nil>" new-elf-path=705_next/bpf_lxc.o subsys=elf template-path=/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d/bpf_lxc.o
level=debug msg="Loading CollectionSpec from ELF" device=lxc_health ifindex=7 objPath=705_next/bpf_lxc.o subsys=datapath-loader
level=debug msg="Loading Collection into kernel" device=lxc_health ifindex=7 objPath=705_next/bpf_lxc.o subsys=datapath-loader
Verifier error: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)
Verifier log: load program: permission denied:
	btf_vmlinux is malformed
	R1 type=ctx expected=fp
	; int tail_handle_ipv4(struct __ctx_buff *ctx)
	0: (bf) r6 = r1
	; ctx_pull_data(ctx, tot_len);
	1: (b4) w2 = 34
	2: (85) call bpf_skb_pull_data#39
	3: (b4) w8 = -134
	; return (void *)(unsigned long)ctx->data_end;
	4: (61) r1 = *(u32 *)(r6 +80)
	; return (void *)(unsigned long)ctx->data;
	5: (61) r7 = *(u32 *)(r6 +76)
	; if (data + tot_len > data_end)
	6: (bf) r2 = r7
	7: (07) r2 += 34
	; __s8 ext_err = 0;
	8: (b4) w9 = 0
	9: (7b) *(u64 *)(r10 -128) = r6
	; if (data + tot_len > data_end)
	10: (2d) if r2 > r1 goto pc+1158
	 R0_w=inv(id=0) R1_w=pkt_end(id=0,off=0,imm=0) R2_w=pkt(id=0,off=34,r=34,imm=0) R6_w=ctx(id=0,off=0,imm=0) R7_w=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967162 R9_w=inv0 R10=fp0 fp-128_w=ctx
	11: (b4) w8 = -132
	; return ip4->saddr == LXC_IPV4;
	12: (18) r1 = 0xc103f40a
	; return ip4->saddr == LXC_IPV4;
	14: (61) r2 = *(u32 *)(r7 +26)
	; __s8 ext_err = 0;
	15: (b4) w9 = 0
	; if (unlikely(!is_valid_lxc_src_ipv4(ip4)))
	16: (5e) if w2 != w1 goto pc+1152
	 R0=inv(id=0) R1=inv3238261770 R2=inv3238261770 R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967164 R9=inv0 R10=fp0 fp-128=ctx
	17: (b4) w1 = 0
	; struct ipv4_ct_tuple tuple = {};
	18: (6b) *(u16 *)(r10 -92) = r1
	last_idx 18 first_idx 16
	regs=2 stack=0 before 17: (b4) w1 = 0
	19: (63) *(u32 *)(r10 -96) = r1
	; struct lb4_key key = {};
	20: (63) *(u32 *)(r10 -112) = r1
	21: (b7) r1 = 0
	22: (7b) *(u64 *)(r10 -120) = r1
	last_idx 22 first_idx 16
	regs=2 stack=0 before 21: (b7) r1 = 0
	23: (b4) w8 = -158
	; return ip4->frag_off & bpf_htons(0x1FFF);
	24: (69) r1 = *(u16 *)(r7 +20)
	; tuple->nexthdr = ip4->protocol;
	25: (63) *(u32 *)(r10 -132) = r1
	26: (71) r1 = *(u8 *)(r7 +23)
	; tuple->nexthdr = ip4->protocol;
	27: (73) *(u8 *)(r10 -92) = r1
	; tuple->daddr = ip4->daddr;
	28: (61) r2 = *(u32 *)(r7 +30)
	; tuple->daddr = ip4->daddr;
	29: (63) *(u32 *)(r10 -104) = r2
	; tuple->saddr = ip4->saddr;
	30: (61) r3 = *(u32 *)(r7 +26)
	; tuple->saddr = ip4->saddr;
	31: (63) *(u32 *)(r10 -100) = r3
	; return ip4->ihl * 4;
	32: (71) r9 = *(u8 *)(r7 +14)
	; return ip4->ihl * 4;
	33: (64) w9 <<= 2
	34: (54) w9 &= 60
	; *l4_off = l3_off + ipv4_hdrlen(ip4);
	35: (04) w9 += 14
	; switch (tuple->nexthdr) {
	36: (16) if w1 == 0x1 goto pc+113
	 R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2_w=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3_w=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967138 R9_w=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120_w=00000000 fp-128=ctx fp-136=mmmm????
	37: (16) if w1 == 0x11 goto pc+1
	 R0=inv(id=0) R1=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	38: (56) if w1 != 0x6 goto pc+29
	 R0=inv(id=0) R1=inv6 R2=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; struct ipv4_frag_id frag_id = {
	39: (63) *(u32 *)(r10 -20) = r3
	40: (63) *(u32 *)(r10 -24) = r2
	; .id = ip4->id,
	41: (69) r2 = *(u16 *)(r7 +18)
	42: (b4) w3 = 0
	; struct ipv4_frag_id frag_id = {
	43: (73) *(u8 *)(r10 -13) = r3
	last_idx 43 first_idx 37
	regs=8 stack=0 before 42: (b4) w3 = 0
	44: (73) *(u8 *)(r10 -14) = r1
	45: (6b) *(u16 *)(r10 -16) = r2
	; return ip4->frag_off & bpf_htons(0x3FFF);
	46: (61) r1 = *(u32 *)(r10 -132)
	47: (54) w1 &= 65343
	; if (unlikely(is_fragment)) {
	48: (16) if w1 == 0x0 goto pc+45
	 R0=inv(id=0) R1=inv(id=0,umax_value=65343,var_off=(0x0; 0xff3f)) R2=inv(id=0,umax_value=65535,var_off=(0x0; 0xffff)) R3=invP0 R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; return ctx->len;
	49: (61) r6 = *(u32 *)(r6 +0)
	50: (b7) r1 = 0
	; struct metrics_value *entry, new_entry = {};
	51: (7b) *(u64 *)(r10 -72) = r1
	last_idx 51 first_idx 48
	regs=2 stack=0 before 50: (b7) r1 = 0
	52: (7b) *(u64 *)(r10 -80) = r1
	53: (b7) r1 = 521
	; struct metrics_key key = {};
	54: (7b) *(u64 *)(r10 -88) = r1
	55: (bf) r2 = r10
	;
	56: (07) r2 += -88
	; entry = map_lookup_elem(&METRICS_MAP, &key);
	57: (18) r1 = 0xffff413a9dac6800
	59: (85) call bpf_map_lookup_elem#1
	; if (entry) {
	60: (15) if r0 == 0x0 goto pc+9
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; entry->count += 1;
	61: (79) r1 = *(u64 *)(r0 +0)
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	62: (07) r1 += 1
	63: (7b) *(u64 *)(r0 +0) = r1
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; entry->bytes += bytes;
	64: (79) r1 = *(u64 *)(r0 +8)
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	65: (0f) r1 += r6
	66: (7b) *(u64 *)(r0 +8) = r1
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	67: (05) goto pc+13
	; return ip4->frag_off & bpf_htons(0x1FFF);
	81: (69) r1 = *(u16 *)(r7 +20)
	; return ip4->frag_off & bpf_htons(0x1FFF);
	82: (54) w1 &= 65311
	83: (79) r6 = *(u64 *)(r10 -128)
	; if (likely(not_first_fragment))
	84: (16) if w1 == 0x0 goto pc+9
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0,umax_value=65311,var_off=(0x0; 0xff1f)) R6_w=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	85: (bf) r2 = r10
	;
	86: (07) r2 += -24
	; tmp = map_lookup_elem(&IPV4_FRAG_DATAGRAMS_MAP, frag_id);
	87: (18) r1 = 0xffff413b1d08e000
	89: (85) call bpf_map_lookup_elem#1
	; if (!tmp)
	90: (55) if r0 != 0x0 goto pc+1327
	
	from 90 to 1418: R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; case  4: __it_mob(d, s, 32);
	1418: (61) r1 = *(u32 *)(r0 +0)
	 R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	1419: (63) *(u32 *)(r10 -96) = r1
	1420: (05) goto pc-1272
	; map_update_elem(&METRICS_MAP, &key, &new_entry, 0);
	149: (b4) w8 = 0
	150: (b4) w1 = 1
	; if (IS_ERR(ret)) {
	151: (16) if w8 == 0x2 goto pc+1
	last_idx 151 first_idx 149
	regs=100 stack=0 before 150: (b4) w1 = 1
	regs=100 stack=0 before 149: (b4) w8 = 0
	152: (b4) w1 = 0
	153: (bc) w2 = w8
	154: (74) w2 >>= 31
	155: (4c) w2 |= w1
	; if (IS_ERR(ret)) {
	156: (16) if w2 == 0x0 goto pc+8
	; if (ret == DROP_NO_SERVICE || ret == DROP_UNKNOWN_L4)
	165: (63) *(u32 *)(r10 -148) = r9
	; key->address = tuple->daddr;
	166: (61) r1 = *(u32 *)(r10 -104)
	; key->address = tuple->daddr;
	167: (63) *(u32 *)(r10 -120) = r1
	; key->dport = tuple->sport;
	168: (69) r1 = *(u16 *)(r10 -94)
	; key->dport = tuple->sport;
	169: (6b) *(u16 *)(r10 -116) = r1
	170: (b4) w8 = -134
	171: (b4) w9 = 0
	; key->proto = 0;
	172: (73) *(u8 *)(r10 -112) = r9
	last_idx 172 first_idx 165
	regs=200 stack=0 before 171: (b4) w9 = 0
	; return (void *)(unsigned long)ctx->data_end;
	173: (61) r1 = *(u32 *)(r6 +80)
	; return (void *)(unsigned long)ctx->data;
	174: (61) r2 = *(u32 *)(r6 +76)
	; if (data + tot_len > data_end)
	175: (07) r2 += 34
	; if (data + tot_len > data_end)
	176: (2d) if r2 > r1 goto pc+992
	 R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R1_w=pkt_end(id=0,off=0,imm=0) R2_w=pkt(id=0,off=34,r=34,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967162 R9_w=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????0000 fp-120=00mmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	177: (b4) w6 = 0
	; key->backend_slot = 0;
	178: (6b) *(u16 *)(r10 -114) = r6
	last_idx 178 first_idx 165
	regs=40 stack=0 before 177: (b4) w6 = 0
	; key->scope = LB_LOOKUP_SCOPE_EXT;
	179: (73) *(u8 *)(r10 -111) = r6
	180: (bf) r2 = r10
	;
	181: (07) r2 += -120
	; svc = map_lookup_elem(&LB4_SERVICES_MAP_V2, key);
	182: (18) r1 = 0xffff413a9da6cc00
	184: (85) call bpf_map_lookup_elem#1
	185: (b7) r2 = 0
	; if (svc) {
	186: (15) if r0 == 0x0 goto pc+12
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R2_w=inv0 R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	; return svc->flags2 & SVC_FLAG_TWO_SCOPES;
	187: (71) r1 = *(u8 *)(r0 +9)
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R2_w=inv0 R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	; return svc->flags2 & SVC_FLAG_TWO_SCOPES;
	188: (54) w1 &= 32
	189: (bf) r2 = r0
	; if (!scope_switch || !lb4_svc_is_two_scopes(svc))
	190: (16) if w1 == 0x0 goto pc+8
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R1_w=inv(id=0,umax_value=32,var_off=(0x0; 0x20)) R2_w=map_value(id=0,off=0,ks=12,vs=12,imm=0) R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	191: (b4) w1 = 1
	; key->scope = LB_LOOKUP_SCOPE_INT;
	192: (73) *(u8 *)(r10 -111) = r1
	193: (bf) r2 = r10
	194: (07) r2 += -120
	; svc = map_lookup_elem(&LB4_SERVICES_MAP_V2, key);
	195: (18) r1 = 0xffff413a9da6cc00
	197: (85) call bpf_map_lookup_elem#1
	198: (bf) r2 = r0
	; __u8 flags = tuple->flags;
	199: (71) r7 = *(u8 *)(r10 -91)
	; __be32 saddr = tuple->saddr;
	200: (61) r1 = *(u32 *)(r10 -100)
	; if (tuple->nexthdr == IPPROTO_TCP)
	201: (63) *(u32 *)(r10 -136) = r1
	202: (71) r9 = *(u8 *)(r10 -92)
	; __be32 new_saddr = 0;
	203: (63) *(u32 *)(r10 -88) = r6
	;
	204: (18) r1 = 0xffff413ab6a7c800
	206: (7b) *(u64 *)(r10 -144) = r1
	207: (16) if w9 == 0x6 goto pc+3
	 R0=map_value_or_null(id=5,off=0,ks=12,vs=12,imm=0) R1_w=map_ptr(id=0,off=0,ks=14,vs=56,imm=0) R2_w=map_value_or_null(id=5,off=0,ks=12,vs=12,imm=0) R6=invP0 R7_w=invP0 R8=inv4294967162 R9_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmm0000 fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmmmmmm fp-144_w=map_ptr fp-152=mmmm????
	208: (18) r1 = 0xffff413ab6a7c400
	210: (7b) *(u64 *)(r10 -144) = r1
	211: (b4) w8 = -158
	; if (unlikely(svc->count == 0))
	212: (69) r1 = *(u16 *)(r2 +4)
	R2 invalid mem access 'map_value_or_null'
	processed 211 insns (limit 1000000) max_states_per_insn 1 total_states 15 peak_states 15 mark_read 8
level=warning msg="JoinEP: Failed to attach program(s)" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" file-path=705_next/bpf_lxc.o identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=datapath-loader veth=lxc_health
level=error msg="Error while rewriting endpoint BPF program" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting endpoint changes after BPF regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting proxy redirect removals" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting proxy redirect removals" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting xDS network policy update" subsys=envoy-manager
level=debug msg="preparing new cache transaction: upserting 0 entries, deleting 1 entries" subsys=xds xdsCachedVersion=3 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="deleting resource from cache" subsys=xds xdsCachedVersion=3 xdsResourceName=705 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="committing cache transaction and notifying of new version" subsys=xds xdsCachedVersion=3 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="Finished reverting xDS network policy update" subsys=envoy-manager
level=debug msg="Reverting proxy redirect additions" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting proxy redirect additions" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting endpoint changes after BPF regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=info msg="Wrote verifier log to endpoint directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/verifier.log identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=info msg="generating BPF for endpoint failed, keeping stale directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" file-path=705_next_fail identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next_fail endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Completed endpoint regeneration with no pending regeneration requests" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=ready identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=warning msg="Regeneration of endpoint failed" bpfCompilation=4.454374627s bpfLoadProg=28.160875ms bpfWaitForELF=4.45459596s bpfWriteELF="755.041µs" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ mapSync="71.25µs" policyCalculation="175.875µs" prepareBuild="287.082µs" proxyConfiguration="7.541µs" proxyPolicyCalculation=1.179291ms proxyWaitForAck=0s reason="updated security labels" subsys=endpoint total=4.502033377s waitingForCTClean="633.208µs" waitingForLock="1.874µs"
level=debug msg="Error regenerating endpoint: loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" code=Failure containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=ready identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=200
level=error msg="endpoint regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="received signal that regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Triggering endpoint regeneration due to retrying regeneration" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=waiting-to-regenerate identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="EventQueue event processing statistics" eventConsumeOffQueueWaitTime="827.292µs" eventEnqueueWaitTime=458ns eventHandlingDuration=4.502550794s eventType="*endpoint.EndpointRegenerationEvent" name=endpoint-705 subsys=eventqueue
level=debug msg="Dequeued endpoint from build queue" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Regenerating endpoint" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ reason="retrying regeneration" startTime="2023-06-24 17:28:46.214713837 +0000 UTC m=+8.436526588" subsys=endpoint
level=debug msg="Regenerating endpoint: retrying regeneration" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=regenerating identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Starting policy recalculation..." containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Skipping unnecessary endpoint policy recalculation" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyChanged=true policyRevision.next=1 policyRevision.repo=1 subsys=endpoint
level=debug msg="preparing new cache transaction: upserting 1 entries, deleting 0 entries" subsys=xds xdsCachedVersion=4 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="inserting resource into cache" subsys=xds xdsCachedVersion=4 xdsResourceName=705 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="committing cache transaction and notifying of new version" subsys=xds xdsCachedVersion=4 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="BPF header file hashed (was: \"\")" bpfHeaderfileHash=86bea98f3e604d817401ad2b9fa935bde199f4e73c922857c07ae0ae05ed07ce containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/ep_config.h identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file with DNSRules" DNSRules="map[]" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/ep_config.h identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Preparing to compile BPF" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ regeneration-level=rewrite+load subsys=endpoint
level=debug msg="Load 1-min: 3.79 5-min: 1.72 15min: 1.15" endpointID=705 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1877 (47.73%) Free: 95 Buffers: 42 Cached: 1917" endpointID=705 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 511 (49.92%) Free: 512" endpointID=705 subsys=endpoint
level=debug msg="Found variable with offset 85756" subsys=elf symbol=LXC_ID
level=debug msg="Found variable with offset 85752" subsys=elf symbol=LXC_IPV4
level=debug msg="Found variable with offset 85736" subsys=elf symbol=LXC_IP_1
level=debug msg="Found variable with offset 85740" subsys=elf symbol=LXC_IP_2
level=debug msg="Found variable with offset 85744" subsys=elf symbol=LXC_IP_3
level=debug msg="Found variable with offset 85748" subsys=elf symbol=LXC_IP_4
level=debug msg="Found variable with offset 85760" subsys=elf symbol=NODE_MAC_1
level=debug msg="Found variable with offset 85764" subsys=elf symbol=NODE_MAC_2
level=debug msg="Found variable with offset 85776" subsys=elf symbol=POLICY_VERDICT_LOG_FILTER
level=debug msg="Found variable with offset 85768" subsys=elf symbol=SECLABEL
level=debug msg="Found variable with offset 85772" subsys=elf symbol=SECLABEL_NB
level=debug msg="Found symbol referring to unknown section id 30" subsys=elf symbol=____license
level=debug msg="Skipping __send_drop_notify" subsys=elf
level=debug msg="Skipping cil_from_container" subsys=elf
level=debug msg="Skipping cil_to_container" subsys=elf
level=debug msg="Found symbol with offset 839416" subsys=elf symbol=cilium_auth_map
level=debug msg="Found symbol with offset 839048" subsys=elf symbol=cilium_call_policy
level=debug msg="Found symbol with offset 842501" subsys=elf symbol=cilium_calls_65535
level=debug msg="Found symbol with offset 839510" subsys=elf symbol=cilium_ct4_global
level=debug msg="Found symbol with offset 839488" subsys=elf symbol=cilium_ct_any4_global
level=debug msg="Found symbol with offset 839588" subsys=elf symbol=cilium_encrypt_state
level=debug msg="Found symbol with offset 839181" subsys=elf symbol=cilium_events
level=debug msg="Found symbol with offset 839654" subsys=elf symbol=cilium_ipcache
level=debug msg="Found symbol with offset 839242" subsys=elf symbol=cilium_ipv4_frag_datagrams
level=debug msg="Found symbol with offset 839009" subsys=elf symbol=cilium_lb4_affinity
level=debug msg="Found symbol with offset 843574" subsys=elf symbol=cilium_lb4_backends_v3
level=debug msg="Found symbol with offset 839158" subsys=elf symbol=cilium_lb4_reverse_nat
level=debug msg="Found symbol with offset 844261" subsys=elf symbol=cilium_lb4_services_v2
level=debug msg="Found symbol with offset 839669" subsys=elf symbol=cilium_lb4_source_range
level=debug msg="Found symbol with offset 839528" subsys=elf symbol=cilium_lb_affinity_match
level=debug msg="Found symbol with offset 839693" subsys=elf symbol=cilium_lxc
level=debug msg="Found symbol with offset 839302" subsys=elf symbol=cilium_metrics
level=debug msg="Found symbol with offset 839432" subsys=elf symbol=cilium_node_map
level=debug msg="Found symbol with offset 842883" subsys=elf symbol=cilium_nodeport_neigh4
level=debug msg="Found symbol with offset 842481" subsys=elf symbol=cilium_policy_65535
level=debug msg="Found symbol with offset 839553" subsys=elf symbol=cilium_runtime_config
level=debug msg="Found symbol with offset 839269" subsys=elf symbol=cilium_signals
level=debug msg="Found symbol with offset 839464" subsys=elf symbol=cilium_snat_v4_external
level=debug msg="Found symbol with offset 842858" subsys=elf symbol=cilium_tail_call_buffer4
level=debug msg="Skipping handle_policy" subsys=elf
level=debug msg="Skipping tail_handle_arp" subsys=elf
level=debug msg="Skipping tail_handle_ipv4" subsys=elf
level=debug msg="Skipping tail_handle_ipv4_cont" subsys=elf
level=debug msg="Skipping tail_handle_snat_fwd_ipv4" subsys=elf
level=debug msg="Skipping tail_ipv4_ct_egress" subsys=elf
level=debug msg="Skipping tail_ipv4_ct_ingress" subsys=elf
level=debug msg="Skipping tail_ipv4_to_endpoint" subsys=elf
level=debug msg="Skipping tail_rev_nodeport_lb4" subsys=elf
level=debug msg="Found section with offset 839105" subsys=elf symbol=.BTF.ext
level=debug msg="Found section with offset 839288" subsys=elf symbol=.debug_ranges
level=debug msg="Found section with offset 839368" subsys=elf symbol=to-container
level=debug msg="Found section with offset 839385" subsys=elf symbol=from-container
level=debug msg="Found section with offset 839452" subsys=elf symbol=.debug_info
level=debug msg="Found section with offset 839579" subsys=elf symbol=1/0xffff
level=debug msg="Found section with offset 839625" subsys=elf symbol=.debug_line
level=debug msg="Found section with offset 839641" subsys=elf symbol=.debug_frame
level=debug msg="Found section with offset 839708" subsys=elf symbol=.debug_loc
level=debug msg="Found section with offset 839790" subsys=elf symbol=.BTF
level=debug msg="Found section with offset 840219" subsys=elf symbol=2/29
level=debug msg="Found section with offset 840685" subsys=elf symbol=2/38
level=debug msg="Found section with offset 841389" subsys=elf symbol=2/27
level=debug msg="Found section with offset 841460" subsys=elf symbol=2/17
level=debug msg="Found section with offset 841507" subsys=elf symbol=2/7
level=debug msg="Found section with offset 842088" subsys=elf symbol=2/6
level=debug msg="Found section with offset 842677" subsys=elf symbol=2/25
level=debug msg="Found section with offset 844183" subsys=elf symbol=2/13
level=debug msg="Found section with offset 845521" subsys=elf symbol=2/1
level=debug msg="Finished writing ELF" error="<nil>" new-elf-path=705_next/bpf_lxc.o subsys=elf template-path=/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d/bpf_lxc.o
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 4.77% MEM: 2.51% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 98 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="NAME clang STATUS [running] PID 315 CPU: 19.78% MEM: 1.38% CMDLINE: clang -emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43 -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_host.c -o - MEM-EXT: RSS: 54 VMS: 89 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="NAME cilium STATUS [running] PID 317 CPU: 1.63% MEM: 0.99% CMDLINE: cilium status -o json MEM-EXT: RSS: 38 VMS: 763 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="Loading CollectionSpec from ELF" device=lxc_health ifindex=7 objPath=705_next/bpf_lxc.o subsys=datapath-loader
level=debug msg="Loading Collection into kernel" device=lxc_health ifindex=7 objPath=705_next/bpf_lxc.o subsys=datapath-loader
Verifier error: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)
Verifier log: load program: permission denied:
	btf_vmlinux is malformed
	R1 type=ctx expected=fp
	; int tail_handle_ipv4(struct __ctx_buff *ctx)
	0: (bf) r6 = r1
	; ctx_pull_data(ctx, tot_len);
	1: (b4) w2 = 34
	2: (85) call bpf_skb_pull_data#39
	3: (b4) w8 = -134
	; return (void *)(unsigned long)ctx->data_end;
	4: (61) r1 = *(u32 *)(r6 +80)
	; return (void *)(unsigned long)ctx->data;
	5: (61) r7 = *(u32 *)(r6 +76)
	; if (data + tot_len > data_end)
	6: (bf) r2 = r7
	7: (07) r2 += 34
	; __s8 ext_err = 0;
	8: (b4) w9 = 0
	9: (7b) *(u64 *)(r10 -128) = r6
	; if (data + tot_len > data_end)
	10: (2d) if r2 > r1 goto pc+1158
	 R0_w=inv(id=0) R1_w=pkt_end(id=0,off=0,imm=0) R2_w=pkt(id=0,off=34,r=34,imm=0) R6_w=ctx(id=0,off=0,imm=0) R7_w=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967162 R9_w=inv0 R10=fp0 fp-128_w=ctx
	11: (b4) w8 = -132
	; return ip4->saddr == LXC_IPV4;
	12: (18) r1 = 0xc103f40a
	; return ip4->saddr == LXC_IPV4;
	14: (61) r2 = *(u32 *)(r7 +26)
	; __s8 ext_err = 0;
	15: (b4) w9 = 0
	; if (unlikely(!is_valid_lxc_src_ipv4(ip4)))
	16: (5e) if w2 != w1 goto pc+1152
	 R0=inv(id=0) R1=inv3238261770 R2=inv3238261770 R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967164 R9=inv0 R10=fp0 fp-128=ctx
	17: (b4) w1 = 0
	; struct ipv4_ct_tuple tuple = {};
	18: (6b) *(u16 *)(r10 -92) = r1
	last_idx 18 first_idx 16
	regs=2 stack=0 before 17: (b4) w1 = 0
	19: (63) *(u32 *)(r10 -96) = r1
	; struct lb4_key key = {};
	20: (63) *(u32 *)(r10 -112) = r1
	21: (b7) r1 = 0
	22: (7b) *(u64 *)(r10 -120) = r1
	last_idx 22 first_idx 16
	regs=2 stack=0 before 21: (b7) r1 = 0
	23: (b4) w8 = -158
	; return ip4->frag_off & bpf_htons(0x1FFF);
	24: (69) r1 = *(u16 *)(r7 +20)
	; tuple->nexthdr = ip4->protocol;
	25: (63) *(u32 *)(r10 -132) = r1
	26: (71) r1 = *(u8 *)(r7 +23)
	; tuple->nexthdr = ip4->protocol;
	27: (73) *(u8 *)(r10 -92) = r1
	; tuple->daddr = ip4->daddr;
	28: (61) r2 = *(u32 *)(r7 +30)
	; tuple->daddr = ip4->daddr;
	29: (63) *(u32 *)(r10 -104) = r2
	; tuple->saddr = ip4->saddr;
	30: (61) r3 = *(u32 *)(r7 +26)
	; tuple->saddr = ip4->saddr;
	31: (63) *(u32 *)(r10 -100) = r3
	; return ip4->ihl * 4;
	32: (71) r9 = *(u8 *)(r7 +14)
	; return ip4->ihl * 4;
	33: (64) w9 <<= 2
	34: (54) w9 &= 60
	; *l4_off = l3_off + ipv4_hdrlen(ip4);
	35: (04) w9 += 14
	; switch (tuple->nexthdr) {
	36: (16) if w1 == 0x1 goto pc+113
	 R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2_w=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3_w=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967138 R9_w=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120_w=00000000 fp-128=ctx fp-136=mmmm????
	37: (16) if w1 == 0x11 goto pc+1
	 R0=inv(id=0) R1=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	38: (56) if w1 != 0x6 goto pc+29
	 R0=inv(id=0) R1=inv6 R2=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; struct ipv4_frag_id frag_id = {
	39: (63) *(u32 *)(r10 -20) = r3
	40: (63) *(u32 *)(r10 -24) = r2
	; .id = ip4->id,
	41: (69) r2 = *(u16 *)(r7 +18)
	42: (b4) w3 = 0
	; struct ipv4_frag_id frag_id = {
	43: (73) *(u8 *)(r10 -13) = r3
	last_idx 43 first_idx 37
	regs=8 stack=0 before 42: (b4) w3 = 0
	44: (73) *(u8 *)(r10 -14) = r1
	45: (6b) *(u16 *)(r10 -16) = r2
	; return ip4->frag_off & bpf_htons(0x3FFF);
	46: (61) r1 = *(u32 *)(r10 -132)
	47: (54) w1 &= 65343
	; if (unlikely(is_fragment)) {
	48: (16) if w1 == 0x0 goto pc+45
	 R0=inv(id=0) R1=inv(id=0,umax_value=65343,var_off=(0x0; 0xff3f)) R2=inv(id=0,umax_value=65535,var_off=(0x0; 0xffff)) R3=invP0 R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; return ctx->len;
	49: (61) r6 = *(u32 *)(r6 +0)
	50: (b7) r1 = 0
	; struct metrics_value *entry, new_entry = {};
	51: (7b) *(u64 *)(r10 -72) = r1
	last_idx 51 first_idx 48
	regs=2 stack=0 before 50: (b7) r1 = 0
	52: (7b) *(u64 *)(r10 -80) = r1
	53: (b7) r1 = 521
	; struct metrics_key key = {};
	54: (7b) *(u64 *)(r10 -88) = r1
	55: (bf) r2 = r10
	;
	56: (07) r2 += -88
	; entry = map_lookup_elem(&METRICS_MAP, &key);
	57: (18) r1 = 0xffff413a9dac6800
	59: (85) call bpf_map_lookup_elem#1
	; if (entry) {
	60: (15) if r0 == 0x0 goto pc+9
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; entry->count += 1;
	61: (79) r1 = *(u64 *)(r0 +0)
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	62: (07) r1 += 1
	63: (7b) *(u64 *)(r0 +0) = r1
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; entry->bytes += bytes;
	64: (79) r1 = *(u64 *)(r0 +8)
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	65: (0f) r1 += r6
	66: (7b) *(u64 *)(r0 +8) = r1
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	67: (05) goto pc+13
	; return ip4->frag_off & bpf_htons(0x1FFF);
	81: (69) r1 = *(u16 *)(r7 +20)
	; return ip4->frag_off & bpf_htons(0x1FFF);
	82: (54) w1 &= 65311
	83: (79) r6 = *(u64 *)(r10 -128)
	; if (likely(not_first_fragment))
	84: (16) if w1 == 0x0 goto pc+9
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0,umax_value=65311,var_off=(0x0; 0xff1f)) R6_w=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	85: (bf) r2 = r10
	;
	86: (07) r2 += -24
	; tmp = map_lookup_elem(&IPV4_FRAG_DATAGRAMS_MAP, frag_id);
	87: (18) r1 = 0xffff413b1d08e000
	89: (85) call bpf_map_lookup_elem#1
	; if (!tmp)
	90: (55) if r0 != 0x0 goto pc+1327
	
	from 90 to 1418: R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; case  4: __it_mob(d, s, 32);
	1418: (61) r1 = *(u32 *)(r0 +0)
	 R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	1419: (63) *(u32 *)(r10 -96) = r1
	1420: (05) goto pc-1272
	; map_update_elem(&METRICS_MAP, &key, &new_entry, 0);
	149: (b4) w8 = 0
	150: (b4) w1 = 1
	; if (IS_ERR(ret)) {
	151: (16) if w8 == 0x2 goto pc+1
	last_idx 151 first_idx 149
	regs=100 stack=0 before 150: (b4) w1 = 1
	regs=100 stack=0 before 149: (b4) w8 = 0
	152: (b4) w1 = 0
	153: (bc) w2 = w8
	154: (74) w2 >>= 31
	155: (4c) w2 |= w1
	; if (IS_ERR(ret)) {
	156: (16) if w2 == 0x0 goto pc+8
	; if (ret == DROP_NO_SERVICE || ret == DROP_UNKNOWN_L4)
	165: (63) *(u32 *)(r10 -148) = r9
	; key->address = tuple->daddr;
	166: (61) r1 = *(u32 *)(r10 -104)
	; key->address = tuple->daddr;
	167: (63) *(u32 *)(r10 -120) = r1
	; key->dport = tuple->sport;
	168: (69) r1 = *(u16 *)(r10 -94)
	; key->dport = tuple->sport;
	169: (6b) *(u16 *)(r10 -116) = r1
	170: (b4) w8 = -134
	171: (b4) w9 = 0
	; key->proto = 0;
	172: (73) *(u8 *)(r10 -112) = r9
	last_idx 172 first_idx 165
	regs=200 stack=0 before 171: (b4) w9 = 0
	; return (void *)(unsigned long)ctx->data_end;
	173: (61) r1 = *(u32 *)(r6 +80)
	; return (void *)(unsigned long)ctx->data;
	174: (61) r2 = *(u32 *)(r6 +76)
	; if (data + tot_len > data_end)
	175: (07) r2 += 34
	; if (data + tot_len > data_end)
	176: (2d) if r2 > r1 goto pc+992
	 R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R1_w=pkt_end(id=0,off=0,imm=0) R2_w=pkt(id=0,off=34,r=34,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967162 R9_w=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????0000 fp-120=00mmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	177: (b4) w6 = 0
	; key->backend_slot = 0;
	178: (6b) *(u16 *)(r10 -114) = r6
	last_idx 178 first_idx 165
	regs=40 stack=0 before 177: (b4) w6 = 0
	; key->scope = LB_LOOKUP_SCOPE_EXT;
	179: (73) *(u8 *)(r10 -111) = r6
	180: (bf) r2 = r10
	;
	181: (07) r2 += -120
	; svc = map_lookup_elem(&LB4_SERVICES_MAP_V2, key);
	182: (18) r1 = 0xffff413a9da6cc00
	184: (85) call bpf_map_lookup_elem#1
	185: (b7) r2 = 0
	; if (svc) {
	186: (15) if r0 == 0x0 goto pc+12
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R2_w=inv0 R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	; return svc->flags2 & SVC_FLAG_TWO_SCOPES;
	187: (71) r1 = *(u8 *)(r0 +9)
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R2_w=inv0 R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	; return svc->flags2 & SVC_FLAG_TWO_SCOPES;
	188: (54) w1 &= 32
	189: (bf) r2 = r0
	; if (!scope_switch || !lb4_svc_is_two_scopes(svc))
	190: (16) if w1 == 0x0 goto pc+8
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R1_w=inv(id=0,umax_value=32,var_off=(0x0; 0x20)) R2_w=map_value(id=0,off=0,ks=12,vs=12,imm=0) R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	191: (b4) w1 = 1
	; key->scope = LB_LOOKUP_SCOPE_INT;
	192: (73) *(u8 *)(r10 -111) = r1
	193: (bf) r2 = r10
	194: (07) r2 += -120
	; svc = map_lookup_elem(&LB4_SERVICES_MAP_V2, key);
	195: (18) r1 = 0xffff413a9da6cc00
	197: (85) call bpf_map_lookup_elem#1
	198: (bf) r2 = r0
	; __u8 flags = tuple->flags;
	199: (71) r7 = *(u8 *)(r10 -91)
	; __be32 saddr = tuple->saddr;
	200: (61) r1 = *(u32 *)(r10 -100)
	; if (tuple->nexthdr == IPPROTO_TCP)
	201: (63) *(u32 *)(r10 -136) = r1
	202: (71) r9 = *(u8 *)(r10 -92)
	; __be32 new_saddr = 0;
	203: (63) *(u32 *)(r10 -88) = r6
	;
	204: (18) r1 = 0xffff413ab6a7c800
	206: (7b) *(u64 *)(r10 -144) = r1
	207: (16) if w9 == 0x6 goto pc+3
	 R0=map_value_or_null(id=5,off=0,ks=12,vs=12,imm=0) R1_w=map_ptr(id=0,off=0,ks=14,vs=56,imm=0) R2_w=map_value_or_null(id=5,off=0,ks=12,vs=12,imm=0) R6=invP0 R7_w=invP0 R8=inv4294967162 R9_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmm0000 fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmmmmmm fp-144_w=map_ptr fp-152=mmmm????
	208: (18) r1 = 0xffff413ab6a7c400
	210: (7b) *(u64 *)(r10 -144) = r1
	211: (b4) w8 = -158
	; if (unlikely(svc->count == 0))
	212: (69) r1 = *(u16 *)(r2 +4)
	R2 invalid mem access 'map_value_or_null'
	processed 211 insns (limit 1000000) max_states_per_insn 1 total_states 15 peak_states 15 mark_read 8
level=warning msg="JoinEP: Failed to attach program(s)" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" file-path=705_next/bpf_lxc.o identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=datapath-loader veth=lxc_health
level=error msg="Error while rewriting endpoint BPF program" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting endpoint changes after BPF regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting proxy redirect removals" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting proxy redirect removals" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting xDS network policy update" subsys=envoy-manager
level=debug msg="preparing new cache transaction: upserting 0 entries, deleting 1 entries" subsys=xds xdsCachedVersion=5 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="deleting resource from cache" subsys=xds xdsCachedVersion=5 xdsResourceName=705 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="committing cache transaction and notifying of new version" subsys=xds xdsCachedVersion=5 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="Finished reverting xDS network policy update" subsys=envoy-manager
level=debug msg="Reverting proxy redirect additions" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting proxy redirect additions" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting endpoint changes after BPF regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=info msg="Wrote verifier log to endpoint directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/verifier.log identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=info msg="generating BPF for endpoint failed, keeping stale directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" file-path=705_next_fail identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next_fail endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Completed endpoint regeneration with no pending regeneration requests" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=ready identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=warning msg="Regeneration of endpoint failed" bpfCompilation=0s bpfLoadProg=20.137333ms bpfWaitForELF="2.375µs" bpfWriteELF=1.886167ms containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ mapSync="11.167µs" policyCalculation="82.667µs" prepareBuild=1.338667ms proxyConfiguration="6.209µs" proxyPolicyCalculation="168.334µs" proxyWaitForAck=0s reason="retrying regeneration" subsys=endpoint total=28.42025ms waitingForCTClean=1.436958ms waitingForLock=833ns
level=debug msg="Error regenerating endpoint: loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" code=Failure containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=ready identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=200
level=debug msg="EventQueue event processing statistics" eventConsumeOffQueueWaitTime="52.25µs" eventEnqueueWaitTime="1.125µs" eventHandlingDuration=28.581792ms eventType="*endpoint.EndpointRegenerationEvent" name=endpoint-705 subsys=eventqueue
level=error msg="endpoint regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Controller func execution time: 4.533444127s" name=endpoint-705-regeneration-recovery subsys=controller uuid=4ccac62f-bde0-4fd5-820e-748cf19b0bd1
level=debug msg="Controller run failed" consecutiveErrors=1 error="regeneration recovery failed" name=endpoint-705-regeneration-recovery subsys=controller uuid=4ccac62f-bde0-4fd5-820e-748cf19b0bd1
level=debug msg="UpdateIdentities: Adding a new identity" identity=50687 labels="[k8s:io.cilium.k8s.namespace.labels.kubernetes.io/metadata.name=kube-system k8s:io.cilium.k8s.policy.cluster=kind-kind k8s:io.cilium.k8s.policy.serviceaccount=coredns k8s:io.kubernetes.pod.namespace=kube-system k8s:k8s-app=kube-dns]" subsys=policy
level=debug msg="Regenerating all endpoints" subsys=policy
level=info msg="regenerating all endpoints" reason="one or more identities created or deleted" subsys=endpoint-manager
level=debug msg="Triggering endpoint regeneration due to one or more identities created or deleted" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=waiting-to-regenerate identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="Skipped duplicate endpoint regeneration level no-rebuild trigger due to one or more identities created or deleted" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=115 endpointState=waiting-to-regenerate identity=1 ipv4= ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="Dequeued endpoint from build queue" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Regenerating endpoint" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ reason="one or more identities created or deleted" startTime="2023-06-24 17:28:46.395969212 +0000 UTC m=+8.617781922" subsys=endpoint
level=debug msg="Regenerating endpoint: one or more identities created or deleted" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=regenerating identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Starting policy recalculation..." containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Skipping unnecessary endpoint policy recalculation" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyChanged=true policyRevision.next=1 policyRevision.repo=1 subsys=endpoint
level=debug msg="preparing new cache transaction: upserting 1 entries, deleting 0 entries" subsys=xds xdsCachedVersion=6 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="inserting resource into cache" subsys=xds xdsCachedVersion=6 xdsResourceName=705 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="committing cache transaction and notifying of new version" subsys=xds xdsCachedVersion=6 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="BPF header file hashed (was: \"\")" bpfHeaderfileHash=86bea98f3e604d817401ad2b9fa935bde199f4e73c922857c07ae0ae05ed07ce containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/ep_config.h identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file with DNSRules" DNSRules="map[]" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/ep_config.h identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Preparing to compile BPF" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ regeneration-level=rewrite+load subsys=endpoint
level=debug msg="Found variable with offset 85756" subsys=elf symbol=LXC_ID
level=debug msg="Found variable with offset 85752" subsys=elf symbol=LXC_IPV4
level=debug msg="Found variable with offset 85736" subsys=elf symbol=LXC_IP_1
level=debug msg="Found variable with offset 85740" subsys=elf symbol=LXC_IP_2
level=debug msg="Found variable with offset 85744" subsys=elf symbol=LXC_IP_3
level=debug msg="Found variable with offset 85748" subsys=elf symbol=LXC_IP_4
level=debug msg="Found variable with offset 85760" subsys=elf symbol=NODE_MAC_1
level=debug msg="Found variable with offset 85764" subsys=elf symbol=NODE_MAC_2
level=debug msg="Found variable with offset 85776" subsys=elf symbol=POLICY_VERDICT_LOG_FILTER
level=debug msg="Found variable with offset 85768" subsys=elf symbol=SECLABEL
level=debug msg="Found variable with offset 85772" subsys=elf symbol=SECLABEL_NB
level=debug msg="Found symbol referring to unknown section id 30" subsys=elf symbol=____license
level=debug msg="Skipping __send_drop_notify" subsys=elf
level=debug msg="Skipping cil_from_container" subsys=elf
level=debug msg="Skipping cil_to_container" subsys=elf
level=debug msg="Found symbol with offset 839416" subsys=elf symbol=cilium_auth_map
level=debug msg="Found symbol with offset 839048" subsys=elf symbol=cilium_call_policy
level=debug msg="Found symbol with offset 842501" subsys=elf symbol=cilium_calls_65535
level=debug msg="Found symbol with offset 839510" subsys=elf symbol=cilium_ct4_global
level=debug msg="Found symbol with offset 839488" subsys=elf symbol=cilium_ct_any4_global
level=debug msg="Found symbol with offset 839588" subsys=elf symbol=cilium_encrypt_state
level=debug msg="Found symbol with offset 839181" subsys=elf symbol=cilium_events
level=debug msg="Found symbol with offset 839654" subsys=elf symbol=cilium_ipcache
level=debug msg="Found symbol with offset 839242" subsys=elf symbol=cilium_ipv4_frag_datagrams
level=debug msg="Found symbol with offset 839009" subsys=elf symbol=cilium_lb4_affinity
level=debug msg="Found symbol with offset 843574" subsys=elf symbol=cilium_lb4_backends_v3
level=debug msg="Found symbol with offset 839158" subsys=elf symbol=cilium_lb4_reverse_nat
level=debug msg="Found symbol with offset 844261" subsys=elf symbol=cilium_lb4_services_v2
level=debug msg="Found symbol with offset 839669" subsys=elf symbol=cilium_lb4_source_range
level=debug msg="Found symbol with offset 839528" subsys=elf symbol=cilium_lb_affinity_match
level=debug msg="Found symbol with offset 839693" subsys=elf symbol=cilium_lxc
level=debug msg="Found symbol with offset 839302" subsys=elf symbol=cilium_metrics
level=debug msg="Found symbol with offset 839432" subsys=elf symbol=cilium_node_map
level=debug msg="Found symbol with offset 842883" subsys=elf symbol=cilium_nodeport_neigh4
level=debug msg="Found symbol with offset 842481" subsys=elf symbol=cilium_policy_65535
level=debug msg="Found symbol with offset 839553" subsys=elf symbol=cilium_runtime_config
level=debug msg="Found symbol with offset 839269" subsys=elf symbol=cilium_signals
level=debug msg="Found symbol with offset 839464" subsys=elf symbol=cilium_snat_v4_external
level=debug msg="Found symbol with offset 842858" subsys=elf symbol=cilium_tail_call_buffer4
level=debug msg="Skipping handle_policy" subsys=elf
level=debug msg="Skipping tail_handle_arp" subsys=elf
level=debug msg="Skipping tail_handle_ipv4" subsys=elf
level=debug msg="Skipping tail_handle_ipv4_cont" subsys=elf
level=debug msg="Load 1-min: 3.79 5-min: 1.72 15min: 1.15" endpointID=705 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1875 (47.68%) Free: 76 Buffers: 42 Cached: 1939" endpointID=705 subsys=endpoint
level=debug msg="Skipping tail_handle_snat_fwd_ipv4" subsys=elf
level=debug msg="Skipping tail_ipv4_ct_egress" subsys=elf
level=debug msg="Skipping tail_ipv4_ct_ingress" subsys=elf
level=debug msg="Skipping tail_ipv4_to_endpoint" subsys=elf
level=debug msg="Skipping tail_rev_nodeport_lb4" subsys=elf
level=debug msg="Found section with offset 839105" subsys=elf symbol=.BTF.ext
level=debug msg="Found section with offset 839288" subsys=elf symbol=.debug_ranges
level=debug msg="Found section with offset 839368" subsys=elf symbol=to-container
level=debug msg="Found section with offset 839385" subsys=elf symbol=from-container
level=debug msg="Found section with offset 839452" subsys=elf symbol=.debug_info
level=debug msg="Found section with offset 839579" subsys=elf symbol=1/0xffff
level=debug msg="Found section with offset 839625" subsys=elf symbol=.debug_line
level=debug msg="Found section with offset 839641" subsys=elf symbol=.debug_frame
level=debug msg="Found section with offset 839708" subsys=elf symbol=.debug_loc
level=debug msg="Found section with offset 839790" subsys=elf symbol=.BTF
level=debug msg="Found section with offset 840219" subsys=elf symbol=2/29
level=debug msg="Found section with offset 840685" subsys=elf symbol=2/38
level=debug msg="Found section with offset 841389" subsys=elf symbol=2/27
level=debug msg="Found section with offset 841460" subsys=elf symbol=2/17
level=debug msg="Found section with offset 841507" subsys=elf symbol=2/7
level=debug msg="Found section with offset 842088" subsys=elf symbol=2/6
level=debug msg="Found section with offset 842677" subsys=elf symbol=2/25
level=debug msg="Found section with offset 844183" subsys=elf symbol=2/13
level=debug msg="Found section with offset 845521" subsys=elf symbol=2/1
level=debug msg="Finished writing ELF" error="<nil>" new-elf-path=705_next/bpf_lxc.o subsys=elf template-path=/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d/bpf_lxc.o
level=debug msg="Loading CollectionSpec from ELF" device=lxc_health ifindex=7 objPath=705_next/bpf_lxc.o subsys=datapath-loader
level=debug msg="Swap: Total: 1023 Used: 511 (49.92%) Free: 512" endpointID=705 subsys=endpoint
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 4.89% MEM: 2.62% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 102 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="NAME clang STATUS [running] PID 315 CPU: 23.71% MEM: 1.41% CMDLINE: clang -emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43 -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_host.c -o - MEM-EXT: RSS: 55 VMS: 90 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="Loading Collection into kernel" device=lxc_health ifindex=7 objPath=705_next/bpf_lxc.o subsys=datapath-loader
Verifier error: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)
Verifier log: load program: permission denied:
	btf_vmlinux is malformed
	R1 type=ctx expected=fp
	; int tail_handle_ipv4(struct __ctx_buff *ctx)
	0: (bf) r6 = r1
	; ctx_pull_data(ctx, tot_len);
	1: (b4) w2 = 34
	2: (85) call bpf_skb_pull_data#39
	3: (b4) w8 = -134
	; return (void *)(unsigned long)ctx->data_end;
	4: (61) r1 = *(u32 *)(r6 +80)
	; return (void *)(unsigned long)ctx->data;
	5: (61) r7 = *(u32 *)(r6 +76)
	; if (data + tot_len > data_end)
	6: (bf) r2 = r7
	7: (07) r2 += 34
	; __s8 ext_err = 0;
	8: (b4) w9 = 0
	9: (7b) *(u64 *)(r10 -128) = r6
	; if (data + tot_len > data_end)
	10: (2d) if r2 > r1 goto pc+1158
	 R0_w=inv(id=0) R1_w=pkt_end(id=0,off=0,imm=0) R2_w=pkt(id=0,off=34,r=34,imm=0) R6_w=ctx(id=0,off=0,imm=0) R7_w=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967162 R9_w=inv0 R10=fp0 fp-128_w=ctx
	11: (b4) w8 = -132
	; return ip4->saddr == LXC_IPV4;
	12: (18) r1 = 0xc103f40a
	; return ip4->saddr == LXC_IPV4;
	14: (61) r2 = *(u32 *)(r7 +26)
	; __s8 ext_err = 0;
	15: (b4) w9 = 0
	; if (unlikely(!is_valid_lxc_src_ipv4(ip4)))
	16: (5e) if w2 != w1 goto pc+1152
	 R0=inv(id=0) R1=inv3238261770 R2=inv3238261770 R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967164 R9=inv0 R10=fp0 fp-128=ctx
	17: (b4) w1 = 0
	; struct ipv4_ct_tuple tuple = {};
	18: (6b) *(u16 *)(r10 -92) = r1
	last_idx 18 first_idx 16
	regs=2 stack=0 before 17: (b4) w1 = 0
	19: (63) *(u32 *)(r10 -96) = r1
	; struct lb4_key key = {};
	20: (63) *(u32 *)(r10 -112) = r1
	21: (b7) r1 = 0
	22: (7b) *(u64 *)(r10 -120) = r1
	last_idx 22 first_idx 16
	regs=2 stack=0 before 21: (b7) r1 = 0
	23: (b4) w8 = -158
	; return ip4->frag_off & bpf_htons(0x1FFF);
	24: (69) r1 = *(u16 *)(r7 +20)
	; tuple->nexthdr = ip4->protocol;
	25: (63) *(u32 *)(r10 -132) = r1
	26: (71) r1 = *(u8 *)(r7 +23)
	; tuple->nexthdr = ip4->protocol;
	27: (73) *(u8 *)(r10 -92) = r1
	; tuple->daddr = ip4->daddr;
	28: (61) r2 = *(u32 *)(r7 +30)
	; tuple->daddr = ip4->daddr;
	29: (63) *(u32 *)(r10 -104) = r2
	; tuple->saddr = ip4->saddr;
	30: (61) r3 = *(u32 *)(r7 +26)
	; tuple->saddr = ip4->saddr;
	31: (63) *(u32 *)(r10 -100) = r3
	; return ip4->ihl * 4;
	32: (71) r9 = *(u8 *)(r7 +14)
	; return ip4->ihl * 4;
	33: (64) w9 <<= 2
	34: (54) w9 &= 60
	; *l4_off = l3_off + ipv4_hdrlen(ip4);
	35: (04) w9 += 14
	; switch (tuple->nexthdr) {
	36: (16) if w1 == 0x1 goto pc+113
	 R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2_w=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3_w=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967138 R9_w=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120_w=00000000 fp-128=ctx fp-136=mmmm????
	37: (16) if w1 == 0x11 goto pc+1
	 R0=inv(id=0) R1=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	38: (56) if w1 != 0x6 goto pc+29
	 R0=inv(id=0) R1=inv6 R2=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; struct ipv4_frag_id frag_id = {
	39: (63) *(u32 *)(r10 -20) = r3
	40: (63) *(u32 *)(r10 -24) = r2
	; .id = ip4->id,
	41: (69) r2 = *(u16 *)(r7 +18)
	42: (b4) w3 = 0
	; struct ipv4_frag_id frag_id = {
	43: (73) *(u8 *)(r10 -13) = r3
	last_idx 43 first_idx 37
	regs=8 stack=0 before 42: (b4) w3 = 0
	44: (73) *(u8 *)(r10 -14) = r1
	45: (6b) *(u16 *)(r10 -16) = r2
	; return ip4->frag_off & bpf_htons(0x3FFF);
	46: (61) r1 = *(u32 *)(r10 -132)
	47: (54) w1 &= 65343
	; if (unlikely(is_fragment)) {
	48: (16) if w1 == 0x0 goto pc+45
	 R0=inv(id=0) R1=inv(id=0,umax_value=65343,var_off=(0x0; 0xff3f)) R2=inv(id=0,umax_value=65535,var_off=(0x0; 0xffff)) R3=invP0 R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; return ctx->len;
	49: (61) r6 = *(u32 *)(r6 +0)
	50: (b7) r1 = 0
	; struct metrics_value *entry, new_entry = {};
	51: (7b) *(u64 *)(r10 -72) = r1
	last_idx 51 first_idx 48
	regs=2 stack=0 before 50: (b7) r1 = 0
	52: (7b) *(u64 *)(r10 -80) = r1
	53: (b7) r1 = 521
	; struct metrics_key key = {};
	54: (7b) *(u64 *)(r10 -88) = r1
	55: (bf) r2 = r10
	;
	56: (07) r2 += -88
	; entry = map_lookup_elem(&METRICS_MAP, &key);
	57: (18) r1 = 0xffff413a9dac6800
	59: (85) call bpf_map_lookup_elem#1
	; if (entry) {
	60: (15) if r0 == 0x0 goto pc+9
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; entry->count += 1;
	61: (79) r1 = *(u64 *)(r0 +0)
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	62: (07) r1 += 1
	63: (7b) *(u64 *)(r0 +0) = r1
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; entry->bytes += bytes;
	64: (79) r1 = *(u64 *)(r0 +8)
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	65: (0f) r1 += r6
	66: (7b) *(u64 *)(r0 +8) = r1
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	67: (05) goto pc+13
	; return ip4->frag_off & bpf_htons(0x1FFF);
	81: (69) r1 = *(u16 *)(r7 +20)
	; return ip4->frag_off & bpf_htons(0x1FFF);
	82: (54) w1 &= 65311
	83: (79) r6 = *(u64 *)(r10 -128)
	; if (likely(not_first_fragment))
	84: (16) if w1 == 0x0 goto pc+9
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0,umax_value=65311,var_off=(0x0; 0xff1f)) R6_w=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	85: (bf) r2 = r10
	;
	86: (07) r2 += -24
	; tmp = map_lookup_elem(&IPV4_FRAG_DATAGRAMS_MAP, frag_id);
	87: (18) r1 = 0xffff413b1d08e000
	89: (85) call bpf_map_lookup_elem#1
	; if (!tmp)
	90: (55) if r0 != 0x0 goto pc+1327
	
	from 90 to 1418: R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; case  4: __it_mob(d, s, 32);
	1418: (61) r1 = *(u32 *)(r0 +0)
	 R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	1419: (63) *(u32 *)(r10 -96) = r1
	1420: (05) goto pc-1272
	; map_update_elem(&METRICS_MAP, &key, &new_entry, 0);
	149: (b4) w8 = 0
	150: (b4) w1 = 1
	; if (IS_ERR(ret)) {
	151: (16) if w8 == 0x2 goto pc+1
	last_idx 151 first_idx 149
	regs=100 stack=0 before 150: (b4) w1 = 1
	regs=100 stack=0 before 149: (b4) w8 = 0
	152: (b4) w1 = 0
	153: (bc) w2 = w8
	154: (74) w2 >>= 31
	155: (4c) w2 |= w1
	; if (IS_ERR(ret)) {
	156: (16) if w2 == 0x0 goto pc+8
	; if (ret == DROP_NO_SERVICE || ret == DROP_UNKNOWN_L4)
	165: (63) *(u32 *)(r10 -148) = r9
	; key->address = tuple->daddr;
	166: (61) r1 = *(u32 *)(r10 -104)
	; key->address = tuple->daddr;
	167: (63) *(u32 *)(r10 -120) = r1
	; key->dport = tuple->sport;
	168: (69) r1 = *(u16 *)(r10 -94)
	; key->dport = tuple->sport;
	169: (6b) *(u16 *)(r10 -116) = r1
	170: (b4) w8 = -134
	171: (b4) w9 = 0
	; key->proto = 0;
	172: (73) *(u8 *)(r10 -112) = r9
	last_idx 172 first_idx 165
	regs=200 stack=0 before 171: (b4) w9 = 0
	; return (void *)(unsigned long)ctx->data_end;
	173: (61) r1 = *(u32 *)(r6 +80)
	; return (void *)(unsigned long)ctx->data;
	174: (61) r2 = *(u32 *)(r6 +76)
	; if (data + tot_len > data_end)
	175: (07) r2 += 34
	; if (data + tot_len > data_end)
	176: (2d) if r2 > r1 goto pc+992
	 R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R1_w=pkt_end(id=0,off=0,imm=0) R2_w=pkt(id=0,off=34,r=34,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967162 R9_w=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????0000 fp-120=00mmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	177: (b4) w6 = 0
	; key->backend_slot = 0;
	178: (6b) *(u16 *)(r10 -114) = r6
	last_idx 178 first_idx 165
	regs=40 stack=0 before 177: (b4) w6 = 0
	; key->scope = LB_LOOKUP_SCOPE_EXT;
	179: (73) *(u8 *)(r10 -111) = r6
	180: (bf) r2 = r10
	;
	181: (07) r2 += -120
	; svc = map_lookup_elem(&LB4_SERVICES_MAP_V2, key);
	182: (18) r1 = 0xffff413a9da6cc00
	184: (85) call bpf_map_lookup_elem#1
	185: (b7) r2 = 0
	; if (svc) {
	186: (15) if r0 == 0x0 goto pc+12
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R2_w=inv0 R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	; return svc->flags2 & SVC_FLAG_TWO_SCOPES;
	187: (71) r1 = *(u8 *)(r0 +9)
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R2_w=inv0 R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	; return svc->flags2 & SVC_FLAG_TWO_SCOPES;
	188: (54) w1 &= 32
	189: (bf) r2 = r0
	; if (!scope_switch || !lb4_svc_is_two_scopes(svc))
	190: (16) if w1 == 0x0 goto pc+8
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R1_w=inv(id=0,umax_value=32,var_off=(0x0; 0x20)) R2_w=map_value(id=0,off=0,ks=12,vs=12,imm=0) R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	191: (b4) w1 = 1
	; key->scope = LB_LOOKUP_SCOPE_INT;
	192: (73) *(u8 *)(r10 -111) = r1
	193: (bf) r2 = r10
	194: (07) r2 += -120
	; svc = map_lookup_elem(&LB4_SERVICES_MAP_V2, key);
	195: (18) r1 = 0xffff413a9da6cc00
	197: (85) call bpf_map_lookup_elem#1
	198: (bf) r2 = r0
	; __u8 flags = tuple->flags;
	199: (71) r7 = *(u8 *)(r10 -91)
	; __be32 saddr = tuple->saddr;
	200: (61) r1 = *(u32 *)(r10 -100)
	; if (tuple->nexthdr == IPPROTO_TCP)
	201: (63) *(u32 *)(r10 -136) = r1
	202: (71) r9 = *(u8 *)(r10 -92)
	; __be32 new_saddr = 0;
	203: (63) *(u32 *)(r10 -88) = r6
	;
	204: (18) r1 = 0xffff413ab6a7c800
	206: (7b) *(u64 *)(r10 -144) = r1
	207: (16) if w9 == 0x6 goto pc+3
	 R0=map_value_or_null(id=5,off=0,ks=12,vs=12,imm=0) R1_w=map_ptr(id=0,off=0,ks=14,vs=56,imm=0) R2_w=map_value_or_null(id=5,off=0,ks=12,vs=12,imm=0) R6=invP0 R7_w=invP0 R8=inv4294967162 R9_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmm0000 fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmmmmmm fp-144_w=map_ptr fp-152=mmmm????
	208: (18) r1 = 0xffff413ab6a7c400
	210: (7b) *(u64 *)(r10 -144) = r1
	211: (b4) w8 = -158
	; if (unlikely(svc->count == 0))
	212: (69) r1 = *(u16 *)(r2 +4)
	R2 invalid mem access 'map_value_or_null'
	processed 211 insns (limit 1000000) max_states_per_insn 1 total_states 15 peak_states 15 mark_read 8
level=warning msg="JoinEP: Failed to attach program(s)" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" file-path=705_next/bpf_lxc.o identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=datapath-loader veth=lxc_health
level=error msg="Error while rewriting endpoint BPF program" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting endpoint changes after BPF regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting proxy redirect removals" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting proxy redirect removals" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting xDS network policy update" subsys=envoy-manager
level=debug msg="preparing new cache transaction: upserting 0 entries, deleting 1 entries" subsys=xds xdsCachedVersion=7 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="deleting resource from cache" subsys=xds xdsCachedVersion=7 xdsResourceName=705 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="committing cache transaction and notifying of new version" subsys=xds xdsCachedVersion=7 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="Finished reverting xDS network policy update" subsys=envoy-manager
level=debug msg="Reverting proxy redirect additions" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting proxy redirect additions" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting endpoint changes after BPF regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=info msg="Wrote verifier log to endpoint directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/verifier.log identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=info msg="generating BPF for endpoint failed, keeping stale directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" file-path=705_next_fail identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next_fail endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Completed endpoint regeneration with no pending regeneration requests" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=ready identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=warning msg="Regeneration of endpoint failed" bpfCompilation=0s bpfLoadProg=35.465167ms bpfWaitForELF="2.625µs" bpfWriteELF="619.75µs" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ mapSync="12.5µs" policyCalculation="69.291µs" prepareBuild="230.083µs" proxyConfiguration="6.541µs" proxyPolicyCalculation="78.25µs" proxyWaitForAck=0s reason="one or more identities created or deleted" subsys=endpoint total=40.422ms waitingForCTClean="522.167µs" waitingForLock="1.249µs"
level=debug msg="Error regenerating endpoint: loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" code=Failure containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=ready identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=200
level=debug msg="EventQueue event processing statistics" eventConsumeOffQueueWaitTime="14.416µs" eventEnqueueWaitTime=709ns eventHandlingDuration=40.550166ms eventType="*endpoint.EndpointRegenerationEvent" name=endpoint-705 subsys=eventqueue
level=error msg="endpoint regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Upserting IP into ipcache layer" identity="{50687 custom-resource [] false false}" ipAddr=10.244.0.127 k8sNamespace=kube-system k8sPodName=coredns-565d847f94-plj4x key=0 namedPorts="map[dns:{53 17} dns-tcp:{53 6} metrics:{9153 6}]" subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{50687 custom-resource [] false false}" ipAddr="{10.244.0.127 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Upserting IP into ipcache layer" identity="{50687 custom-resource [] false false}" ipAddr=10.244.0.163 k8sNamespace=kube-system k8sPodName=coredns-565d847f94-tfts5 key=0 namedPorts="map[dns:{53 17} dns-tcp:{53 6} metrics:{9153 6}]" subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{50687 custom-resource [] false false}" ipAddr="{10.244.0.163 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="UpdateIdentities: Adding a new identity" identity=6309 labels="[k8s:app=local-path-provisioner k8s:io.cilium.k8s.namespace.labels.kubernetes.io/metadata.name=local-path-storage k8s:io.cilium.k8s.policy.cluster=kind-kind k8s:io.cilium.k8s.policy.serviceaccount=local-path-provisioner-service-account k8s:io.kubernetes.pod.namespace=local-path-storage]" subsys=policy
level=debug msg="Upserting IP into ipcache layer" identity="{6309 custom-resource [] false false}" ipAddr=10.244.0.150 k8sNamespace=local-path-storage k8sPodName=local-path-provisioner-684f458cdd-sx4g8 key=0 namedPorts="map[]" subsys=ipcache
level=debug msg="Daemon notified of IP-Identity cache state change" identity="{6309 custom-resource [] false false}" ipAddr="{10.244.0.150 ffffffff}" modification=Upsert subsys=datapath-ipcache
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Load 1-min: 3.79 5-min: 1.72 15min: 1.15" endpointID=115 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1878 (47.75%) Free: 78 Buffers: 42 Cached: 1934" endpointID=115 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 510 (49.90%) Free: 513" endpointID=115 subsys=endpoint
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 4.97% MEM: 2.72% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 107 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=debug msg="NAME clang STATUS [running] PID 315 CPU: 30.80% MEM: 1.41% CMDLINE: clang -emit-llvm -g -O2 -target bpf -std=gnu89 -nostdinc -D__NR_CPUS__=5 -Wall -Wextra -Werror -Wshadow -Wno-address-of-packed-member -Wno-unknown-warning-option -Wno-gnu-variable-sized-type-not-at-end -Wdeclaration-after-statement -Wimplicit-int-conversion -Wenum-conversion -I/var/run/cilium/state/globals -I/var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43 -I/var/lib/cilium/bpf -I/var/lib/cilium/bpf/include -c /var/lib/cilium/bpf/bpf_host.c -o - MEM-EXT: RSS: 55 VMS: 90 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=115 subsys=endpoint
level=info msg="Compiled new BPF template" BPFCompilationTime=6.57438392s file-path=/var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43/bpf_host.o subsys=datapath-loader
level=debug msg="Watching template path" file-path=/var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43/bpf_host.o subsys=datapath-loader
level=debug msg="Found variable with offset 172296" subsys=elf symbol=NATIVE_DEV_IFINDEX
level=debug msg="Found variable with offset 172304" subsys=elf symbol=NODE_MAC_1
level=debug msg="Found variable with offset 172308" subsys=elf symbol=NODE_MAC_2
level=debug msg="Found variable with offset 172320" subsys=elf symbol=POLICY_VERDICT_LOG_FILTER
level=debug msg="Found variable with offset 172300" subsys=elf symbol=SECCTX_FROM_IPCACHE
level=debug msg="Found variable with offset 172312" subsys=elf symbol=SECLABEL
level=debug msg="Found variable with offset 172316" subsys=elf symbol=SECLABEL_NB
level=debug msg="Found symbol referring to unknown section id 28" subsys=elf symbol=____license
level=debug msg="Skipping __send_drop_notify" subsys=elf
level=debug msg="Skipping cil_from_host" subsys=elf
level=debug msg="Skipping cil_from_netdev" subsys=elf
level=debug msg="Skipping cil_to_host" subsys=elf
level=debug msg="Skipping cil_to_netdev" subsys=elf
level=debug msg="Found symbol with offset 1325661" subsys=elf symbol=cilium_auth_map
level=debug msg="Found symbol with offset 1325312" subsys=elf symbol=cilium_call_policy
level=debug msg="Found symbol with offset 1329976" subsys=elf symbol=cilium_calls_hostns_65535
level=debug msg="Found symbol with offset 1325755" subsys=elf symbol=cilium_ct4_global
level=debug msg="Found symbol with offset 1325733" subsys=elf symbol=cilium_ct_any4_global
level=debug msg="Found symbol with offset 1325820" subsys=elf symbol=cilium_encrypt_state
level=debug msg="Found symbol with offset 1325555" subsys=elf symbol=cilium_events
level=debug msg="Found symbol with offset 1325886" subsys=elf symbol=cilium_ipcache
level=debug msg="Found symbol with offset 1325575" subsys=elf symbol=cilium_ipv4_frag_datagrams
level=debug msg="Found symbol with offset 1325273" subsys=elf symbol=cilium_lb4_affinity
level=debug msg="Found symbol with offset 1331099" subsys=elf symbol=cilium_lb4_backends_v3
level=debug msg="Found symbol with offset 1325532" subsys=elf symbol=cilium_lb4_reverse_nat
level=debug msg="Found symbol with offset 1332169" subsys=elf symbol=cilium_lb4_services_v2
level=debug msg="Found symbol with offset 1325901" subsys=elf symbol=cilium_lb4_source_range
level=debug msg="Found symbol with offset 1325773" subsys=elf symbol=cilium_lb_affinity_match
level=debug msg="Found symbol with offset 1325925" subsys=elf symbol=cilium_lxc
level=debug msg="Found symbol with offset 1325635" subsys=elf symbol=cilium_metrics
level=debug msg="Found symbol with offset 1325677" subsys=elf symbol=cilium_node_map
level=debug msg="Found symbol with offset 1330495" subsys=elf symbol=cilium_nodeport_neigh4
level=debug msg="Found symbol with offset 1329956" subsys=elf symbol=cilium_policy_65535
level=debug msg="Found symbol with offset 1325798" subsys=elf symbol=cilium_runtime_config
level=debug msg="Found symbol with offset 1325602" subsys=elf symbol=cilium_signals
level=debug msg="Found symbol with offset 1325709" subsys=elf symbol=cilium_snat_v4_external
level=debug msg="Found symbol with offset 1330470" subsys=elf symbol=cilium_tail_call_buffer4
level=debug msg="Skipping tail_handle_ipv4_from_host" subsys=elf
level=debug msg="Skipping tail_handle_ipv4_from_netdev" subsys=elf
level=debug msg="Skipping tail_handle_snat_fwd_ipv4" subsys=elf
level=debug msg="Skipping tail_nodeport_nat_egress_ipv4" subsys=elf
level=debug msg="Skipping tail_nodeport_nat_ingress_ipv4" subsys=elf
level=debug msg="Skipping tail_rev_nodeport_lb4" subsys=elf
level=debug msg="Found section with offset 1325408" subsys=elf symbol=to-netdev
level=debug msg="Found section with offset 1325422" subsys=elf symbol=from-netdev
level=debug msg="Found section with offset 1325444" subsys=elf symbol=.BTF.ext
level=debug msg="Found section with offset 1325510" subsys=elf symbol=to-host
level=debug msg="Found section with offset 1325522" subsys=elf symbol=from-host
level=debug msg="Found section with offset 1325621" subsys=elf symbol=.debug_ranges
level=debug msg="Found section with offset 1325697" subsys=elf symbol=.debug_info
level=debug msg="Found section with offset 1325857" subsys=elf symbol=.debug_line
level=debug msg="Found section with offset 1325873" subsys=elf symbol=.debug_frame
level=debug msg="Found section with offset 1325940" subsys=elf symbol=.debug_loc
level=debug msg="Found section with offset 1326042" subsys=elf symbol=.BTF
level=debug msg="Found section with offset 1327407" subsys=elf symbol=2/38
level=debug msg="Found section with offset 1328655" subsys=elf symbol=2/17
level=debug msg="Found section with offset 1328700" subsys=elf symbol=2/7
level=debug msg="Found section with offset 1329125" subsys=elf symbol=2/36
level=debug msg="Found section with offset 1330252" subsys=elf symbol=2/15
level=debug msg="Found section with offset 1332723" subsys=elf symbol=2/22
level=debug msg="Found section with offset 1333742" subsys=elf symbol=2/1
level=debug msg="Finished writing ELF" error="<nil>" new-elf-path=115_next/bpf_host.o subsys=elf template-path=/var/run/cilium/state/templates/6a412d36ca98dba354b7c4b00df82f66023a0e11f7ab9754b8527c12a8410e43/bpf_host.o
level=debug msg="Found variable with offset 172296" subsys=elf symbol=NATIVE_DEV_IFINDEX
level=debug msg="Found variable with offset 172304" subsys=elf symbol=NODE_MAC_1
level=debug msg="Found variable with offset 172308" subsys=elf symbol=NODE_MAC_2
level=debug msg="Found variable with offset 172320" subsys=elf symbol=POLICY_VERDICT_LOG_FILTER
level=debug msg="Found variable with offset 172300" subsys=elf symbol=SECCTX_FROM_IPCACHE
level=debug msg="Found variable with offset 172312" subsys=elf symbol=SECLABEL
level=debug msg="Found variable with offset 172316" subsys=elf symbol=SECLABEL_NB
level=debug msg="Found symbol referring to unknown section id 28" subsys=elf symbol=____license
level=debug msg="Skipping __send_drop_notify" subsys=elf
level=debug msg="Skipping cil_from_host" subsys=elf
level=debug msg="Skipping cil_from_netdev" subsys=elf
level=debug msg="Skipping cil_to_host" subsys=elf
level=debug msg="Skipping cil_to_netdev" subsys=elf
level=debug msg="Found symbol with offset 1325661" subsys=elf symbol=cilium_auth_map
level=debug msg="Found symbol with offset 1325312" subsys=elf symbol=cilium_call_policy
level=debug msg="Found symbol with offset 1329976" subsys=elf symbol=cilium_calls_hostns_00115
level=debug msg="Found symbol with offset 1325755" subsys=elf symbol=cilium_ct4_global
level=debug msg="Found symbol with offset 1325733" subsys=elf symbol=cilium_ct_any4_global
level=debug msg="Found symbol with offset 1325820" subsys=elf symbol=cilium_encrypt_state
level=debug msg="Found symbol with offset 1325555" subsys=elf symbol=cilium_events
level=debug msg="Found symbol with offset 1325886" subsys=elf symbol=cilium_ipcache
level=debug msg="Found symbol with offset 1325575" subsys=elf symbol=cilium_ipv4_frag_datagrams
level=debug msg="Found symbol with offset 1325273" subsys=elf symbol=cilium_lb4_affinity
level=debug msg="Found symbol with offset 1331099" subsys=elf symbol=cilium_lb4_backends_v3
level=debug msg="Found symbol with offset 1325532" subsys=elf symbol=cilium_lb4_reverse_nat
level=debug msg="Found symbol with offset 1332169" subsys=elf symbol=cilium_lb4_services_v2
level=debug msg="Found symbol with offset 1325901" subsys=elf symbol=cilium_lb4_source_range
level=debug msg="Found symbol with offset 1325773" subsys=elf symbol=cilium_lb_affinity_match
level=debug msg="Found symbol with offset 1325925" subsys=elf symbol=cilium_lxc
level=debug msg="Found symbol with offset 1325635" subsys=elf symbol=cilium_metrics
level=debug msg="Found symbol with offset 1325677" subsys=elf symbol=cilium_node_map
level=debug msg="Found symbol with offset 1330495" subsys=elf symbol=cilium_nodeport_neigh4
level=debug msg="Found symbol with offset 1329956" subsys=elf symbol=cilium_policy_00115
level=debug msg="Found symbol with offset 1325798" subsys=elf symbol=cilium_runtime_config
level=debug msg="Found symbol with offset 1325602" subsys=elf symbol=cilium_signals
level=debug msg="Found symbol with offset 1325709" subsys=elf symbol=cilium_snat_v4_external
level=debug msg="Found symbol with offset 1330470" subsys=elf symbol=cilium_tail_call_buffer4
level=debug msg="Skipping tail_handle_ipv4_from_host" subsys=elf
level=debug msg="Skipping tail_handle_ipv4_from_netdev" subsys=elf
level=debug msg="Skipping tail_handle_snat_fwd_ipv4" subsys=elf
level=debug msg="Skipping tail_nodeport_nat_egress_ipv4" subsys=elf
level=debug msg="Skipping tail_nodeport_nat_ingress_ipv4" subsys=elf
level=debug msg="Skipping tail_rev_nodeport_lb4" subsys=elf
level=debug msg="Found section with offset 1325408" subsys=elf symbol=to-netdev
level=debug msg="Found section with offset 1325422" subsys=elf symbol=from-netdev
level=debug msg="Found section with offset 1325444" subsys=elf symbol=.BTF.ext
level=debug msg="Found section with offset 1325510" subsys=elf symbol=to-host
level=debug msg="Found section with offset 1325522" subsys=elf symbol=from-host
level=debug msg="Found section with offset 1325621" subsys=elf symbol=.debug_ranges
level=debug msg="Found section with offset 1325697" subsys=elf symbol=.debug_info
level=debug msg="Found section with offset 1325857" subsys=elf symbol=.debug_line
level=debug msg="Found section with offset 1325873" subsys=elf symbol=.debug_frame
level=debug msg="Found section with offset 1325940" subsys=elf symbol=.debug_loc
level=debug msg="Found section with offset 1326042" subsys=elf symbol=.BTF
level=debug msg="Found section with offset 1327407" subsys=elf symbol=2/38
level=debug msg="Found section with offset 1328655" subsys=elf symbol=2/17
level=debug msg="Found section with offset 1328700" subsys=elf symbol=2/7
level=debug msg="Found section with offset 1329125" subsys=elf symbol=2/36
level=debug msg="Found section with offset 1330252" subsys=elf symbol=2/15
level=debug msg="Found section with offset 1332723" subsys=elf symbol=2/22
level=debug msg="Found section with offset 1333742" subsys=elf symbol=2/1
level=debug msg="Finished writing ELF" error="<nil>" new-elf-path=115_next/bpf_host_cilium_net.o subsys=elf template-path=115_next/bpf_host.o
level=debug msg="Found variable with offset 172296" subsys=elf symbol=NATIVE_DEV_IFINDEX
level=debug msg="Found variable with offset 172304" subsys=elf symbol=NODE_MAC_1
level=debug msg="Found variable with offset 172308" subsys=elf symbol=NODE_MAC_2
level=debug msg="Found variable with offset 172320" subsys=elf symbol=POLICY_VERDICT_LOG_FILTER
level=debug msg="Found variable with offset 172300" subsys=elf symbol=SECCTX_FROM_IPCACHE
level=debug msg="Found variable with offset 172312" subsys=elf symbol=SECLABEL
level=debug msg="Found variable with offset 172316" subsys=elf symbol=SECLABEL_NB
level=debug msg="Found symbol referring to unknown section id 28" subsys=elf symbol=____license
level=debug msg="Skipping __send_drop_notify" subsys=elf
level=debug msg="Skipping cil_from_host" subsys=elf
level=debug msg="Skipping cil_from_netdev" subsys=elf
level=debug msg="Skipping cil_to_host" subsys=elf
level=debug msg="Skipping cil_to_netdev" subsys=elf
level=debug msg="Found symbol with offset 1325661" subsys=elf symbol=cilium_auth_map
level=debug msg="Found symbol with offset 1325312" subsys=elf symbol=cilium_call_policy
level=debug msg="Found symbol with offset 1329976" subsys=elf symbol=cilium_calls_hostns_00115
level=debug msg="Found symbol with offset 1325755" subsys=elf symbol=cilium_ct4_global
level=debug msg="Found symbol with offset 1325733" subsys=elf symbol=cilium_ct_any4_global
level=debug msg="Found symbol with offset 1325820" subsys=elf symbol=cilium_encrypt_state
level=debug msg="Found symbol with offset 1325555" subsys=elf symbol=cilium_events
level=debug msg="Found symbol with offset 1325886" subsys=elf symbol=cilium_ipcache
level=debug msg="Found symbol with offset 1325575" subsys=elf symbol=cilium_ipv4_frag_datagrams
level=debug msg="Found symbol with offset 1325273" subsys=elf symbol=cilium_lb4_affinity
level=debug msg="Found symbol with offset 1331099" subsys=elf symbol=cilium_lb4_backends_v3
level=debug msg="Found symbol with offset 1325532" subsys=elf symbol=cilium_lb4_reverse_nat
level=debug msg="Found symbol with offset 1332169" subsys=elf symbol=cilium_lb4_services_v2
level=debug msg="Found symbol with offset 1325901" subsys=elf symbol=cilium_lb4_source_range
level=debug msg="Found symbol with offset 1325773" subsys=elf symbol=cilium_lb_affinity_match
level=debug msg="Found symbol with offset 1325925" subsys=elf symbol=cilium_lxc
level=debug msg="Found symbol with offset 1325635" subsys=elf symbol=cilium_metrics
level=debug msg="Found symbol with offset 1325677" subsys=elf symbol=cilium_node_map
level=debug msg="Found symbol with offset 1330495" subsys=elf symbol=cilium_nodeport_neigh4
level=debug msg="Found symbol with offset 1329956" subsys=elf symbol=cilium_policy_00115
level=debug msg="Found symbol with offset 1325798" subsys=elf symbol=cilium_runtime_config
level=debug msg="Found symbol with offset 1325602" subsys=elf symbol=cilium_signals
level=debug msg="Found symbol with offset 1325709" subsys=elf symbol=cilium_snat_v4_external
level=debug msg="Found symbol with offset 1330470" subsys=elf symbol=cilium_tail_call_buffer4
level=debug msg="Skipping tail_handle_ipv4_from_host" subsys=elf
level=debug msg="Skipping tail_handle_ipv4_from_netdev" subsys=elf
level=debug msg="Skipping tail_handle_snat_fwd_ipv4" subsys=elf
level=debug msg="Skipping tail_nodeport_nat_egress_ipv4" subsys=elf
level=debug msg="Skipping tail_nodeport_nat_ingress_ipv4" subsys=elf
level=debug msg="Skipping tail_rev_nodeport_lb4" subsys=elf
level=debug msg="Found section with offset 1325408" subsys=elf symbol=to-netdev
level=debug msg="Found section with offset 1325422" subsys=elf symbol=from-netdev
level=debug msg="Found section with offset 1325444" subsys=elf symbol=.BTF.ext
level=debug msg="Found section with offset 1325510" subsys=elf symbol=to-host
level=debug msg="Found section with offset 1325522" subsys=elf symbol=from-host
level=debug msg="Found section with offset 1325621" subsys=elf symbol=.debug_ranges
level=debug msg="Found section with offset 1325697" subsys=elf symbol=.debug_info
level=debug msg="Found section with offset 1325857" subsys=elf symbol=.debug_line
level=debug msg="Found section with offset 1325873" subsys=elf symbol=.debug_frame
level=debug msg="Found section with offset 1325940" subsys=elf symbol=.debug_loc
level=debug msg="Found section with offset 1326042" subsys=elf symbol=.BTF
level=debug msg="Found section with offset 1327407" subsys=elf symbol=2/38
level=debug msg="Found section with offset 1328655" subsys=elf symbol=2/17
level=debug msg="Found section with offset 1328700" subsys=elf symbol=2/7
level=debug msg="Found section with offset 1329125" subsys=elf symbol=2/36
level=debug msg="Found section with offset 1330252" subsys=elf symbol=2/15
level=debug msg="Found section with offset 1332723" subsys=elf symbol=2/22
level=debug msg="Found section with offset 1333742" subsys=elf symbol=2/1
level=debug msg="Finished writing ELF" error="<nil>" new-elf-path=115_next/bpf_netdev_eth0.o subsys=elf template-path=115_next/bpf_host.o
level=debug msg="Loading CollectionSpec from ELF" device=cilium_host ifindex=5 objPath=115_next/bpf_host.o subsys=datapath-loader
level=debug msg="Loading Collection into kernel" device=cilium_host ifindex=5 objPath=115_next/bpf_host.o subsys=datapath-loader
level=debug msg="Attaching program to interface" device=cilium_host direction=ingress ifindex=5 objPath=115_next/bpf_host.o progName=cil_to_host subsys=datapath-loader
level=debug msg="Successfully attached program to interface" device=cilium_host direction=ingress ifindex=5 objPath=115_next/bpf_host.o progName=cil_to_host subsys=datapath-loader
level=debug msg="Loading CollectionSpec from ELF" device=cilium_host ifindex=5 objPath=115_next/bpf_host.o subsys=datapath-loader
level=debug msg="Loading Collection into kernel" device=cilium_host ifindex=5 objPath=115_next/bpf_host.o subsys=datapath-loader
level=debug msg="Attaching program to interface" device=cilium_host direction=egress ifindex=5 objPath=115_next/bpf_host.o progName=cil_from_host subsys=datapath-loader
level=debug msg="Successfully attached program to interface" device=cilium_host direction=egress ifindex=5 objPath=115_next/bpf_host.o progName=cil_from_host subsys=datapath-loader
level=debug msg="Loading CollectionSpec from ELF" device=cilium_net ifindex=4 objPath=115_next/bpf_host_cilium_net.o subsys=datapath-loader
level=debug msg="Loading Collection into kernel" device=cilium_net ifindex=4 objPath=115_next/bpf_host_cilium_net.o subsys=datapath-loader
level=debug msg="Regenerating all endpoints" subsys=policy
level=info msg="regenerating all endpoints" reason="one or more identities created or deleted" subsys=endpoint-manager
level=debug msg="Triggering endpoint regeneration due to one or more identities created or deleted" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=waiting-to-regenerate identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="Dequeued endpoint from build queue" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Regenerating endpoint" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ reason="one or more identities created or deleted" startTime="2023-06-24 17:28:47.396796171 +0000 UTC m=+9.618608881" subsys=endpoint
level=debug msg="Regenerating endpoint: one or more identities created or deleted" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=regenerating identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="Skipped duplicate endpoint regeneration trigger due to one or more identities created or deleted" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=115 endpointState=waiting-to-regenerate identity=1 ipv4= ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Starting policy recalculation..." containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Skipping unnecessary endpoint policy recalculation" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyChanged=true policyRevision.next=1 policyRevision.repo=1 subsys=endpoint
level=debug msg="preparing new cache transaction: upserting 1 entries, deleting 0 entries" subsys=xds xdsCachedVersion=8 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="inserting resource into cache" subsys=xds xdsCachedVersion=8 xdsResourceName=705 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="committing cache transaction and notifying of new version" subsys=xds xdsCachedVersion=8 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="BPF header file hashed (was: \"\")" bpfHeaderfileHash=86bea98f3e604d817401ad2b9fa935bde199f4e73c922857c07ae0ae05ed07ce containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/ep_config.h identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file with DNSRules" DNSRules="map[]" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/ep_config.h identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Preparing to compile BPF" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ regeneration-level=rewrite+load subsys=endpoint
level=debug msg="Found variable with offset 85756" subsys=elf symbol=LXC_ID
level=debug msg="Found variable with offset 85752" subsys=elf symbol=LXC_IPV4
level=debug msg="Found variable with offset 85736" subsys=elf symbol=LXC_IP_1
level=debug msg="Found variable with offset 85740" subsys=elf symbol=LXC_IP_2
level=debug msg="Found variable with offset 85744" subsys=elf symbol=LXC_IP_3
level=debug msg="Found variable with offset 85748" subsys=elf symbol=LXC_IP_4
level=debug msg="Found variable with offset 85760" subsys=elf symbol=NODE_MAC_1
level=debug msg="Found variable with offset 85764" subsys=elf symbol=NODE_MAC_2
level=debug msg="Found variable with offset 85776" subsys=elf symbol=POLICY_VERDICT_LOG_FILTER
level=debug msg="Found variable with offset 85768" subsys=elf symbol=SECLABEL
level=debug msg="Found variable with offset 85772" subsys=elf symbol=SECLABEL_NB
level=debug msg="Found symbol referring to unknown section id 30" subsys=elf symbol=____license
level=debug msg="Skipping __send_drop_notify" subsys=elf
level=debug msg="Skipping cil_from_container" subsys=elf
level=debug msg="Skipping cil_to_container" subsys=elf
level=debug msg="Found symbol with offset 839416" subsys=elf symbol=cilium_auth_map
level=debug msg="Found symbol with offset 839048" subsys=elf symbol=cilium_call_policy
level=debug msg="Found symbol with offset 842501" subsys=elf symbol=cilium_calls_65535
level=debug msg="Found symbol with offset 839510" subsys=elf symbol=cilium_ct4_global
level=debug msg="Found symbol with offset 839488" subsys=elf symbol=cilium_ct_any4_global
level=debug msg="Found symbol with offset 839588" subsys=elf symbol=cilium_encrypt_state
level=debug msg="Found symbol with offset 839181" subsys=elf symbol=cilium_events
level=debug msg="Found symbol with offset 839654" subsys=elf symbol=cilium_ipcache
level=debug msg="Found symbol with offset 839242" subsys=elf symbol=cilium_ipv4_frag_datagrams
level=debug msg="Found symbol with offset 839009" subsys=elf symbol=cilium_lb4_affinity
level=debug msg="Found symbol with offset 843574" subsys=elf symbol=cilium_lb4_backends_v3
level=debug msg="Found symbol with offset 839158" subsys=elf symbol=cilium_lb4_reverse_nat
level=debug msg="Found symbol with offset 844261" subsys=elf symbol=cilium_lb4_services_v2
level=debug msg="Found symbol with offset 839669" subsys=elf symbol=cilium_lb4_source_range
level=debug msg="Found symbol with offset 839528" subsys=elf symbol=cilium_lb_affinity_match
level=debug msg="Found symbol with offset 839693" subsys=elf symbol=cilium_lxc
level=debug msg="Found symbol with offset 839302" subsys=elf symbol=cilium_metrics
level=debug msg="Found symbol with offset 839432" subsys=elf symbol=cilium_node_map
level=debug msg="Found symbol with offset 842883" subsys=elf symbol=cilium_nodeport_neigh4
level=debug msg="Found symbol with offset 842481" subsys=elf symbol=cilium_policy_65535
level=debug msg="Found symbol with offset 839553" subsys=elf symbol=cilium_runtime_config
level=debug msg="Found symbol with offset 839269" subsys=elf symbol=cilium_signals
level=debug msg="Found symbol with offset 839464" subsys=elf symbol=cilium_snat_v4_external
level=debug msg="Found symbol with offset 842858" subsys=elf symbol=cilium_tail_call_buffer4
level=debug msg="Skipping handle_policy" subsys=elf
level=debug msg="Skipping tail_handle_arp" subsys=elf
level=debug msg="Skipping tail_handle_ipv4" subsys=elf
level=debug msg="Skipping tail_handle_ipv4_cont" subsys=elf
level=debug msg="Skipping tail_handle_snat_fwd_ipv4" subsys=elf
level=debug msg="Skipping tail_ipv4_ct_egress" subsys=elf
level=debug msg="Skipping tail_ipv4_ct_ingress" subsys=elf
level=debug msg="Skipping tail_ipv4_to_endpoint" subsys=elf
level=debug msg="Skipping tail_rev_nodeport_lb4" subsys=elf
level=debug msg="Found section with offset 839105" subsys=elf symbol=.BTF.ext
level=debug msg="Found section with offset 839288" subsys=elf symbol=.debug_ranges
level=debug msg="Found section with offset 839368" subsys=elf symbol=to-container
level=debug msg="Found section with offset 839385" subsys=elf symbol=from-container
level=debug msg="Found section with offset 839452" subsys=elf symbol=.debug_info
level=debug msg="Found section with offset 839579" subsys=elf symbol=1/0xffff
level=debug msg="Found section with offset 839625" subsys=elf symbol=.debug_line
level=debug msg="Found section with offset 839641" subsys=elf symbol=.debug_frame
level=debug msg="Found section with offset 839708" subsys=elf symbol=.debug_loc
level=debug msg="Found section with offset 839790" subsys=elf symbol=.BTF
level=debug msg="Found section with offset 840219" subsys=elf symbol=2/29
level=debug msg="Found section with offset 840685" subsys=elf symbol=2/38
level=debug msg="Found section with offset 841389" subsys=elf symbol=2/27
level=debug msg="Found section with offset 841460" subsys=elf symbol=2/17
level=debug msg="Found section with offset 841507" subsys=elf symbol=2/7
level=debug msg="Found section with offset 842088" subsys=elf symbol=2/6
level=debug msg="Found section with offset 842677" subsys=elf symbol=2/25
level=debug msg="Found section with offset 844183" subsys=elf symbol=2/13
level=debug msg="Found section with offset 845521" subsys=elf symbol=2/1
level=debug msg="Attaching program to interface" device=cilium_net direction=ingress ifindex=4 objPath=115_next/bpf_host_cilium_net.o progName=cil_to_host subsys=datapath-loader
level=debug msg="Load 1-min: 3.79 5-min: 1.72 15min: 1.15" endpointID=705 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1860 (47.29%) Free: 123 Buffers: 40 Cached: 1909" endpointID=705 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 510 (49.88%) Free: 513" endpointID=705 subsys=endpoint
level=debug msg="Finished writing ELF" error="<nil>" new-elf-path=705_next/bpf_lxc.o subsys=elf template-path=/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d/bpf_lxc.o
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 6.35% MEM: 2.70% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 106 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="Loading CollectionSpec from ELF" device=lxc_health ifindex=7 objPath=705_next/bpf_lxc.o subsys=datapath-loader
level=debug msg="Loading Collection into kernel" device=lxc_health ifindex=7 objPath=705_next/bpf_lxc.o subsys=datapath-loader
level=debug msg="Successfully attached program to interface" device=cilium_net direction=ingress ifindex=4 objPath=115_next/bpf_host_cilium_net.o progName=cil_to_host subsys=datapath-loader
level=debug msg="Loading CollectionSpec from ELF" device=eth0 ifindex=160 objPath=115_next/bpf_netdev_eth0.o subsys=datapath-loader
Verifier error: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)
Verifier log: load program: permission denied:
	btf_vmlinux is malformed
	R1 type=ctx expected=fp
	; int tail_handle_ipv4(struct __ctx_buff *ctx)
	0: (bf) r6 = r1
	; ctx_pull_data(ctx, tot_len);
	1: (b4) w2 = 34
	2: (85) call bpf_skb_pull_data#39
	3: (b4) w8 = -134
	; return (void *)(unsigned long)ctx->data_end;
	4: (61) r1 = *(u32 *)(r6 +80)
	; return (void *)(unsigned long)ctx->data;
	5: (61) r7 = *(u32 *)(r6 +76)
	; if (data + tot_len > data_end)
	6: (bf) r2 = r7
	7: (07) r2 += 34
	; __s8 ext_err = 0;
	8: (b4) w9 = 0
	9: (7b) *(u64 *)(r10 -128) = r6
	; if (data + tot_len > data_end)
	10: (2d) if r2 > r1 goto pc+1158
	 R0_w=inv(id=0) R1_w=pkt_end(id=0,off=0,imm=0) R2_w=pkt(id=0,off=34,r=34,imm=0) R6_w=ctx(id=0,off=0,imm=0) R7_w=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967162 R9_w=inv0 R10=fp0 fp-128_w=ctx
	11: (b4) w8 = -132
	; return ip4->saddr == LXC_IPV4;
	12: (18) r1 = 0xc103f40a
	; return ip4->saddr == LXC_IPV4;
	14: (61) r2 = *(u32 *)(r7 +26)
	; __s8 ext_err = 0;
	15: (b4) w9 = 0
	; if (unlikely(!is_valid_lxc_src_ipv4(ip4)))
	16: (5e) if w2 != w1 goto pc+1152
	 R0=inv(id=0) R1=inv3238261770 R2=inv3238261770 R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967164 R9=inv0 R10=fp0 fp-128=ctx
	17: (b4) w1 = 0
	; struct ipv4_ct_tuple tuple = {};
	18: (6b) *(u16 *)(r10 -92) = r1
	last_idx 18 first_idx 16
	regs=2 stack=0 before 17: (b4) w1 = 0
	19: (63) *(u32 *)(r10 -96) = r1
	; struct lb4_key key = {};
	20: (63) *(u32 *)(r10 -112) = r1
	21: (b7) r1 = 0
	22: (7b) *(u64 *)(r10 -120) = r1
	last_idx 22 first_idx 16
	regs=2 stack=0 before 21: (b7) r1 = 0
	23: (b4) w8 = -158
	; return ip4->frag_off & bpf_htons(0x1FFF);
	24: (69) r1 = *(u16 *)(r7 +20)
	; tuple->nexthdr = ip4->protocol;
	25: (63) *(u32 *)(r10 -132) = r1
	26: (71) r1 = *(u8 *)(r7 +23)
	; tuple->nexthdr = ip4->protocol;
	27: (73) *(u8 *)(r10 -92) = r1
	; tuple->daddr = ip4->daddr;
	28: (61) r2 = *(u32 *)(r7 +30)
	; tuple->daddr = ip4->daddr;
	29: (63) *(u32 *)(r10 -104) = r2
	; tuple->saddr = ip4->saddr;
	30: (61) r3 = *(u32 *)(r7 +26)
	; tuple->saddr = ip4->saddr;
	31: (63) *(u32 *)(r10 -100) = r3
	; return ip4->ihl * 4;
	32: (71) r9 = *(u8 *)(r7 +14)
	; return ip4->ihl * 4;
	33: (64) w9 <<= 2
	34: (54) w9 &= 60
	; *l4_off = l3_off + ipv4_hdrlen(ip4);
	35: (04) w9 += 14
	; switch (tuple->nexthdr) {
	36: (16) if w1 == 0x1 goto pc+113
	 R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2_w=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3_w=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967138 R9_w=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120_w=00000000 fp-128=ctx fp-136=mmmm????
	37: (16) if w1 == 0x11 goto pc+1
	 R0=inv(id=0) R1=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	38: (56) if w1 != 0x6 goto pc+29
	 R0=inv(id=0) R1=inv6 R2=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; struct ipv4_frag_id frag_id = {
	39: (63) *(u32 *)(r10 -20) = r3
	40: (63) *(u32 *)(r10 -24) = r2
	; .id = ip4->id,
	41: (69) r2 = *(u16 *)(r7 +18)
	42: (b4) w3 = 0
	; struct ipv4_frag_id frag_id = {
	43: (73) *(u8 *)(r10 -13) = r3
	last_idx 43 first_idx 37
	regs=8 stack=0 before 42: (b4) w3 = 0
	44: (73) *(u8 *)(r10 -14) = r1
	45: (6b) *(u16 *)(r10 -16) = r2
	; return ip4->frag_off & bpf_htons(0x3FFF);
	46: (61) r1 = *(u32 *)(r10 -132)
	47: (54) w1 &= 65343
	; if (unlikely(is_fragment)) {
	48: (16) if w1 == 0x0 goto pc+45
	 R0=inv(id=0) R1=inv(id=0,umax_value=65343,var_off=(0x0; 0xff3f)) R2=inv(id=0,umax_value=65535,var_off=(0x0; 0xffff)) R3=invP0 R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; return ctx->len;
	49: (61) r6 = *(u32 *)(r6 +0)
	50: (b7) r1 = 0
	; struct metrics_value *entry, new_entry = {};
	51: (7b) *(u64 *)(r10 -72) = r1
	last_idx 51 first_idx 48
	regs=2 stack=0 before 50: (b7) r1 = 0
	52: (7b) *(u64 *)(r10 -80) = r1
	53: (b7) r1 = 521
	; struct metrics_key key = {};
	54: (7b) *(u64 *)(r10 -88) = r1
	55: (bf) r2 = r10
	;
	56: (07) r2 += -88
	; entry = map_lookup_elem(&METRICS_MAP, &key);
	57: (18) r1 = 0xffff413a9dac6800
	59: (85) call bpf_map_lookup_elem#1
	; if (entry) {
	60: (15) if r0 == 0x0 goto pc+9
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; entry->count += 1;
	61: (79) r1 = *(u64 *)(r0 +0)
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	62: (07) r1 += 1
	63: (7b) *(u64 *)(r0 +0) = r1
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; entry->bytes += bytes;
	64: (79) r1 = *(u64 *)(r0 +8)
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	65: (0f) r1 += r6
	66: (7b) *(u64 *)(r0 +8) = r1
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	67: (05) goto pc+13
	; return ip4->frag_off & bpf_htons(0x1FFF);
	81: (69) r1 = *(u16 *)(r7 +20)
	; return ip4->frag_off & bpf_htons(0x1FFF);
	82: (54) w1 &= 65311
	83: (79) r6 = *(u64 *)(r10 -128)
	; if (likely(not_first_fragment))
	84: (16) if w1 == 0x0 goto pc+9
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0,umax_value=65311,var_off=(0x0; 0xff1f)) R6_w=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	85: (bf) r2 = r10
	;
	86: (07) r2 += -24
	; tmp = map_lookup_elem(&IPV4_FRAG_DATAGRAMS_MAP, frag_id);
	87: (18) r1 = 0xffff413b1d08e000
	89: (85) call bpf_map_lookup_elem#1
	; if (!tmp)
	90: (55) if r0 != 0x0 goto pc+1327
	
	from 90 to 1418: R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; case  4: __it_mob(d, s, 32);
	1418: (61) r1 = *(u32 *)(r0 +0)
	 R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	1419: (63) *(u32 *)(r10 -96) = r1
	1420: (05) goto pc-1272
	; map_update_elem(&METRICS_MAP, &key, &new_entry, 0);
	149: (b4) w8 = 0
	150: (b4) w1 = 1
	; if (IS_ERR(ret)) {
	151: (16) if w8 == 0x2 goto pc+1
	last_idx 151 first_idx 149
	regs=100 stack=0 before 150: (b4) w1 = 1
	regs=100 stack=0 before 149: (b4) w8 = 0
	152: (b4) w1 = 0
	153: (bc) w2 = w8
	154: (74) w2 >>= 31
	155: (4c) w2 |= w1
	; if (IS_ERR(ret)) {
	156: (16) if w2 == 0x0 goto pc+8
	; if (ret == DROP_NO_SERVICE || ret == DROP_UNKNOWN_L4)
	165: (63) *(u32 *)(r10 -148) = r9
	; key->address = tuple->daddr;
	166: (61) r1 = *(u32 *)(r10 -104)
	; key->address = tuple->daddr;
	167: (63) *(u32 *)(r10 -120) = r1
	; key->dport = tuple->sport;
	168: (69) r1 = *(u16 *)(r10 -94)
	; key->dport = tuple->sport;
	169: (6b) *(u16 *)(r10 -116) = r1
	170: (b4) w8 = -134
	171: (b4) w9 = 0
	; key->proto = 0;
	172: (73) *(u8 *)(r10 -112) = r9
	last_idx 172 first_idx 165
	regs=200 stack=0 before 171: (b4) w9 = 0
	; return (void *)(unsigned long)ctx->data_end;
	173: (61) r1 = *(u32 *)(r6 +80)
	; return (void *)(unsigned long)ctx->data;
	174: (61) r2 = *(u32 *)(r6 +76)
	; if (data + tot_len > data_end)
	175: (07) r2 += 34
	; if (data + tot_len > data_end)
	176: (2d) if r2 > r1 goto pc+992
	 R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R1_w=pkt_end(id=0,off=0,imm=0) R2_w=pkt(id=0,off=34,r=34,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967162 R9_w=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????0000 fp-120=00mmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	177: (b4) w6 = 0
	; key->backend_slot = 0;
	178: (6b) *(u16 *)(r10 -114) = r6
	last_idx 178 first_idx 165
	regs=40 stack=0 before 177: (b4) w6 = 0
	; key->scope = LB_LOOKUP_SCOPE_EXT;
	179: (73) *(u8 *)(r10 -111) = r6
	180: (bf) r2 = r10
	;
	181: (07) r2 += -120
	; svc = map_lookup_elem(&LB4_SERVICES_MAP_V2, key);
	182: (18) r1 = 0xffff413a9da6cc00
	184: (85) call bpf_map_lookup_elem#1
	185: (b7) r2 = 0
	; if (svc) {
	186: (15) if r0 == 0x0 goto pc+12
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R2_w=inv0 R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	; return svc->flags2 & SVC_FLAG_TWO_SCOPES;
	187: (71) r1 = *(u8 *)(r0 +9)
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R2_w=inv0 R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	; return svc->flags2 & SVC_FLAG_TWO_SCOPES;
	188: (54) w1 &= 32
	189: (bf) r2 = r0
	; if (!scope_switch || !lb4_svc_is_two_scopes(svc))
	190: (16) if w1 == 0x0 goto pc+8
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R1_w=inv(id=0,umax_value=32,var_off=(0x0; 0x20)) R2_w=map_value(id=0,off=0,ks=12,vs=12,imm=0) R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	191: (b4) w1 = 1
	; key->scope = LB_LOOKUP_SCOPE_INT;
	192: (73) *(u8 *)(r10 -111) = r1
	193: (bf) r2 = r10
	194: (07) r2 += -120
	; svc = map_lookup_elem(&LB4_SERVICES_MAP_V2, key);
	195: (18) r1 = 0xffff413a9da6cc00
	197: (85) call bpf_map_lookup_elem#1
	198: (bf) r2 = r0
	; __u8 flags = tuple->flags;
	199: (71) r7 = *(u8 *)(r10 -91)
	; __be32 saddr = tuple->saddr;
	200: (61) r1 = *(u32 *)(r10 -100)
	; if (tuple->nexthdr == IPPROTO_TCP)
	201: (63) *(u32 *)(r10 -136) = r1
	202: (71) r9 = *(u8 *)(r10 -92)
	; __be32 new_saddr = 0;
	203: (63) *(u32 *)(r10 -88) = r6
	;
	204: (18) r1 = 0xffff413ab6a7c800
	206: (7b) *(u64 *)(r10 -144) = r1
	207: (16) if w9 == 0x6 goto pc+3
	 R0=map_value_or_null(id=5,off=0,ks=12,vs=12,imm=0) R1_w=map_ptr(id=0,off=0,ks=14,vs=56,imm=0) R2_w=map_value_or_null(id=5,off=0,ks=12,vs=12,imm=0) R6=invP0 R7_w=invP0 R8=inv4294967162 R9_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmm0000 fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmmmmmm fp-144_w=map_ptr fp-152=mmmm????
	208: (18) r1 = 0xffff413ab6a7c400
	210: (7b) *(u64 *)(r10 -144) = r1
	211: (b4) w8 = -158
	; if (unlikely(svc->count == 0))
	212: (69) r1 = *(u16 *)(r2 +4)
	R2 invalid mem access 'map_value_or_null'
	processed 211 insns (limit 1000000) max_states_per_insn 1 total_states 15 peak_states 15 mark_read 8
level=warning msg="JoinEP: Failed to attach program(s)" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" file-path=705_next/bpf_lxc.o identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=datapath-loader veth=lxc_health
level=error msg="Error while rewriting endpoint BPF program" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting endpoint changes after BPF regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting proxy redirect removals" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting proxy redirect removals" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Loading Collection into kernel" device=eth0 ifindex=160 objPath=115_next/bpf_netdev_eth0.o subsys=datapath-loader
level=debug msg="Reverting xDS network policy update" subsys=envoy-manager
level=debug msg="preparing new cache transaction: upserting 0 entries, deleting 1 entries" subsys=xds xdsCachedVersion=9 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="deleting resource from cache" subsys=xds xdsCachedVersion=9 xdsResourceName=705 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="committing cache transaction and notifying of new version" subsys=xds xdsCachedVersion=9 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="Finished reverting xDS network policy update" subsys=envoy-manager
level=debug msg="Reverting proxy redirect additions" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting proxy redirect additions" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting endpoint changes after BPF regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=info msg="Wrote verifier log to endpoint directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/verifier.log identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=info msg="generating BPF for endpoint failed, keeping stale directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" file-path=705_next_fail identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next_fail endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Completed endpoint regeneration with no pending regeneration requests" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=ready identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=warning msg="Regeneration of endpoint failed" bpfCompilation=0s bpfLoadProg=31.544291ms bpfWaitForELF="2.959µs" bpfWriteELF="968.917µs" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ mapSync="12.25µs" policyCalculation="19.083µs" prepareBuild="194.25µs" proxyConfiguration="6.75µs" proxyPolicyCalculation="24.083µs" proxyWaitForAck=0s reason="one or more identities created or deleted" subsys=endpoint total=37.029583ms waitingForCTClean="458.709µs" waitingForLock="1.458µs"
level=debug msg="Error regenerating endpoint: loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" code=Failure containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=ready identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=200
level=debug msg="EventQueue event processing statistics" eventConsumeOffQueueWaitTime="2.75µs" eventEnqueueWaitTime=750ns eventHandlingDuration=37.103375ms eventType="*endpoint.EndpointRegenerationEvent" name=endpoint-705 subsys=eventqueue
level=error msg="endpoint regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Attaching program to interface" device=eth0 direction=ingress ifindex=160 objPath=115_next/bpf_netdev_eth0.o progName=cil_from_netdev subsys=datapath-loader
level=debug msg="Successfully attached program to interface" device=eth0 direction=ingress ifindex=160 objPath=115_next/bpf_netdev_eth0.o progName=cil_from_netdev subsys=datapath-loader
level=debug msg="Loading CollectionSpec from ELF" device=eth0 ifindex=160 objPath=115_next/bpf_netdev_eth0.o subsys=datapath-loader
level=debug msg="Loading Collection into kernel" device=eth0 ifindex=160 objPath=115_next/bpf_netdev_eth0.o subsys=datapath-loader
level=debug msg="Attaching program to interface" device=eth0 direction=egress ifindex=160 objPath=115_next/bpf_netdev_eth0.o progName=cil_to_netdev subsys=datapath-loader
level=debug msg="Successfully attached program to interface" device=eth0 direction=egress ifindex=160 objPath=115_next/bpf_netdev_eth0.o progName=cil_to_netdev subsys=datapath-loader
level=info msg="Rewrote endpoint BPF program" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Waiting for proxy updates to complete..." containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Wait time for proxy updates: 16.458µs" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finalizing successful endpoint regeneration" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="synchronizing directories" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="attempting to make temporary directory new directory for endpoint programs" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ originalDirectory=/var/run/cilium/state/115 subsys=endpoint temporaryDirectory=115_next
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=115_next_fail endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Starting new controller" name=sync-policymap-115 subsys=controller uuid=d8a7f07b-e5ac-4368-a503-2539613a2a21
level=debug msg="removing directory" containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 directory=115_next endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Completed endpoint regeneration" bpfCompilation=6.57438392s bpfLoadProg=358.74925ms bpfWaitForELF=6.575090253s bpfWriteELF=1.328709ms containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ mapSync="796.667µs" policyCalculation="222.667µs" prepareBuild="482.625µs" proxyConfiguration="6.583µs" proxyPolicyCalculation="7.041µs" proxyWaitForAck="30.833µs" reason="updated security labels" subsys=endpoint total=6.939052795s waitingForCTClean="695.667µs" waitingForLock="1.959µs"
level=debug msg="Controller func execution time: 361.125µs" name=sync-policymap-115 subsys=controller uuid=d8a7f07b-e5ac-4368-a503-2539613a2a21
level=debug msg="Successfully regenerated endpoint program (Reason: updated security labels)" code=OK containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 endpointState=waiting-to-regenerate identity=1 ipv4= ipv6= k8sPodName=/ policyRevision=1 subsys=endpoint type=200
level=debug msg="EventQueue event processing statistics" eventConsumeOffQueueWaitTime="206.75µs" eventEnqueueWaitTime=666ns eventHandlingDuration=6.940532628s eventType="*endpoint.EndpointRegenerationEvent" name=endpoint-115 subsys=eventqueue
level=debug msg="Dequeued endpoint from build queue" containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Regenerating endpoint" containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ reason="one or more identities created or deleted" startTime="2023-06-24 17:28:47.576812337 +0000 UTC m=+9.798625047" subsys=endpoint
level=debug msg="Regenerating endpoint: one or more identities created or deleted" code=OK containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 endpointState=regenerating identity=1 ipv4= ipv6= k8sPodName=/ policyRevision=1 subsys=endpoint type=0
level=debug msg="removing directory" containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 directory=115_next endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Starting policy recalculation..." containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Skipping unnecessary endpoint policy recalculation" containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ policyChanged=false policyRevision.next=1 policyRevision.repo=1 subsys=endpoint
level=debug msg="Endpoint has no IP addresses" endpointID=115 subsys=envoy-manager
level=debug msg="BPF header file hashed (was: \"3220e44a09dc8d4bf52bbe0f0d21194b0666f7f31a079839165e075980b8f5da\")" bpfHeaderfileHash=3220e44a09dc8d4bf52bbe0f0d21194b0666f7f31a079839165e075980b8f5da containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Preparing to compile BPF" containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ regeneration-level=no-rebuild subsys=endpoint
level=debug msg="BPF header file unchanged, skipping BPF compilation and installation" bpfHeaderfileHash=3220e44a09dc8d4bf52bbe0f0d21194b0666f7f31a079839165e075980b8f5da containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Waiting for proxy updates to complete..." containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Wait time for proxy updates: 4.584µs" containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finalizing successful endpoint regeneration" containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="synchronizing directories" containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="endpoint directory exists; backing it up" containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 directory=115_stale endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="moving current directory to backup location" backupDirectory=115_stale containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ originalDirectory=/var/run/cilium/state/115 subsys=endpoint
level=debug msg="some BPF state files were not recreated; moving old BPF objects into new directory" containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 directory=115_next_fail endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 directory=115_stale endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Updating existing controller" name=sync-policymap-115 subsys=controller uuid=d8a7f07b-e5ac-4368-a503-2539613a2a21
level=debug msg="Controller update time: 12.583µs" name=sync-policymap-115 subsys=controller uuid=d8a7f07b-e5ac-4368-a503-2539613a2a21
level=debug msg="removing directory" containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 directory=115_next endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Completed endpoint regeneration with no pending regeneration requests" code=OK containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 endpointState=ready identity=1 ipv4= ipv6= k8sPodName=/ policyRevision=1 subsys=endpoint type=0
level=debug msg="Completed endpoint regeneration" bpfCompilation=0s bpfLoadProg=0s bpfWaitForELF=0s bpfWriteELF=0s containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ mapSync="29.334µs" policyCalculation="17.834µs" prepareBuild="122.125µs" proxyConfiguration="5.874µs" proxyPolicyCalculation="6.75µs" proxyWaitForAck="8.792µs" reason="one or more identities created or deleted" subsys=endpoint total="605.916µs" waitingForCTClean=166ns waitingForLock=875ns
level=debug msg="Successfully regenerated endpoint program (Reason: one or more identities created or deleted)" code=OK containerID= datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 endpointState=ready identity=1 ipv4= ipv6= k8sPodName=/ policyRevision=1 subsys=endpoint type=200
level=debug msg="EventQueue event processing statistics" eventConsumeOffQueueWaitTime=6.633024253s eventEnqueueWaitTime=500ns eventHandlingDuration="667.5µs" eventType="*endpoint.EndpointRegenerationEvent" name=endpoint-115 subsys=eventqueue
level=debug msg="Controller func execution time: 104.75µs" name=sync-policymap-115 subsys=controller uuid=d8a7f07b-e5ac-4368-a503-2539613a2a21
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="received signal that regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Triggering endpoint regeneration due to retrying regeneration" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=waiting-to-regenerate identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="Dequeued endpoint from build queue" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Regenerating endpoint" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ reason="retrying regeneration" startTime="2023-06-24 17:28:48.245676463 +0000 UTC m=+10.467489214" subsys=endpoint
level=debug msg="Regenerating endpoint: retrying regeneration" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=regenerating identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Starting policy recalculation..." containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Skipping unnecessary endpoint policy recalculation" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyChanged=true policyRevision.next=1 policyRevision.repo=1 subsys=endpoint
level=debug msg="preparing new cache transaction: upserting 1 entries, deleting 0 entries" subsys=xds xdsCachedVersion=10 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="inserting resource into cache" subsys=xds xdsCachedVersion=10 xdsResourceName=705 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="committing cache transaction and notifying of new version" subsys=xds xdsCachedVersion=10 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="BPF header file hashed (was: \"\")" bpfHeaderfileHash=86bea98f3e604d817401ad2b9fa935bde199f4e73c922857c07ae0ae05ed07ce containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/ep_config.h identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file with DNSRules" DNSRules="map[]" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/ep_config.h identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Preparing to compile BPF" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ regeneration-level=rewrite+load subsys=endpoint
level=debug msg="Found variable with offset 85756" subsys=elf symbol=LXC_ID
level=debug msg="Found variable with offset 85752" subsys=elf symbol=LXC_IPV4
level=debug msg="Found variable with offset 85736" subsys=elf symbol=LXC_IP_1
level=debug msg="Found variable with offset 85740" subsys=elf symbol=LXC_IP_2
level=debug msg="Found variable with offset 85744" subsys=elf symbol=LXC_IP_3
level=debug msg="Found variable with offset 85748" subsys=elf symbol=LXC_IP_4
level=debug msg="Found variable with offset 85760" subsys=elf symbol=NODE_MAC_1
level=debug msg="Found variable with offset 85764" subsys=elf symbol=NODE_MAC_2
level=debug msg="Found variable with offset 85776" subsys=elf symbol=POLICY_VERDICT_LOG_FILTER
level=debug msg="Found variable with offset 85768" subsys=elf symbol=SECLABEL
level=debug msg="Found variable with offset 85772" subsys=elf symbol=SECLABEL_NB
level=debug msg="Found symbol referring to unknown section id 30" subsys=elf symbol=____license
level=debug msg="Skipping __send_drop_notify" subsys=elf
level=debug msg="Skipping cil_from_container" subsys=elf
level=debug msg="Skipping cil_to_container" subsys=elf
level=debug msg="Found symbol with offset 839416" subsys=elf symbol=cilium_auth_map
level=debug msg="Load 1-min: 3.79 5-min: 1.72 15min: 1.15" endpointID=705 subsys=endpoint
level=debug msg="Found symbol with offset 839048" subsys=elf symbol=cilium_call_policy
level=debug msg="Found symbol with offset 842501" subsys=elf symbol=cilium_calls_65535
level=debug msg="Found symbol with offset 839510" subsys=elf symbol=cilium_ct4_global
level=debug msg="Found symbol with offset 839488" subsys=elf symbol=cilium_ct_any4_global
level=debug msg="Found symbol with offset 839588" subsys=elf symbol=cilium_encrypt_state
level=debug msg="Found symbol with offset 839181" subsys=elf symbol=cilium_events
level=debug msg="Found symbol with offset 839654" subsys=elf symbol=cilium_ipcache
level=debug msg="Found symbol with offset 839242" subsys=elf symbol=cilium_ipv4_frag_datagrams
level=debug msg="Found symbol with offset 839009" subsys=elf symbol=cilium_lb4_affinity
level=debug msg="Found symbol with offset 843574" subsys=elf symbol=cilium_lb4_backends_v3
level=debug msg="Found symbol with offset 839158" subsys=elf symbol=cilium_lb4_reverse_nat
level=debug msg="Found symbol with offset 844261" subsys=elf symbol=cilium_lb4_services_v2
level=debug msg="Found symbol with offset 839669" subsys=elf symbol=cilium_lb4_source_range
level=debug msg="Found symbol with offset 839528" subsys=elf symbol=cilium_lb_affinity_match
level=debug msg="Found symbol with offset 839693" subsys=elf symbol=cilium_lxc
level=debug msg="Found symbol with offset 839302" subsys=elf symbol=cilium_metrics
level=debug msg="Found symbol with offset 839432" subsys=elf symbol=cilium_node_map
level=debug msg="Found symbol with offset 842883" subsys=elf symbol=cilium_nodeport_neigh4
level=debug msg="Found symbol with offset 842481" subsys=elf symbol=cilium_policy_65535
level=debug msg="Found symbol with offset 839553" subsys=elf symbol=cilium_runtime_config
level=debug msg="Found symbol with offset 839269" subsys=elf symbol=cilium_signals
level=debug msg="Found symbol with offset 839464" subsys=elf symbol=cilium_snat_v4_external
level=debug msg="Found symbol with offset 842858" subsys=elf symbol=cilium_tail_call_buffer4
level=debug msg="Skipping handle_policy" subsys=elf
level=debug msg="Skipping tail_handle_arp" subsys=elf
level=debug msg="Skipping tail_handle_ipv4" subsys=elf
level=debug msg="Skipping tail_handle_ipv4_cont" subsys=elf
level=debug msg="Skipping tail_handle_snat_fwd_ipv4" subsys=elf
level=debug msg="Skipping tail_ipv4_ct_egress" subsys=elf
level=debug msg="Skipping tail_ipv4_ct_ingress" subsys=elf
level=debug msg="Skipping tail_ipv4_to_endpoint" subsys=elf
level=debug msg="Skipping tail_rev_nodeport_lb4" subsys=elf
level=debug msg="Found section with offset 839105" subsys=elf symbol=.BTF.ext
level=debug msg="Found section with offset 839288" subsys=elf symbol=.debug_ranges
level=debug msg="Found section with offset 839368" subsys=elf symbol=to-container
level=debug msg="Found section with offset 839385" subsys=elf symbol=from-container
level=debug msg="Found section with offset 839452" subsys=elf symbol=.debug_info
level=debug msg="Found section with offset 839579" subsys=elf symbol=1/0xffff
level=debug msg="Found section with offset 839625" subsys=elf symbol=.debug_line
level=debug msg="Found section with offset 839641" subsys=elf symbol=.debug_frame
level=debug msg="Found section with offset 839708" subsys=elf symbol=.debug_loc
level=debug msg="Found section with offset 839790" subsys=elf symbol=.BTF
level=debug msg="Found section with offset 840219" subsys=elf symbol=2/29
level=debug msg="Found section with offset 840685" subsys=elf symbol=2/38
level=debug msg="Found section with offset 841389" subsys=elf symbol=2/27
level=debug msg="Found section with offset 841460" subsys=elf symbol=2/17
level=debug msg="Found section with offset 841507" subsys=elf symbol=2/7
level=debug msg="Found section with offset 842088" subsys=elf symbol=2/6
level=debug msg="Found section with offset 842677" subsys=elf symbol=2/25
level=debug msg="Found section with offset 844183" subsys=elf symbol=2/13
level=debug msg="Found section with offset 845521" subsys=elf symbol=2/1
level=debug msg="Memory: Total: 3933 Used: 1874 (47.67%) Free: 114 Buffers: 40 Cached: 1903" endpointID=705 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 510 (49.88%) Free: 513" endpointID=705 subsys=endpoint
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 7.64% MEM: 2.87% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 112 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="Finished writing ELF" error="<nil>" new-elf-path=705_next/bpf_lxc.o subsys=elf template-path=/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d/bpf_lxc.o
level=debug msg="Loading CollectionSpec from ELF" device=lxc_health ifindex=7 objPath=705_next/bpf_lxc.o subsys=datapath-loader
level=debug msg="Loading Collection into kernel" device=lxc_health ifindex=7 objPath=705_next/bpf_lxc.o subsys=datapath-loader
Verifier error: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)
Verifier log: load program: permission denied:
	btf_vmlinux is malformed
	R1 type=ctx expected=fp
	; int tail_handle_ipv4(struct __ctx_buff *ctx)
	0: (bf) r6 = r1
	; ctx_pull_data(ctx, tot_len);
	1: (b4) w2 = 34
	2: (85) call bpf_skb_pull_data#39
	3: (b4) w8 = -134
	; return (void *)(unsigned long)ctx->data_end;
	4: (61) r1 = *(u32 *)(r6 +80)
	; return (void *)(unsigned long)ctx->data;
	5: (61) r7 = *(u32 *)(r6 +76)
	; if (data + tot_len > data_end)
	6: (bf) r2 = r7
	7: (07) r2 += 34
	; __s8 ext_err = 0;
	8: (b4) w9 = 0
	9: (7b) *(u64 *)(r10 -128) = r6
	; if (data + tot_len > data_end)
	10: (2d) if r2 > r1 goto pc+1158
	 R0_w=inv(id=0) R1_w=pkt_end(id=0,off=0,imm=0) R2_w=pkt(id=0,off=34,r=34,imm=0) R6_w=ctx(id=0,off=0,imm=0) R7_w=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967162 R9_w=inv0 R10=fp0 fp-128_w=ctx
	11: (b4) w8 = -132
	; return ip4->saddr == LXC_IPV4;
	12: (18) r1 = 0xc103f40a
	; return ip4->saddr == LXC_IPV4;
	14: (61) r2 = *(u32 *)(r7 +26)
	; __s8 ext_err = 0;
	15: (b4) w9 = 0
	; if (unlikely(!is_valid_lxc_src_ipv4(ip4)))
	16: (5e) if w2 != w1 goto pc+1152
	 R0=inv(id=0) R1=inv3238261770 R2=inv3238261770 R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967164 R9=inv0 R10=fp0 fp-128=ctx
	17: (b4) w1 = 0
	; struct ipv4_ct_tuple tuple = {};
	18: (6b) *(u16 *)(r10 -92) = r1
	last_idx 18 first_idx 16
	regs=2 stack=0 before 17: (b4) w1 = 0
	19: (63) *(u32 *)(r10 -96) = r1
	; struct lb4_key key = {};
	20: (63) *(u32 *)(r10 -112) = r1
	21: (b7) r1 = 0
	22: (7b) *(u64 *)(r10 -120) = r1
	last_idx 22 first_idx 16
	regs=2 stack=0 before 21: (b7) r1 = 0
	23: (b4) w8 = -158
	; return ip4->frag_off & bpf_htons(0x1FFF);
	24: (69) r1 = *(u16 *)(r7 +20)
	; tuple->nexthdr = ip4->protocol;
	25: (63) *(u32 *)(r10 -132) = r1
	26: (71) r1 = *(u8 *)(r7 +23)
	; tuple->nexthdr = ip4->protocol;
	27: (73) *(u8 *)(r10 -92) = r1
	; tuple->daddr = ip4->daddr;
	28: (61) r2 = *(u32 *)(r7 +30)
	; tuple->daddr = ip4->daddr;
	29: (63) *(u32 *)(r10 -104) = r2
	; tuple->saddr = ip4->saddr;
	30: (61) r3 = *(u32 *)(r7 +26)
	; tuple->saddr = ip4->saddr;
	31: (63) *(u32 *)(r10 -100) = r3
	; return ip4->ihl * 4;
	32: (71) r9 = *(u8 *)(r7 +14)
	; return ip4->ihl * 4;
	33: (64) w9 <<= 2
	34: (54) w9 &= 60
	; *l4_off = l3_off + ipv4_hdrlen(ip4);
	35: (04) w9 += 14
	; switch (tuple->nexthdr) {
	36: (16) if w1 == 0x1 goto pc+113
	 R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2_w=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3_w=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967138 R9_w=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120_w=00000000 fp-128=ctx fp-136=mmmm????
	37: (16) if w1 == 0x11 goto pc+1
	 R0=inv(id=0) R1=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	38: (56) if w1 != 0x6 goto pc+29
	 R0=inv(id=0) R1=inv6 R2=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; struct ipv4_frag_id frag_id = {
	39: (63) *(u32 *)(r10 -20) = r3
	40: (63) *(u32 *)(r10 -24) = r2
	; .id = ip4->id,
	41: (69) r2 = *(u16 *)(r7 +18)
	42: (b4) w3 = 0
	; struct ipv4_frag_id frag_id = {
	43: (73) *(u8 *)(r10 -13) = r3
	last_idx 43 first_idx 37
	regs=8 stack=0 before 42: (b4) w3 = 0
	44: (73) *(u8 *)(r10 -14) = r1
	45: (6b) *(u16 *)(r10 -16) = r2
	; return ip4->frag_off & bpf_htons(0x3FFF);
	46: (61) r1 = *(u32 *)(r10 -132)
	47: (54) w1 &= 65343
	; if (unlikely(is_fragment)) {
	48: (16) if w1 == 0x0 goto pc+45
	 R0=inv(id=0) R1=inv(id=0,umax_value=65343,var_off=(0x0; 0xff3f)) R2=inv(id=0,umax_value=65535,var_off=(0x0; 0xffff)) R3=invP0 R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; return ctx->len;
	49: (61) r6 = *(u32 *)(r6 +0)
	50: (b7) r1 = 0
	; struct metrics_value *entry, new_entry = {};
	51: (7b) *(u64 *)(r10 -72) = r1
	last_idx 51 first_idx 48
	regs=2 stack=0 before 50: (b7) r1 = 0
	52: (7b) *(u64 *)(r10 -80) = r1
	53: (b7) r1 = 521
	; struct metrics_key key = {};
	54: (7b) *(u64 *)(r10 -88) = r1
	55: (bf) r2 = r10
	;
	56: (07) r2 += -88
	; entry = map_lookup_elem(&METRICS_MAP, &key);
	57: (18) r1 = 0xffff413a9dac6800
	59: (85) call bpf_map_lookup_elem#1
	; if (entry) {
	60: (15) if r0 == 0x0 goto pc+9
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; entry->count += 1;
	61: (79) r1 = *(u64 *)(r0 +0)
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	62: (07) r1 += 1
	63: (7b) *(u64 *)(r0 +0) = r1
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; entry->bytes += bytes;
	64: (79) r1 = *(u64 *)(r0 +8)
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	65: (0f) r1 += r6
	66: (7b) *(u64 *)(r0 +8) = r1
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	67: (05) goto pc+13
	; return ip4->frag_off & bpf_htons(0x1FFF);
	81: (69) r1 = *(u16 *)(r7 +20)
	; return ip4->frag_off & bpf_htons(0x1FFF);
	82: (54) w1 &= 65311
	83: (79) r6 = *(u64 *)(r10 -128)
	; if (likely(not_first_fragment))
	84: (16) if w1 == 0x0 goto pc+9
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0,umax_value=65311,var_off=(0x0; 0xff1f)) R6_w=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	85: (bf) r2 = r10
	;
	86: (07) r2 += -24
	; tmp = map_lookup_elem(&IPV4_FRAG_DATAGRAMS_MAP, frag_id);
	87: (18) r1 = 0xffff413b1d08e000
	89: (85) call bpf_map_lookup_elem#1
	; if (!tmp)
	90: (55) if r0 != 0x0 goto pc+1327
	
	from 90 to 1418: R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; case  4: __it_mob(d, s, 32);
	1418: (61) r1 = *(u32 *)(r0 +0)
	 R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	1419: (63) *(u32 *)(r10 -96) = r1
	1420: (05) goto pc-1272
	; map_update_elem(&METRICS_MAP, &key, &new_entry, 0);
	149: (b4) w8 = 0
	150: (b4) w1 = 1
	; if (IS_ERR(ret)) {
	151: (16) if w8 == 0x2 goto pc+1
	last_idx 151 first_idx 149
	regs=100 stack=0 before 150: (b4) w1 = 1
	regs=100 stack=0 before 149: (b4) w8 = 0
	152: (b4) w1 = 0
	153: (bc) w2 = w8
	154: (74) w2 >>= 31
	155: (4c) w2 |= w1
	; if (IS_ERR(ret)) {
	156: (16) if w2 == 0x0 goto pc+8
	; if (ret == DROP_NO_SERVICE || ret == DROP_UNKNOWN_L4)
	165: (63) *(u32 *)(r10 -148) = r9
	; key->address = tuple->daddr;
	166: (61) r1 = *(u32 *)(r10 -104)
	; key->address = tuple->daddr;
	167: (63) *(u32 *)(r10 -120) = r1
	; key->dport = tuple->sport;
	168: (69) r1 = *(u16 *)(r10 -94)
	; key->dport = tuple->sport;
	169: (6b) *(u16 *)(r10 -116) = r1
	170: (b4) w8 = -134
	171: (b4) w9 = 0
	; key->proto = 0;
	172: (73) *(u8 *)(r10 -112) = r9
	last_idx 172 first_idx 165
	regs=200 stack=0 before 171: (b4) w9 = 0
	; return (void *)(unsigned long)ctx->data_end;
	173: (61) r1 = *(u32 *)(r6 +80)
	; return (void *)(unsigned long)ctx->data;
	174: (61) r2 = *(u32 *)(r6 +76)
	; if (data + tot_len > data_end)
	175: (07) r2 += 34
	; if (data + tot_len > data_end)
	176: (2d) if r2 > r1 goto pc+992
	 R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R1_w=pkt_end(id=0,off=0,imm=0) R2_w=pkt(id=0,off=34,r=34,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967162 R9_w=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????0000 fp-120=00mmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	177: (b4) w6 = 0
	; key->backend_slot = 0;
	178: (6b) *(u16 *)(r10 -114) = r6
	last_idx 178 first_idx 165
	regs=40 stack=0 before 177: (b4) w6 = 0
	; key->scope = LB_LOOKUP_SCOPE_EXT;
	179: (73) *(u8 *)(r10 -111) = r6
	180: (bf) r2 = r10
	;
	181: (07) r2 += -120
	; svc = map_lookup_elem(&LB4_SERVICES_MAP_V2, key);
	182: (18) r1 = 0xffff413a9da6cc00
	184: (85) call bpf_map_lookup_elem#1
	185: (b7) r2 = 0
	; if (svc) {
	186: (15) if r0 == 0x0 goto pc+12
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R2_w=inv0 R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	; return svc->flags2 & SVC_FLAG_TWO_SCOPES;
	187: (71) r1 = *(u8 *)(r0 +9)
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R2_w=inv0 R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	; return svc->flags2 & SVC_FLAG_TWO_SCOPES;
	188: (54) w1 &= 32
	189: (bf) r2 = r0
	; if (!scope_switch || !lb4_svc_is_two_scopes(svc))
	190: (16) if w1 == 0x0 goto pc+8
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R1_w=inv(id=0,umax_value=32,var_off=(0x0; 0x20)) R2_w=map_value(id=0,off=0,ks=12,vs=12,imm=0) R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	191: (b4) w1 = 1
	; key->scope = LB_LOOKUP_SCOPE_INT;
	192: (73) *(u8 *)(r10 -111) = r1
	193: (bf) r2 = r10
	194: (07) r2 += -120
	; svc = map_lookup_elem(&LB4_SERVICES_MAP_V2, key);
	195: (18) r1 = 0xffff413a9da6cc00
	197: (85) call bpf_map_lookup_elem#1
	198: (bf) r2 = r0
	; __u8 flags = tuple->flags;
	199: (71) r7 = *(u8 *)(r10 -91)
	; __be32 saddr = tuple->saddr;
	200: (61) r1 = *(u32 *)(r10 -100)
	; if (tuple->nexthdr == IPPROTO_TCP)
	201: (63) *(u32 *)(r10 -136) = r1
	202: (71) r9 = *(u8 *)(r10 -92)
	; __be32 new_saddr = 0;
	203: (63) *(u32 *)(r10 -88) = r6
	;
	204: (18) r1 = 0xffff413ab6a7c800
	206: (7b) *(u64 *)(r10 -144) = r1
	207: (16) if w9 == 0x6 goto pc+3
	 R0=map_value_or_null(id=5,off=0,ks=12,vs=12,imm=0) R1_w=map_ptr(id=0,off=0,ks=14,vs=56,imm=0) R2_w=map_value_or_null(id=5,off=0,ks=12,vs=12,imm=0) R6=invP0 R7_w=invP0 R8=inv4294967162 R9_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmm0000 fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmmmmmm fp-144_w=map_ptr fp-152=mmmm????
	208: (18) r1 = 0xffff413ab6a7c400
	210: (7b) *(u64 *)(r10 -144) = r1
	211: (b4) w8 = -158
	; if (unlikely(svc->count == 0))
	212: (69) r1 = *(u16 *)(r2 +4)
	R2 invalid mem access 'map_value_or_null'
	processed 211 insns (limit 1000000) max_states_per_insn 1 total_states 15 peak_states 15 mark_read 8
level=warning msg="JoinEP: Failed to attach program(s)" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" file-path=705_next/bpf_lxc.o identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=datapath-loader veth=lxc_health
level=error msg="Error while rewriting endpoint BPF program" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting endpoint changes after BPF regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting proxy redirect removals" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting proxy redirect removals" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting xDS network policy update" subsys=envoy-manager
level=debug msg="preparing new cache transaction: upserting 0 entries, deleting 1 entries" subsys=xds xdsCachedVersion=11 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="deleting resource from cache" subsys=xds xdsCachedVersion=11 xdsResourceName=705 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="committing cache transaction and notifying of new version" subsys=xds xdsCachedVersion=11 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="Finished reverting xDS network policy update" subsys=envoy-manager
level=debug msg="Reverting proxy redirect additions" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting proxy redirect additions" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting endpoint changes after BPF regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=info msg="Wrote verifier log to endpoint directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/verifier.log identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=info msg="generating BPF for endpoint failed, keeping stale directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" file-path=705_next_fail identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next_fail endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Completed endpoint regeneration with no pending regeneration requests" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=ready identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=warning msg="Regeneration of endpoint failed" bpfCompilation=0s bpfLoadProg=45.073208ms bpfWaitForELF="6.292µs" bpfWriteELF=1.515625ms containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ mapSync="62.25µs" policyCalculation="94.959µs" prepareBuild=1.343583ms proxyConfiguration="39.458µs" proxyPolicyCalculation="156µs" proxyWaitForAck=0s reason="retrying regeneration" subsys=endpoint total=56.805792ms waitingForCTClean=4.894375ms waitingForLock="8.166µs"
level=debug msg="Error regenerating endpoint: loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" code=Failure containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=ready identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=200
level=debug msg="EventQueue event processing statistics" eventConsumeOffQueueWaitTime="75.042µs" eventEnqueueWaitTime="46.459µs" eventHandlingDuration=57.034ms eventType="*endpoint.EndpointRegenerationEvent" name=endpoint-705 subsys=eventqueue
level=error msg="endpoint regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Controller func execution time: 57.725375ms" name=endpoint-705-regeneration-recovery subsys=controller uuid=4ccac62f-bde0-4fd5-820e-748cf19b0bd1
level=debug msg="Controller run failed" consecutiveErrors=2 error="regeneration recovery failed" name=endpoint-705-regeneration-recovery subsys=controller uuid=4ccac62f-bde0-4fd5-820e-748cf19b0bd1
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Controller func execution time: 166.083µs" name=metricsmap-bpf-prom-sync subsys=controller uuid=e93fb8e5-7d52-4e3b-a7c4-8bc7f60ca14d
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Skipping CiliumEndpoint update because it has no k8s pod name" containerID= controller="sync-to-k8s-ciliumendpoint (115)" datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpointsynchronizer
level=debug msg="Controller func execution time: 51.375µs" name="sync-to-k8s-ciliumendpoint (115)" subsys=controller uuid=55b3147b-84ec-49ec-bbb8-6a00014f0e98
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Skipping CiliumEndpoint update because it has no k8s pod name" containerID= controller="sync-to-k8s-ciliumendpoint (705)" datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpointsynchronizer
level=debug msg="Controller func execution time: 275.708µs" name="sync-to-k8s-ciliumendpoint (705)" subsys=controller uuid=5ad2e8d2-4085-4019-b249-dd5bcaf8e742
level=debug msg="received signal that regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Triggering endpoint regeneration due to retrying regeneration" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=waiting-to-regenerate identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="Dequeued endpoint from build queue" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Regenerating endpoint" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ reason="retrying regeneration" startTime="2023-06-24 17:28:52.304457131 +0000 UTC m=+14.526269925" subsys=endpoint
level=debug msg="Regenerating endpoint: retrying regeneration" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=regenerating identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Starting policy recalculation..." containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Skipping unnecessary endpoint policy recalculation" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyChanged=true policyRevision.next=1 policyRevision.repo=1 subsys=endpoint
level=debug msg="preparing new cache transaction: upserting 1 entries, deleting 0 entries" subsys=xds xdsCachedVersion=12 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="inserting resource into cache" subsys=xds xdsCachedVersion=12 xdsResourceName=705 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="committing cache transaction and notifying of new version" subsys=xds xdsCachedVersion=12 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="BPF header file hashed (was: \"\")" bpfHeaderfileHash=86bea98f3e604d817401ad2b9fa935bde199f4e73c922857c07ae0ae05ed07ce containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/ep_config.h identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file with DNSRules" DNSRules="map[]" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/ep_config.h identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Preparing to compile BPF" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ regeneration-level=rewrite+load subsys=endpoint
level=debug msg="Load 1-min: 3.48 5-min: 1.69 15min: 1.14" endpointID=705 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1871 (47.57%) Free: 125 Buffers: 38 Cached: 1897" endpointID=705 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 510 (49.88%) Free: 513" endpointID=705 subsys=endpoint
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 6.40% MEM: 2.96% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 116 VMS: 784 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="Found variable with offset 85756" subsys=elf symbol=LXC_ID
level=debug msg="Found variable with offset 85752" subsys=elf symbol=LXC_IPV4
level=debug msg="Found variable with offset 85736" subsys=elf symbol=LXC_IP_1
level=debug msg="Found variable with offset 85740" subsys=elf symbol=LXC_IP_2
level=debug msg="Found variable with offset 85744" subsys=elf symbol=LXC_IP_3
level=debug msg="Found variable with offset 85748" subsys=elf symbol=LXC_IP_4
level=debug msg="Found variable with offset 85760" subsys=elf symbol=NODE_MAC_1
level=debug msg="Found variable with offset 85764" subsys=elf symbol=NODE_MAC_2
level=debug msg="Found variable with offset 85776" subsys=elf symbol=POLICY_VERDICT_LOG_FILTER
level=debug msg="Found variable with offset 85768" subsys=elf symbol=SECLABEL
level=debug msg="Found variable with offset 85772" subsys=elf symbol=SECLABEL_NB
level=debug msg="Found symbol referring to unknown section id 30" subsys=elf symbol=____license
level=debug msg="Skipping __send_drop_notify" subsys=elf
level=debug msg="Skipping cil_from_container" subsys=elf
level=debug msg="Skipping cil_to_container" subsys=elf
level=debug msg="Found symbol with offset 839416" subsys=elf symbol=cilium_auth_map
level=debug msg="Found symbol with offset 839048" subsys=elf symbol=cilium_call_policy
level=debug msg="Found symbol with offset 842501" subsys=elf symbol=cilium_calls_65535
level=debug msg="Found symbol with offset 839510" subsys=elf symbol=cilium_ct4_global
level=debug msg="Found symbol with offset 839488" subsys=elf symbol=cilium_ct_any4_global
level=debug msg="Found symbol with offset 839588" subsys=elf symbol=cilium_encrypt_state
level=debug msg="Found symbol with offset 839181" subsys=elf symbol=cilium_events
level=debug msg="Found symbol with offset 839654" subsys=elf symbol=cilium_ipcache
level=debug msg="Found symbol with offset 839242" subsys=elf symbol=cilium_ipv4_frag_datagrams
level=debug msg="Found symbol with offset 839009" subsys=elf symbol=cilium_lb4_affinity
level=debug msg="Found symbol with offset 843574" subsys=elf symbol=cilium_lb4_backends_v3
level=debug msg="Found symbol with offset 839158" subsys=elf symbol=cilium_lb4_reverse_nat
level=debug msg="Found symbol with offset 844261" subsys=elf symbol=cilium_lb4_services_v2
level=debug msg="Found symbol with offset 839669" subsys=elf symbol=cilium_lb4_source_range
level=debug msg="Found symbol with offset 839528" subsys=elf symbol=cilium_lb_affinity_match
level=debug msg="Found symbol with offset 839693" subsys=elf symbol=cilium_lxc
level=debug msg="Found symbol with offset 839302" subsys=elf symbol=cilium_metrics
level=debug msg="Found symbol with offset 839432" subsys=elf symbol=cilium_node_map
level=debug msg="Found symbol with offset 842883" subsys=elf symbol=cilium_nodeport_neigh4
level=debug msg="Found symbol with offset 842481" subsys=elf symbol=cilium_policy_65535
level=debug msg="Found symbol with offset 839553" subsys=elf symbol=cilium_runtime_config
level=debug msg="Found symbol with offset 839269" subsys=elf symbol=cilium_signals
level=debug msg="Found symbol with offset 839464" subsys=elf symbol=cilium_snat_v4_external
level=debug msg="Found symbol with offset 842858" subsys=elf symbol=cilium_tail_call_buffer4
level=debug msg="Skipping handle_policy" subsys=elf
level=debug msg="Skipping tail_handle_arp" subsys=elf
level=debug msg="Skipping tail_handle_ipv4" subsys=elf
level=debug msg="Skipping tail_handle_ipv4_cont" subsys=elf
level=debug msg="Skipping tail_handle_snat_fwd_ipv4" subsys=elf
level=debug msg="Skipping tail_ipv4_ct_egress" subsys=elf
level=debug msg="Skipping tail_ipv4_ct_ingress" subsys=elf
level=debug msg="Skipping tail_ipv4_to_endpoint" subsys=elf
level=debug msg="Skipping tail_rev_nodeport_lb4" subsys=elf
level=debug msg="Found section with offset 839105" subsys=elf symbol=.BTF.ext
level=debug msg="Found section with offset 839288" subsys=elf symbol=.debug_ranges
level=debug msg="Found section with offset 839368" subsys=elf symbol=to-container
level=debug msg="Found section with offset 839385" subsys=elf symbol=from-container
level=debug msg="Found section with offset 839452" subsys=elf symbol=.debug_info
level=debug msg="Found section with offset 839579" subsys=elf symbol=1/0xffff
level=debug msg="Found section with offset 839625" subsys=elf symbol=.debug_line
level=debug msg="Found section with offset 839641" subsys=elf symbol=.debug_frame
level=debug msg="Found section with offset 839708" subsys=elf symbol=.debug_loc
level=debug msg="Found section with offset 839790" subsys=elf symbol=.BTF
level=debug msg="Found section with offset 840219" subsys=elf symbol=2/29
level=debug msg="Found section with offset 840685" subsys=elf symbol=2/38
level=debug msg="Found section with offset 841389" subsys=elf symbol=2/27
level=debug msg="Found section with offset 841460" subsys=elf symbol=2/17
level=debug msg="Found section with offset 841507" subsys=elf symbol=2/7
level=debug msg="Found section with offset 842088" subsys=elf symbol=2/6
level=debug msg="Found section with offset 842677" subsys=elf symbol=2/25
level=debug msg="Found section with offset 844183" subsys=elf symbol=2/13
level=debug msg="Found section with offset 845521" subsys=elf symbol=2/1
level=debug msg="Finished writing ELF" error="<nil>" new-elf-path=705_next/bpf_lxc.o subsys=elf template-path=/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d/bpf_lxc.o
level=debug msg="Loading CollectionSpec from ELF" device=lxc_health ifindex=7 objPath=705_next/bpf_lxc.o subsys=datapath-loader
level=debug msg="Loading Collection into kernel" device=lxc_health ifindex=7 objPath=705_next/bpf_lxc.o subsys=datapath-loader
Verifier error: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)
Verifier log: load program: permission denied:
	btf_vmlinux is malformed
	R1 type=ctx expected=fp
	; int tail_handle_ipv4(struct __ctx_buff *ctx)
	0: (bf) r6 = r1
	; ctx_pull_data(ctx, tot_len);
	1: (b4) w2 = 34
	2: (85) call bpf_skb_pull_data#39
	3: (b4) w8 = -134
	; return (void *)(unsigned long)ctx->data_end;
	4: (61) r1 = *(u32 *)(r6 +80)
	; return (void *)(unsigned long)ctx->data;
	5: (61) r7 = *(u32 *)(r6 +76)
	; if (data + tot_len > data_end)
	6: (bf) r2 = r7
	7: (07) r2 += 34
	; __s8 ext_err = 0;
	8: (b4) w9 = 0
	9: (7b) *(u64 *)(r10 -128) = r6
	; if (data + tot_len > data_end)
	10: (2d) if r2 > r1 goto pc+1158
	 R0_w=inv(id=0) R1_w=pkt_end(id=0,off=0,imm=0) R2_w=pkt(id=0,off=34,r=34,imm=0) R6_w=ctx(id=0,off=0,imm=0) R7_w=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967162 R9_w=inv0 R10=fp0 fp-128_w=ctx
	11: (b4) w8 = -132
	; return ip4->saddr == LXC_IPV4;
	12: (18) r1 = 0xc103f40a
	; return ip4->saddr == LXC_IPV4;
	14: (61) r2 = *(u32 *)(r7 +26)
	; __s8 ext_err = 0;
	15: (b4) w9 = 0
	; if (unlikely(!is_valid_lxc_src_ipv4(ip4)))
	16: (5e) if w2 != w1 goto pc+1152
	 R0=inv(id=0) R1=inv3238261770 R2=inv3238261770 R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967164 R9=inv0 R10=fp0 fp-128=ctx
	17: (b4) w1 = 0
	; struct ipv4_ct_tuple tuple = {};
	18: (6b) *(u16 *)(r10 -92) = r1
	last_idx 18 first_idx 16
	regs=2 stack=0 before 17: (b4) w1 = 0
	19: (63) *(u32 *)(r10 -96) = r1
	; struct lb4_key key = {};
	20: (63) *(u32 *)(r10 -112) = r1
	21: (b7) r1 = 0
	22: (7b) *(u64 *)(r10 -120) = r1
	last_idx 22 first_idx 16
	regs=2 stack=0 before 21: (b7) r1 = 0
	23: (b4) w8 = -158
	; return ip4->frag_off & bpf_htons(0x1FFF);
	24: (69) r1 = *(u16 *)(r7 +20)
	; tuple->nexthdr = ip4->protocol;
	25: (63) *(u32 *)(r10 -132) = r1
	26: (71) r1 = *(u8 *)(r7 +23)
	; tuple->nexthdr = ip4->protocol;
	27: (73) *(u8 *)(r10 -92) = r1
	; tuple->daddr = ip4->daddr;
	28: (61) r2 = *(u32 *)(r7 +30)
	; tuple->daddr = ip4->daddr;
	29: (63) *(u32 *)(r10 -104) = r2
	; tuple->saddr = ip4->saddr;
	30: (61) r3 = *(u32 *)(r7 +26)
	; tuple->saddr = ip4->saddr;
	31: (63) *(u32 *)(r10 -100) = r3
	; return ip4->ihl * 4;
	32: (71) r9 = *(u8 *)(r7 +14)
	; return ip4->ihl * 4;
	33: (64) w9 <<= 2
	34: (54) w9 &= 60
	; *l4_off = l3_off + ipv4_hdrlen(ip4);
	35: (04) w9 += 14
	; switch (tuple->nexthdr) {
	36: (16) if w1 == 0x1 goto pc+113
	 R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2_w=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3_w=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967138 R9_w=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120_w=00000000 fp-128=ctx fp-136=mmmm????
	37: (16) if w1 == 0x11 goto pc+1
	 R0=inv(id=0) R1=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	38: (56) if w1 != 0x6 goto pc+29
	 R0=inv(id=0) R1=inv6 R2=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; struct ipv4_frag_id frag_id = {
	39: (63) *(u32 *)(r10 -20) = r3
	40: (63) *(u32 *)(r10 -24) = r2
	; .id = ip4->id,
	41: (69) r2 = *(u16 *)(r7 +18)
	42: (b4) w3 = 0
	; struct ipv4_frag_id frag_id = {
	43: (73) *(u8 *)(r10 -13) = r3
	last_idx 43 first_idx 37
	regs=8 stack=0 before 42: (b4) w3 = 0
	44: (73) *(u8 *)(r10 -14) = r1
	45: (6b) *(u16 *)(r10 -16) = r2
	; return ip4->frag_off & bpf_htons(0x3FFF);
	46: (61) r1 = *(u32 *)(r10 -132)
	47: (54) w1 &= 65343
	; if (unlikely(is_fragment)) {
	48: (16) if w1 == 0x0 goto pc+45
	 R0=inv(id=0) R1=inv(id=0,umax_value=65343,var_off=(0x0; 0xff3f)) R2=inv(id=0,umax_value=65535,var_off=(0x0; 0xffff)) R3=invP0 R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; return ctx->len;
	49: (61) r6 = *(u32 *)(r6 +0)
	50: (b7) r1 = 0
	; struct metrics_value *entry, new_entry = {};
	51: (7b) *(u64 *)(r10 -72) = r1
	last_idx 51 first_idx 48
	regs=2 stack=0 before 50: (b7) r1 = 0
	52: (7b) *(u64 *)(r10 -80) = r1
	53: (b7) r1 = 521
	; struct metrics_key key = {};
	54: (7b) *(u64 *)(r10 -88) = r1
	55: (bf) r2 = r10
	;
	56: (07) r2 += -88
	; entry = map_lookup_elem(&METRICS_MAP, &key);
	57: (18) r1 = 0xffff413a9dac6800
	59: (85) call bpf_map_lookup_elem#1
	; if (entry) {
	60: (15) if r0 == 0x0 goto pc+9
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; entry->count += 1;
	61: (79) r1 = *(u64 *)(r0 +0)
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	62: (07) r1 += 1
	63: (7b) *(u64 *)(r0 +0) = r1
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; entry->bytes += bytes;
	64: (79) r1 = *(u64 *)(r0 +8)
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	65: (0f) r1 += r6
	66: (7b) *(u64 *)(r0 +8) = r1
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	67: (05) goto pc+13
	; return ip4->frag_off & bpf_htons(0x1FFF);
	81: (69) r1 = *(u16 *)(r7 +20)
	; return ip4->frag_off & bpf_htons(0x1FFF);
	82: (54) w1 &= 65311
	83: (79) r6 = *(u64 *)(r10 -128)
	; if (likely(not_first_fragment))
	84: (16) if w1 == 0x0 goto pc+9
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0,umax_value=65311,var_off=(0x0; 0xff1f)) R6_w=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	85: (bf) r2 = r10
	;
	86: (07) r2 += -24
	; tmp = map_lookup_elem(&IPV4_FRAG_DATAGRAMS_MAP, frag_id);
	87: (18) r1 = 0xffff413b1d08e000
	89: (85) call bpf_map_lookup_elem#1
	; if (!tmp)
	90: (55) if r0 != 0x0 goto pc+1327
	
	from 90 to 1418: R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; case  4: __it_mob(d, s, 32);
	1418: (61) r1 = *(u32 *)(r0 +0)
	 R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	1419: (63) *(u32 *)(r10 -96) = r1
	1420: (05) goto pc-1272
	; map_update_elem(&METRICS_MAP, &key, &new_entry, 0);
	149: (b4) w8 = 0
	150: (b4) w1 = 1
	; if (IS_ERR(ret)) {
	151: (16) if w8 == 0x2 goto pc+1
	last_idx 151 first_idx 149
	regs=100 stack=0 before 150: (b4) w1 = 1
	regs=100 stack=0 before 149: (b4) w8 = 0
	152: (b4) w1 = 0
	153: (bc) w2 = w8
	154: (74) w2 >>= 31
	155: (4c) w2 |= w1
	; if (IS_ERR(ret)) {
	156: (16) if w2 == 0x0 goto pc+8
	; if (ret == DROP_NO_SERVICE || ret == DROP_UNKNOWN_L4)
	165: (63) *(u32 *)(r10 -148) = r9
	; key->address = tuple->daddr;
	166: (61) r1 = *(u32 *)(r10 -104)
	; key->address = tuple->daddr;
	167: (63) *(u32 *)(r10 -120) = r1
	; key->dport = tuple->sport;
	168: (69) r1 = *(u16 *)(r10 -94)
	; key->dport = tuple->sport;
	169: (6b) *(u16 *)(r10 -116) = r1
	170: (b4) w8 = -134
	171: (b4) w9 = 0
	; key->proto = 0;
	172: (73) *(u8 *)(r10 -112) = r9
	last_idx 172 first_idx 165
	regs=200 stack=0 before 171: (b4) w9 = 0
	; return (void *)(unsigned long)ctx->data_end;
	173: (61) r1 = *(u32 *)(r6 +80)
	; return (void *)(unsigned long)ctx->data;
	174: (61) r2 = *(u32 *)(r6 +76)
	; if (data + tot_len > data_end)
	175: (07) r2 += 34
	; if (data + tot_len > data_end)
	176: (2d) if r2 > r1 goto pc+992
	 R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R1_w=pkt_end(id=0,off=0,imm=0) R2_w=pkt(id=0,off=34,r=34,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967162 R9_w=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????0000 fp-120=00mmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	177: (b4) w6 = 0
	; key->backend_slot = 0;
	178: (6b) *(u16 *)(r10 -114) = r6
	last_idx 178 first_idx 165
	regs=40 stack=0 before 177: (b4) w6 = 0
	; key->scope = LB_LOOKUP_SCOPE_EXT;
	179: (73) *(u8 *)(r10 -111) = r6
	180: (bf) r2 = r10
	;
	181: (07) r2 += -120
	; svc = map_lookup_elem(&LB4_SERVICES_MAP_V2, key);
	182: (18) r1 = 0xffff413a9da6cc00
	184: (85) call bpf_map_lookup_elem#1
	185: (b7) r2 = 0
	; if (svc) {
	186: (15) if r0 == 0x0 goto pc+12
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R2_w=inv0 R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	; return svc->flags2 & SVC_FLAG_TWO_SCOPES;
	187: (71) r1 = *(u8 *)(r0 +9)
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R2_w=inv0 R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	; return svc->flags2 & SVC_FLAG_TWO_SCOPES;
	188: (54) w1 &= 32
	189: (bf) r2 = r0
	; if (!scope_switch || !lb4_svc_is_two_scopes(svc))
	190: (16) if w1 == 0x0 goto pc+8
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R1_w=inv(id=0,umax_value=32,var_off=(0x0; 0x20)) R2_w=map_value(id=0,off=0,ks=12,vs=12,imm=0) R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	191: (b4) w1 = 1
	; key->scope = LB_LOOKUP_SCOPE_INT;
	192: (73) *(u8 *)(r10 -111) = r1
	193: (bf) r2 = r10
	194: (07) r2 += -120
	; svc = map_lookup_elem(&LB4_SERVICES_MAP_V2, key);
	195: (18) r1 = 0xffff413a9da6cc00
	197: (85) call bpf_map_lookup_elem#1
	198: (bf) r2 = r0
	; __u8 flags = tuple->flags;
	199: (71) r7 = *(u8 *)(r10 -91)
	; __be32 saddr = tuple->saddr;
	200: (61) r1 = *(u32 *)(r10 -100)
	; if (tuple->nexthdr == IPPROTO_TCP)
	201: (63) *(u32 *)(r10 -136) = r1
	202: (71) r9 = *(u8 *)(r10 -92)
	; __be32 new_saddr = 0;
	203: (63) *(u32 *)(r10 -88) = r6
	;
	204: (18) r1 = 0xffff413ab6a7c800
	206: (7b) *(u64 *)(r10 -144) = r1
	207: (16) if w9 == 0x6 goto pc+3
	 R0=map_value_or_null(id=5,off=0,ks=12,vs=12,imm=0) R1_w=map_ptr(id=0,off=0,ks=14,vs=56,imm=0) R2_w=map_value_or_null(id=5,off=0,ks=12,vs=12,imm=0) R6=invP0 R7_w=invP0 R8=inv4294967162 R9_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmm0000 fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmmmmmm fp-144_w=map_ptr fp-152=mmmm????
	208: (18) r1 = 0xffff413ab6a7c400
	210: (7b) *(u64 *)(r10 -144) = r1
	211: (b4) w8 = -158
	; if (unlikely(svc->count == 0))
	212: (69) r1 = *(u16 *)(r2 +4)
	R2 invalid mem access 'map_value_or_null'
	processed 211 insns (limit 1000000) max_states_per_insn 1 total_states 15 peak_states 15 mark_read 8
level=warning msg="JoinEP: Failed to attach program(s)" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" file-path=705_next/bpf_lxc.o identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=datapath-loader veth=lxc_health
level=error msg="Error while rewriting endpoint BPF program" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting endpoint changes after BPF regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting proxy redirect removals" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting proxy redirect removals" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting xDS network policy update" subsys=envoy-manager
level=debug msg="preparing new cache transaction: upserting 0 entries, deleting 1 entries" subsys=xds xdsCachedVersion=13 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="deleting resource from cache" subsys=xds xdsCachedVersion=13 xdsResourceName=705 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="committing cache transaction and notifying of new version" subsys=xds xdsCachedVersion=13 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="Finished reverting xDS network policy update" subsys=envoy-manager
level=debug msg="Reverting proxy redirect additions" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting proxy redirect additions" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting endpoint changes after BPF regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=info msg="Wrote verifier log to endpoint directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/verifier.log identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=info msg="generating BPF for endpoint failed, keeping stale directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" file-path=705_next_fail identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next_fail endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Completed endpoint regeneration with no pending regeneration requests" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=ready identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=warning msg="Regeneration of endpoint failed" bpfCompilation=0s bpfLoadProg=32.68575ms bpfWaitForELF="17.5µs" bpfWriteELF=1.560166ms containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ mapSync="85.417µs" policyCalculation="90.334µs" prepareBuild=1.817916ms proxyConfiguration="44.751µs" proxyPolicyCalculation="226.5µs" proxyWaitForAck=0s reason="retrying regeneration" subsys=endpoint total=49.94375ms waitingForCTClean=2.85325ms waitingForLock="6.75µs"
level=debug msg="Error regenerating endpoint: loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" code=Failure containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=ready identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=200
level=debug msg="EventQueue event processing statistics" eventConsumeOffQueueWaitTime="62.792µs" eventEnqueueWaitTime="30.875µs" eventHandlingDuration=50.121708ms eventType="*endpoint.EndpointRegenerationEvent" name=endpoint-705 subsys=eventqueue
level=error msg="endpoint regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Controller func execution time: 51.049834ms" name=endpoint-705-regeneration-recovery subsys=controller uuid=4ccac62f-bde0-4fd5-820e-748cf19b0bd1
level=debug msg="Controller run failed" consecutiveErrors=3 error="regeneration recovery failed" name=endpoint-705-regeneration-recovery subsys=controller uuid=4ccac62f-bde0-4fd5-820e-748cf19b0bd1
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Controller func execution time: 233.458µs" name=metricsmap-bpf-prom-sync subsys=controller uuid=e93fb8e5-7d52-4e3b-a7c4-8bc7f60ca14d
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Controller func execution time: 1.144666ms" name=link-cache subsys=controller uuid=6343ab4f-0ec4-4e9c-b348-16ed3270a4cd
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="stale identity observed" identity=2 ipAddr=172.27.0.5 oldIdentity=6 subsys=hubble
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="received signal that regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Triggering endpoint regeneration due to retrying regeneration" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=waiting-to-regenerate identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="Dequeued endpoint from build queue" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Regenerating endpoint" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ reason="retrying regeneration" startTime="2023-06-24 17:28:58.358095843 +0000 UTC m=+20.579908636" subsys=endpoint
level=debug msg="Regenerating endpoint: retrying regeneration" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=regenerating identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Starting policy recalculation..." containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Skipping unnecessary endpoint policy recalculation" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyChanged=true policyRevision.next=1 policyRevision.repo=1 subsys=endpoint
level=debug msg="preparing new cache transaction: upserting 1 entries, deleting 0 entries" subsys=xds xdsCachedVersion=14 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="inserting resource into cache" subsys=xds xdsCachedVersion=14 xdsResourceName=705 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="committing cache transaction and notifying of new version" subsys=xds xdsCachedVersion=14 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="BPF header file hashed (was: \"\")" bpfHeaderfileHash=86bea98f3e604d817401ad2b9fa935bde199f4e73c922857c07ae0ae05ed07ce containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/ep_config.h identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file with DNSRules" DNSRules="map[]" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/ep_config.h identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Preparing to compile BPF" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ regeneration-level=rewrite+load subsys=endpoint
level=debug msg="Found variable with offset 85756" subsys=elf symbol=LXC_ID
level=debug msg="Found variable with offset 85752" subsys=elf symbol=LXC_IPV4
level=debug msg="Found variable with offset 85736" subsys=elf symbol=LXC_IP_1
level=debug msg="Found variable with offset 85740" subsys=elf symbol=LXC_IP_2
level=debug msg="Found variable with offset 85744" subsys=elf symbol=LXC_IP_3
level=debug msg="Found variable with offset 85748" subsys=elf symbol=LXC_IP_4
level=debug msg="Found variable with offset 85760" subsys=elf symbol=NODE_MAC_1
level=debug msg="Found variable with offset 85764" subsys=elf symbol=NODE_MAC_2
level=debug msg="Found variable with offset 85776" subsys=elf symbol=POLICY_VERDICT_LOG_FILTER
level=debug msg="Found variable with offset 85768" subsys=elf symbol=SECLABEL
level=debug msg="Found variable with offset 85772" subsys=elf symbol=SECLABEL_NB
level=debug msg="Found symbol referring to unknown section id 30" subsys=elf symbol=____license
level=debug msg="Skipping __send_drop_notify" subsys=elf
level=debug msg="Skipping cil_from_container" subsys=elf
level=debug msg="Skipping cil_to_container" subsys=elf
level=debug msg="Found symbol with offset 839416" subsys=elf symbol=cilium_auth_map
level=debug msg="Found symbol with offset 839048" subsys=elf symbol=cilium_call_policy
level=debug msg="Found symbol with offset 842501" subsys=elf symbol=cilium_calls_65535
level=debug msg="Found symbol with offset 839510" subsys=elf symbol=cilium_ct4_global
level=debug msg="Found symbol with offset 839488" subsys=elf symbol=cilium_ct_any4_global
level=debug msg="Found symbol with offset 839588" subsys=elf symbol=cilium_encrypt_state
level=debug msg="Found symbol with offset 839181" subsys=elf symbol=cilium_events
level=debug msg="Found symbol with offset 839654" subsys=elf symbol=cilium_ipcache
level=debug msg="Found symbol with offset 839242" subsys=elf symbol=cilium_ipv4_frag_datagrams
level=debug msg="Found symbol with offset 839009" subsys=elf symbol=cilium_lb4_affinity
level=debug msg="Found symbol with offset 843574" subsys=elf symbol=cilium_lb4_backends_v3
level=debug msg="Found symbol with offset 839158" subsys=elf symbol=cilium_lb4_reverse_nat
level=debug msg="Found symbol with offset 844261" subsys=elf symbol=cilium_lb4_services_v2
level=debug msg="Found symbol with offset 839669" subsys=elf symbol=cilium_lb4_source_range
level=debug msg="Found symbol with offset 839528" subsys=elf symbol=cilium_lb_affinity_match
level=debug msg="Found symbol with offset 839693" subsys=elf symbol=cilium_lxc
level=debug msg="Found symbol with offset 839302" subsys=elf symbol=cilium_metrics
level=debug msg="Found symbol with offset 839432" subsys=elf symbol=cilium_node_map
level=debug msg="Found symbol with offset 842883" subsys=elf symbol=cilium_nodeport_neigh4
level=debug msg="Found symbol with offset 842481" subsys=elf symbol=cilium_policy_65535
level=debug msg="Found symbol with offset 839553" subsys=elf symbol=cilium_runtime_config
level=debug msg="Found symbol with offset 839269" subsys=elf symbol=cilium_signals
level=debug msg="Found symbol with offset 839464" subsys=elf symbol=cilium_snat_v4_external
level=debug msg="Found symbol with offset 842858" subsys=elf symbol=cilium_tail_call_buffer4
level=debug msg="Skipping handle_policy" subsys=elf
level=debug msg="Skipping tail_handle_arp" subsys=elf
level=debug msg="Skipping tail_handle_ipv4" subsys=elf
level=debug msg="Skipping tail_handle_ipv4_cont" subsys=elf
level=debug msg="Skipping tail_handle_snat_fwd_ipv4" subsys=elf
level=debug msg="Load 1-min: 3.28 5-min: 1.68 15min: 1.14" endpointID=705 subsys=endpoint
level=debug msg="Skipping tail_ipv4_ct_egress" subsys=elf
level=debug msg="Skipping tail_ipv4_ct_ingress" subsys=elf
level=debug msg="Skipping tail_ipv4_to_endpoint" subsys=elf
level=debug msg="Skipping tail_rev_nodeport_lb4" subsys=elf
level=debug msg="Found section with offset 839105" subsys=elf symbol=.BTF.ext
level=debug msg="Found section with offset 839288" subsys=elf symbol=.debug_ranges
level=debug msg="Found section with offset 839368" subsys=elf symbol=to-container
level=debug msg="Found section with offset 839385" subsys=elf symbol=from-container
level=debug msg="Found section with offset 839452" subsys=elf symbol=.debug_info
level=debug msg="Found section with offset 839579" subsys=elf symbol=1/0xffff
level=debug msg="Found section with offset 839625" subsys=elf symbol=.debug_line
level=debug msg="Found section with offset 839641" subsys=elf symbol=.debug_frame
level=debug msg="Found section with offset 839708" subsys=elf symbol=.debug_loc
level=debug msg="Found section with offset 839790" subsys=elf symbol=.BTF
level=debug msg="Found section with offset 840219" subsys=elf symbol=2/29
level=debug msg="Found section with offset 840685" subsys=elf symbol=2/38
level=debug msg="Found section with offset 841389" subsys=elf symbol=2/27
level=debug msg="Found section with offset 841460" subsys=elf symbol=2/17
level=debug msg="Found section with offset 841507" subsys=elf symbol=2/7
level=debug msg="Found section with offset 842088" subsys=elf symbol=2/6
level=debug msg="Found section with offset 842677" subsys=elf symbol=2/25
level=debug msg="Found section with offset 844183" subsys=elf symbol=2/13
level=debug msg="Found section with offset 845521" subsys=elf symbol=2/1
level=debug msg="Memory: Total: 3933 Used: 1867 (47.49%) Free: 134 Buffers: 37 Cached: 1893" endpointID=705 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 510 (49.88%) Free: 513" endpointID=705 subsys=endpoint
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 5.52% MEM: 2.79% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 109 VMS: 785 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="Finished writing ELF" error="<nil>" new-elf-path=705_next/bpf_lxc.o subsys=elf template-path=/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d/bpf_lxc.o
level=debug msg="Loading CollectionSpec from ELF" device=lxc_health ifindex=7 objPath=705_next/bpf_lxc.o subsys=datapath-loader
level=debug msg="Loading Collection into kernel" device=lxc_health ifindex=7 objPath=705_next/bpf_lxc.o subsys=datapath-loader
Verifier error: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)
Verifier log: load program: permission denied:
	btf_vmlinux is malformed
	R1 type=ctx expected=fp
	; int tail_handle_ipv4(struct __ctx_buff *ctx)
	0: (bf) r6 = r1
	; ctx_pull_data(ctx, tot_len);
	1: (b4) w2 = 34
	2: (85) call bpf_skb_pull_data#39
	3: (b4) w8 = -134
	; return (void *)(unsigned long)ctx->data_end;
	4: (61) r1 = *(u32 *)(r6 +80)
	; return (void *)(unsigned long)ctx->data;
	5: (61) r7 = *(u32 *)(r6 +76)
	; if (data + tot_len > data_end)
	6: (bf) r2 = r7
	7: (07) r2 += 34
	; __s8 ext_err = 0;
	8: (b4) w9 = 0
	9: (7b) *(u64 *)(r10 -128) = r6
	; if (data + tot_len > data_end)
	10: (2d) if r2 > r1 goto pc+1158
	 R0_w=inv(id=0) R1_w=pkt_end(id=0,off=0,imm=0) R2_w=pkt(id=0,off=34,r=34,imm=0) R6_w=ctx(id=0,off=0,imm=0) R7_w=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967162 R9_w=inv0 R10=fp0 fp-128_w=ctx
	11: (b4) w8 = -132
	; return ip4->saddr == LXC_IPV4;
	12: (18) r1 = 0xc103f40a
	; return ip4->saddr == LXC_IPV4;
	14: (61) r2 = *(u32 *)(r7 +26)
	; __s8 ext_err = 0;
	15: (b4) w9 = 0
	; if (unlikely(!is_valid_lxc_src_ipv4(ip4)))
	16: (5e) if w2 != w1 goto pc+1152
	 R0=inv(id=0) R1=inv3238261770 R2=inv3238261770 R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967164 R9=inv0 R10=fp0 fp-128=ctx
	17: (b4) w1 = 0
	; struct ipv4_ct_tuple tuple = {};
	18: (6b) *(u16 *)(r10 -92) = r1
	last_idx 18 first_idx 16
	regs=2 stack=0 before 17: (b4) w1 = 0
	19: (63) *(u32 *)(r10 -96) = r1
	; struct lb4_key key = {};
	20: (63) *(u32 *)(r10 -112) = r1
	21: (b7) r1 = 0
	22: (7b) *(u64 *)(r10 -120) = r1
	last_idx 22 first_idx 16
	regs=2 stack=0 before 21: (b7) r1 = 0
	23: (b4) w8 = -158
	; return ip4->frag_off & bpf_htons(0x1FFF);
	24: (69) r1 = *(u16 *)(r7 +20)
	; tuple->nexthdr = ip4->protocol;
	25: (63) *(u32 *)(r10 -132) = r1
	26: (71) r1 = *(u8 *)(r7 +23)
	; tuple->nexthdr = ip4->protocol;
	27: (73) *(u8 *)(r10 -92) = r1
	; tuple->daddr = ip4->daddr;
	28: (61) r2 = *(u32 *)(r7 +30)
	; tuple->daddr = ip4->daddr;
	29: (63) *(u32 *)(r10 -104) = r2
	; tuple->saddr = ip4->saddr;
	30: (61) r3 = *(u32 *)(r7 +26)
	; tuple->saddr = ip4->saddr;
	31: (63) *(u32 *)(r10 -100) = r3
	; return ip4->ihl * 4;
	32: (71) r9 = *(u8 *)(r7 +14)
	; return ip4->ihl * 4;
	33: (64) w9 <<= 2
	34: (54) w9 &= 60
	; *l4_off = l3_off + ipv4_hdrlen(ip4);
	35: (04) w9 += 14
	; switch (tuple->nexthdr) {
	36: (16) if w1 == 0x1 goto pc+113
	 R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2_w=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3_w=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967138 R9_w=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120_w=00000000 fp-128=ctx fp-136=mmmm????
	37: (16) if w1 == 0x11 goto pc+1
	 R0=inv(id=0) R1=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	38: (56) if w1 != 0x6 goto pc+29
	 R0=inv(id=0) R1=inv6 R2=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; struct ipv4_frag_id frag_id = {
	39: (63) *(u32 *)(r10 -20) = r3
	40: (63) *(u32 *)(r10 -24) = r2
	; .id = ip4->id,
	41: (69) r2 = *(u16 *)(r7 +18)
	42: (b4) w3 = 0
	; struct ipv4_frag_id frag_id = {
	43: (73) *(u8 *)(r10 -13) = r3
	last_idx 43 first_idx 37
	regs=8 stack=0 before 42: (b4) w3 = 0
	44: (73) *(u8 *)(r10 -14) = r1
	45: (6b) *(u16 *)(r10 -16) = r2
	; return ip4->frag_off & bpf_htons(0x3FFF);
	46: (61) r1 = *(u32 *)(r10 -132)
	47: (54) w1 &= 65343
	; if (unlikely(is_fragment)) {
	48: (16) if w1 == 0x0 goto pc+45
	 R0=inv(id=0) R1=inv(id=0,umax_value=65343,var_off=(0x0; 0xff3f)) R2=inv(id=0,umax_value=65535,var_off=(0x0; 0xffff)) R3=invP0 R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; return ctx->len;
	49: (61) r6 = *(u32 *)(r6 +0)
	50: (b7) r1 = 0
	; struct metrics_value *entry, new_entry = {};
	51: (7b) *(u64 *)(r10 -72) = r1
	last_idx 51 first_idx 48
	regs=2 stack=0 before 50: (b7) r1 = 0
	52: (7b) *(u64 *)(r10 -80) = r1
	53: (b7) r1 = 521
	; struct metrics_key key = {};
	54: (7b) *(u64 *)(r10 -88) = r1
	55: (bf) r2 = r10
	;
	56: (07) r2 += -88
	; entry = map_lookup_elem(&METRICS_MAP, &key);
	57: (18) r1 = 0xffff413a9dac6800
	59: (85) call bpf_map_lookup_elem#1
	; if (entry) {
	60: (15) if r0 == 0x0 goto pc+9
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; entry->count += 1;
	61: (79) r1 = *(u64 *)(r0 +0)
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	62: (07) r1 += 1
	63: (7b) *(u64 *)(r0 +0) = r1
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; entry->bytes += bytes;
	64: (79) r1 = *(u64 *)(r0 +8)
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	65: (0f) r1 += r6
	66: (7b) *(u64 *)(r0 +8) = r1
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	67: (05) goto pc+13
	; return ip4->frag_off & bpf_htons(0x1FFF);
	81: (69) r1 = *(u16 *)(r7 +20)
	; return ip4->frag_off & bpf_htons(0x1FFF);
	82: (54) w1 &= 65311
	83: (79) r6 = *(u64 *)(r10 -128)
	; if (likely(not_first_fragment))
	84: (16) if w1 == 0x0 goto pc+9
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0,umax_value=65311,var_off=(0x0; 0xff1f)) R6_w=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	85: (bf) r2 = r10
	;
	86: (07) r2 += -24
	; tmp = map_lookup_elem(&IPV4_FRAG_DATAGRAMS_MAP, frag_id);
	87: (18) r1 = 0xffff413b1d08e000
	89: (85) call bpf_map_lookup_elem#1
	; if (!tmp)
	90: (55) if r0 != 0x0 goto pc+1327
	
	from 90 to 1418: R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; case  4: __it_mob(d, s, 32);
	1418: (61) r1 = *(u32 *)(r0 +0)
	 R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	1419: (63) *(u32 *)(r10 -96) = r1
	1420: (05) goto pc-1272
	; map_update_elem(&METRICS_MAP, &key, &new_entry, 0);
	149: (b4) w8 = 0
	150: (b4) w1 = 1
	; if (IS_ERR(ret)) {
	151: (16) if w8 == 0x2 goto pc+1
	last_idx 151 first_idx 149
	regs=100 stack=0 before 150: (b4) w1 = 1
	regs=100 stack=0 before 149: (b4) w8 = 0
	152: (b4) w1 = 0
	153: (bc) w2 = w8
	154: (74) w2 >>= 31
	155: (4c) w2 |= w1
	; if (IS_ERR(ret)) {
	156: (16) if w2 == 0x0 goto pc+8
	; if (ret == DROP_NO_SERVICE || ret == DROP_UNKNOWN_L4)
	165: (63) *(u32 *)(r10 -148) = r9
	; key->address = tuple->daddr;
	166: (61) r1 = *(u32 *)(r10 -104)
	; key->address = tuple->daddr;
	167: (63) *(u32 *)(r10 -120) = r1
	; key->dport = tuple->sport;
	168: (69) r1 = *(u16 *)(r10 -94)
	; key->dport = tuple->sport;
	169: (6b) *(u16 *)(r10 -116) = r1
	170: (b4) w8 = -134
	171: (b4) w9 = 0
	; key->proto = 0;
	172: (73) *(u8 *)(r10 -112) = r9
	last_idx 172 first_idx 165
	regs=200 stack=0 before 171: (b4) w9 = 0
	; return (void *)(unsigned long)ctx->data_end;
	173: (61) r1 = *(u32 *)(r6 +80)
	; return (void *)(unsigned long)ctx->data;
	174: (61) r2 = *(u32 *)(r6 +76)
	; if (data + tot_len > data_end)
	175: (07) r2 += 34
	; if (data + tot_len > data_end)
	176: (2d) if r2 > r1 goto pc+992
	 R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R1_w=pkt_end(id=0,off=0,imm=0) R2_w=pkt(id=0,off=34,r=34,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967162 R9_w=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????0000 fp-120=00mmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	177: (b4) w6 = 0
	; key->backend_slot = 0;
	178: (6b) *(u16 *)(r10 -114) = r6
	last_idx 178 first_idx 165
	regs=40 stack=0 before 177: (b4) w6 = 0
	; key->scope = LB_LOOKUP_SCOPE_EXT;
	179: (73) *(u8 *)(r10 -111) = r6
	180: (bf) r2 = r10
	;
	181: (07) r2 += -120
	; svc = map_lookup_elem(&LB4_SERVICES_MAP_V2, key);
	182: (18) r1 = 0xffff413a9da6cc00
	184: (85) call bpf_map_lookup_elem#1
	185: (b7) r2 = 0
	; if (svc) {
	186: (15) if r0 == 0x0 goto pc+12
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R2_w=inv0 R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	; return svc->flags2 & SVC_FLAG_TWO_SCOPES;
	187: (71) r1 = *(u8 *)(r0 +9)
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R2_w=inv0 R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	; return svc->flags2 & SVC_FLAG_TWO_SCOPES;
	188: (54) w1 &= 32
	189: (bf) r2 = r0
	; if (!scope_switch || !lb4_svc_is_two_scopes(svc))
	190: (16) if w1 == 0x0 goto pc+8
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R1_w=inv(id=0,umax_value=32,var_off=(0x0; 0x20)) R2_w=map_value(id=0,off=0,ks=12,vs=12,imm=0) R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	191: (b4) w1 = 1
	; key->scope = LB_LOOKUP_SCOPE_INT;
	192: (73) *(u8 *)(r10 -111) = r1
	193: (bf) r2 = r10
	194: (07) r2 += -120
	; svc = map_lookup_elem(&LB4_SERVICES_MAP_V2, key);
	195: (18) r1 = 0xffff413a9da6cc00
	197: (85) call bpf_map_lookup_elem#1
	198: (bf) r2 = r0
	; __u8 flags = tuple->flags;
	199: (71) r7 = *(u8 *)(r10 -91)
	; __be32 saddr = tuple->saddr;
	200: (61) r1 = *(u32 *)(r10 -100)
	; if (tuple->nexthdr == IPPROTO_TCP)
	201: (63) *(u32 *)(r10 -136) = r1
	202: (71) r9 = *(u8 *)(r10 -92)
	; __be32 new_saddr = 0;
	203: (63) *(u32 *)(r10 -88) = r6
	;
	204: (18) r1 = 0xffff413ab6a7c800
	206: (7b) *(u64 *)(r10 -144) = r1
	207: (16) if w9 == 0x6 goto pc+3
	 R0=map_value_or_null(id=5,off=0,ks=12,vs=12,imm=0) R1_w=map_ptr(id=0,off=0,ks=14,vs=56,imm=0) R2_w=map_value_or_null(id=5,off=0,ks=12,vs=12,imm=0) R6=invP0 R7_w=invP0 R8=inv4294967162 R9_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmm0000 fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmmmmmm fp-144_w=map_ptr fp-152=mmmm????
	208: (18) r1 = 0xffff413ab6a7c400
	210: (7b) *(u64 *)(r10 -144) = r1
	211: (b4) w8 = -158
	; if (unlikely(svc->count == 0))
	212: (69) r1 = *(u16 *)(r2 +4)
	R2 invalid mem access 'map_value_or_null'
	processed 211 insns (limit 1000000) max_states_per_insn 1 total_states 15 peak_states 15 mark_read 8
level=warning msg="JoinEP: Failed to attach program(s)" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" file-path=705_next/bpf_lxc.o identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=datapath-loader veth=lxc_health
level=error msg="Error while rewriting endpoint BPF program" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting endpoint changes after BPF regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting proxy redirect removals" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting proxy redirect removals" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting xDS network policy update" subsys=envoy-manager
level=debug msg="preparing new cache transaction: upserting 0 entries, deleting 1 entries" subsys=xds xdsCachedVersion=15 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="deleting resource from cache" subsys=xds xdsCachedVersion=15 xdsResourceName=705 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="committing cache transaction and notifying of new version" subsys=xds xdsCachedVersion=15 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="Finished reverting xDS network policy update" subsys=envoy-manager
level=debug msg="Reverting proxy redirect additions" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting proxy redirect additions" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting endpoint changes after BPF regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=info msg="Wrote verifier log to endpoint directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/verifier.log identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=info msg="generating BPF for endpoint failed, keeping stale directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" file-path=705_next_fail identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next_fail endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Completed endpoint regeneration with no pending regeneration requests" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=ready identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=warning msg="Regeneration of endpoint failed" bpfCompilation=0s bpfLoadProg=25.141083ms bpfWaitForELF="20.958µs" bpfWriteELF=3.614958ms containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ mapSync="85.292µs" policyCalculation="89.417µs" prepareBuild=1.535375ms proxyConfiguration="96.376µs" proxyPolicyCalculation="174.708µs" proxyWaitForAck=0s reason="retrying regeneration" subsys=endpoint total=39.267ms waitingForCTClean=1.919084ms waitingForLock="5.667µs"
level=debug msg="Error regenerating endpoint: loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" code=Failure containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=ready identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=200
level=debug msg="EventQueue event processing statistics" eventConsumeOffQueueWaitTime="47.084µs" eventEnqueueWaitTime="7.208µs" eventHandlingDuration=39.466958ms eventType="*endpoint.EndpointRegenerationEvent" name=endpoint-705 subsys=eventqueue
level=error msg="endpoint regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Controller func execution time: 41.060875ms" name=endpoint-705-regeneration-recovery subsys=controller uuid=4ccac62f-bde0-4fd5-820e-748cf19b0bd1
level=debug msg="Controller run failed" consecutiveErrors=4 error="regeneration recovery failed" name=endpoint-705-regeneration-recovery subsys=controller uuid=4ccac62f-bde0-4fd5-820e-748cf19b0bd1
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Controller func execution time: 82.375µs" name=metricsmap-bpf-prom-sync subsys=controller uuid=e93fb8e5-7d52-4e3b-a7c4-8bc7f60ca14d
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Skipping CiliumEndpoint update because it has no k8s pod name" containerID= controller="sync-to-k8s-ciliumendpoint (115)" datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpointsynchronizer
level=debug msg="Controller func execution time: 215.875µs" name="sync-to-k8s-ciliumendpoint (115)" subsys=controller uuid=55b3147b-84ec-49ec-bbb8-6a00014f0e98
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Skipping CiliumEndpoint update because it has no k8s pod name" containerID= controller="sync-to-k8s-ciliumendpoint (705)" datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpointsynchronizer
level=debug msg="Controller func execution time: 361.083µs" name="sync-to-k8s-ciliumendpoint (705)" subsys=controller uuid=5ad2e8d2-4085-4019-b249-dd5bcaf8e742
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Controller func execution time: 252.084µs" name=metricsmap-bpf-prom-sync subsys=controller uuid=e93fb8e5-7d52-4e3b-a7c4-8bc7f60ca14d
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="received signal that regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Triggering endpoint regeneration due to retrying regeneration" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=waiting-to-regenerate identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="Dequeued endpoint from build queue" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Regenerating endpoint" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ reason="retrying regeneration" startTime="2023-06-24 17:29:06.400033471 +0000 UTC m=+28.621846223" subsys=endpoint
level=debug msg="Regenerating endpoint: retrying regeneration" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=regenerating identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Starting policy recalculation..." containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Skipping unnecessary endpoint policy recalculation" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyChanged=true policyRevision.next=1 policyRevision.repo=1 subsys=endpoint
level=debug msg="preparing new cache transaction: upserting 1 entries, deleting 0 entries" subsys=xds xdsCachedVersion=16 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="inserting resource into cache" subsys=xds xdsCachedVersion=16 xdsResourceName=705 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="committing cache transaction and notifying of new version" subsys=xds xdsCachedVersion=16 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="BPF header file hashed (was: \"\")" bpfHeaderfileHash=86bea98f3e604d817401ad2b9fa935bde199f4e73c922857c07ae0ae05ed07ce containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/ep_config.h identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="writing header file with DNSRules" DNSRules="map[]" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/ep_config.h identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Registered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_snat_v4_external subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct_any4_global subsys=bpf
level=debug msg="Unregistered BPF map" path=/sys/fs/bpf/tc/globals/cilium_ct4_global subsys=bpf
level=debug msg="Preparing to compile BPF" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ regeneration-level=rewrite+load subsys=endpoint
level=debug msg="Load 1-min: 2.78 5-min: 1.62 15min: 1.13" endpointID=705 subsys=endpoint
level=debug msg="Memory: Total: 3933 Used: 1919 (48.80%) Free: 99 Buffers: 36 Cached: 1877" endpointID=705 subsys=endpoint
level=debug msg="Swap: Total: 1023 Used: 510 (49.83%) Free: 513" endpointID=705 subsys=endpoint
level=debug msg="Found variable with offset 85756" subsys=elf symbol=LXC_ID
level=debug msg="Found variable with offset 85752" subsys=elf symbol=LXC_IPV4
level=debug msg="Found variable with offset 85736" subsys=elf symbol=LXC_IP_1
level=debug msg="Found variable with offset 85740" subsys=elf symbol=LXC_IP_2
level=debug msg="Found variable with offset 85744" subsys=elf symbol=LXC_IP_3
level=debug msg="Found variable with offset 85748" subsys=elf symbol=LXC_IP_4
level=debug msg="Found variable with offset 85760" subsys=elf symbol=NODE_MAC_1
level=debug msg="Found variable with offset 85764" subsys=elf symbol=NODE_MAC_2
level=debug msg="Found variable with offset 85776" subsys=elf symbol=POLICY_VERDICT_LOG_FILTER
level=debug msg="Found variable with offset 85768" subsys=elf symbol=SECLABEL
level=debug msg="Found variable with offset 85772" subsys=elf symbol=SECLABEL_NB
level=debug msg="Found symbol referring to unknown section id 30" subsys=elf symbol=____license
level=debug msg="Skipping __send_drop_notify" subsys=elf
level=debug msg="Skipping cil_from_container" subsys=elf
level=debug msg="Skipping cil_to_container" subsys=elf
level=debug msg="Found symbol with offset 839416" subsys=elf symbol=cilium_auth_map
level=debug msg="Found symbol with offset 839048" subsys=elf symbol=cilium_call_policy
level=debug msg="Found symbol with offset 842501" subsys=elf symbol=cilium_calls_65535
level=debug msg="Found symbol with offset 839510" subsys=elf symbol=cilium_ct4_global
level=debug msg="Found symbol with offset 839488" subsys=elf symbol=cilium_ct_any4_global
level=debug msg="Found symbol with offset 839588" subsys=elf symbol=cilium_encrypt_state
level=debug msg="Found symbol with offset 839181" subsys=elf symbol=cilium_events
level=debug msg="Found symbol with offset 839654" subsys=elf symbol=cilium_ipcache
level=debug msg="Found symbol with offset 839242" subsys=elf symbol=cilium_ipv4_frag_datagrams
level=debug msg="Found symbol with offset 839009" subsys=elf symbol=cilium_lb4_affinity
level=debug msg="Found symbol with offset 843574" subsys=elf symbol=cilium_lb4_backends_v3
level=debug msg="Found symbol with offset 839158" subsys=elf symbol=cilium_lb4_reverse_nat
level=debug msg="Found symbol with offset 844261" subsys=elf symbol=cilium_lb4_services_v2
level=debug msg="Found symbol with offset 839669" subsys=elf symbol=cilium_lb4_source_range
level=debug msg="Found symbol with offset 839528" subsys=elf symbol=cilium_lb_affinity_match
level=debug msg="Found symbol with offset 839693" subsys=elf symbol=cilium_lxc
level=debug msg="Found symbol with offset 839302" subsys=elf symbol=cilium_metrics
level=debug msg="Found symbol with offset 839432" subsys=elf symbol=cilium_node_map
level=debug msg="Found symbol with offset 842883" subsys=elf symbol=cilium_nodeport_neigh4
level=debug msg="Found symbol with offset 842481" subsys=elf symbol=cilium_policy_65535
level=debug msg="Found symbol with offset 839553" subsys=elf symbol=cilium_runtime_config
level=debug msg="Found symbol with offset 839269" subsys=elf symbol=cilium_signals
level=debug msg="Found symbol with offset 839464" subsys=elf symbol=cilium_snat_v4_external
level=debug msg="Found symbol with offset 842858" subsys=elf symbol=cilium_tail_call_buffer4
level=debug msg="Skipping handle_policy" subsys=elf
level=debug msg="Skipping tail_handle_arp" subsys=elf
level=debug msg="Skipping tail_handle_ipv4" subsys=elf
level=debug msg="Skipping tail_handle_ipv4_cont" subsys=elf
level=debug msg="Skipping tail_handle_snat_fwd_ipv4" subsys=elf
level=debug msg="Skipping tail_ipv4_ct_egress" subsys=elf
level=debug msg="Skipping tail_ipv4_ct_ingress" subsys=elf
level=debug msg="Skipping tail_ipv4_to_endpoint" subsys=elf
level=debug msg="Skipping tail_rev_nodeport_lb4" subsys=elf
level=debug msg="Found section with offset 839105" subsys=elf symbol=.BTF.ext
level=debug msg="NAME cilium-agent STATUS [sleep] PID 1 CPU: 4.42% MEM: 2.88% CMDLINE: cilium-agent --config-dir=/tmp/cilium/config-map MEM-EXT: RSS: 113 VMS: 785 Data: 0 Stack: 0 Locked: 0 Swap: 0" endpointID=705 subsys=endpoint
level=debug msg="Found section with offset 839288" subsys=elf symbol=.debug_ranges
level=debug msg="Found section with offset 839368" subsys=elf symbol=to-container
level=debug msg="Found section with offset 839385" subsys=elf symbol=from-container
level=debug msg="Found section with offset 839452" subsys=elf symbol=.debug_info
level=debug msg="Found section with offset 839579" subsys=elf symbol=1/0xffff
level=debug msg="Found section with offset 839625" subsys=elf symbol=.debug_line
level=debug msg="Found section with offset 839641" subsys=elf symbol=.debug_frame
level=debug msg="Found section with offset 839708" subsys=elf symbol=.debug_loc
level=debug msg="Found section with offset 839790" subsys=elf symbol=.BTF
level=debug msg="Found section with offset 840219" subsys=elf symbol=2/29
level=debug msg="Found section with offset 840685" subsys=elf symbol=2/38
level=debug msg="Found section with offset 841389" subsys=elf symbol=2/27
level=debug msg="Found section with offset 841460" subsys=elf symbol=2/17
level=debug msg="Found section with offset 841507" subsys=elf symbol=2/7
level=debug msg="Found section with offset 842088" subsys=elf symbol=2/6
level=debug msg="Found section with offset 842677" subsys=elf symbol=2/25
level=debug msg="Found section with offset 844183" subsys=elf symbol=2/13
level=debug msg="Found section with offset 845521" subsys=elf symbol=2/1
level=debug msg="Finished writing ELF" error="<nil>" new-elf-path=705_next/bpf_lxc.o subsys=elf template-path=/var/run/cilium/state/templates/70af7312e635393159051e10f1c8b9ceb026cb2c8a84f13ee8431f1c9365bd7d/bpf_lxc.o
level=debug msg="Loading CollectionSpec from ELF" device=lxc_health ifindex=7 objPath=705_next/bpf_lxc.o subsys=datapath-loader
level=debug msg="Loading Collection into kernel" device=lxc_health ifindex=7 objPath=705_next/bpf_lxc.o subsys=datapath-loader
Verifier error: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)
Verifier log: load program: permission denied:
	btf_vmlinux is malformed
	R1 type=ctx expected=fp
	; int tail_handle_ipv4(struct __ctx_buff *ctx)
	0: (bf) r6 = r1
	; ctx_pull_data(ctx, tot_len);
	1: (b4) w2 = 34
	2: (85) call bpf_skb_pull_data#39
	3: (b4) w8 = -134
	; return (void *)(unsigned long)ctx->data_end;
	4: (61) r1 = *(u32 *)(r6 +80)
	; return (void *)(unsigned long)ctx->data;
	5: (61) r7 = *(u32 *)(r6 +76)
	; if (data + tot_len > data_end)
	6: (bf) r2 = r7
	7: (07) r2 += 34
	; __s8 ext_err = 0;
	8: (b4) w9 = 0
	9: (7b) *(u64 *)(r10 -128) = r6
	; if (data + tot_len > data_end)
	10: (2d) if r2 > r1 goto pc+1158
	 R0_w=inv(id=0) R1_w=pkt_end(id=0,off=0,imm=0) R2_w=pkt(id=0,off=34,r=34,imm=0) R6_w=ctx(id=0,off=0,imm=0) R7_w=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967162 R9_w=inv0 R10=fp0 fp-128_w=ctx
	11: (b4) w8 = -132
	; return ip4->saddr == LXC_IPV4;
	12: (18) r1 = 0xc103f40a
	; return ip4->saddr == LXC_IPV4;
	14: (61) r2 = *(u32 *)(r7 +26)
	; __s8 ext_err = 0;
	15: (b4) w9 = 0
	; if (unlikely(!is_valid_lxc_src_ipv4(ip4)))
	16: (5e) if w2 != w1 goto pc+1152
	 R0=inv(id=0) R1=inv3238261770 R2=inv3238261770 R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967164 R9=inv0 R10=fp0 fp-128=ctx
	17: (b4) w1 = 0
	; struct ipv4_ct_tuple tuple = {};
	18: (6b) *(u16 *)(r10 -92) = r1
	last_idx 18 first_idx 16
	regs=2 stack=0 before 17: (b4) w1 = 0
	19: (63) *(u32 *)(r10 -96) = r1
	; struct lb4_key key = {};
	20: (63) *(u32 *)(r10 -112) = r1
	21: (b7) r1 = 0
	22: (7b) *(u64 *)(r10 -120) = r1
	last_idx 22 first_idx 16
	regs=2 stack=0 before 21: (b7) r1 = 0
	23: (b4) w8 = -158
	; return ip4->frag_off & bpf_htons(0x1FFF);
	24: (69) r1 = *(u16 *)(r7 +20)
	; tuple->nexthdr = ip4->protocol;
	25: (63) *(u32 *)(r10 -132) = r1
	26: (71) r1 = *(u8 *)(r7 +23)
	; tuple->nexthdr = ip4->protocol;
	27: (73) *(u8 *)(r10 -92) = r1
	; tuple->daddr = ip4->daddr;
	28: (61) r2 = *(u32 *)(r7 +30)
	; tuple->daddr = ip4->daddr;
	29: (63) *(u32 *)(r10 -104) = r2
	; tuple->saddr = ip4->saddr;
	30: (61) r3 = *(u32 *)(r7 +26)
	; tuple->saddr = ip4->saddr;
	31: (63) *(u32 *)(r10 -100) = r3
	; return ip4->ihl * 4;
	32: (71) r9 = *(u8 *)(r7 +14)
	; return ip4->ihl * 4;
	33: (64) w9 <<= 2
	34: (54) w9 &= 60
	; *l4_off = l3_off + ipv4_hdrlen(ip4);
	35: (04) w9 += 14
	; switch (tuple->nexthdr) {
	36: (16) if w1 == 0x1 goto pc+113
	 R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2_w=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3_w=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967138 R9_w=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120_w=00000000 fp-128=ctx fp-136=mmmm????
	37: (16) if w1 == 0x11 goto pc+1
	 R0=inv(id=0) R1=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	38: (56) if w1 != 0x6 goto pc+29
	 R0=inv(id=0) R1=inv6 R2=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R3=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; struct ipv4_frag_id frag_id = {
	39: (63) *(u32 *)(r10 -20) = r3
	40: (63) *(u32 *)(r10 -24) = r2
	; .id = ip4->id,
	41: (69) r2 = *(u16 *)(r7 +18)
	42: (b4) w3 = 0
	; struct ipv4_frag_id frag_id = {
	43: (73) *(u8 *)(r10 -13) = r3
	last_idx 43 first_idx 37
	regs=8 stack=0 before 42: (b4) w3 = 0
	44: (73) *(u8 *)(r10 -14) = r1
	45: (6b) *(u16 *)(r10 -16) = r2
	; return ip4->frag_off & bpf_htons(0x3FFF);
	46: (61) r1 = *(u32 *)(r10 -132)
	47: (54) w1 &= 65343
	; if (unlikely(is_fragment)) {
	48: (16) if w1 == 0x0 goto pc+45
	 R0=inv(id=0) R1=inv(id=0,umax_value=65343,var_off=(0x0; 0xff3f)) R2=inv(id=0,umax_value=65535,var_off=(0x0; 0xffff)) R3=invP0 R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; return ctx->len;
	49: (61) r6 = *(u32 *)(r6 +0)
	50: (b7) r1 = 0
	; struct metrics_value *entry, new_entry = {};
	51: (7b) *(u64 *)(r10 -72) = r1
	last_idx 51 first_idx 48
	regs=2 stack=0 before 50: (b7) r1 = 0
	52: (7b) *(u64 *)(r10 -80) = r1
	53: (b7) r1 = 521
	; struct metrics_key key = {};
	54: (7b) *(u64 *)(r10 -88) = r1
	55: (bf) r2 = r10
	;
	56: (07) r2 += -88
	; entry = map_lookup_elem(&METRICS_MAP, &key);
	57: (18) r1 = 0xffff413a9dac6800
	59: (85) call bpf_map_lookup_elem#1
	; if (entry) {
	60: (15) if r0 == 0x0 goto pc+9
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; entry->count += 1;
	61: (79) r1 = *(u64 *)(r0 +0)
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	62: (07) r1 += 1
	63: (7b) *(u64 *)(r0 +0) = r1
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; entry->bytes += bytes;
	64: (79) r1 = *(u64 *)(r0 +8)
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	65: (0f) r1 += r6
	66: (7b) *(u64 *)(r0 +8) = r1
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0) R6=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	67: (05) goto pc+13
	; return ip4->frag_off & bpf_htons(0x1FFF);
	81: (69) r1 = *(u16 *)(r7 +20)
	; return ip4->frag_off & bpf_htons(0x1FFF);
	82: (54) w1 &= 65311
	83: (79) r6 = *(u64 *)(r10 -128)
	; if (likely(not_first_fragment))
	84: (16) if w1 == 0x0 goto pc+9
	 R0=map_value(id=0,off=0,ks=8,vs=16,imm=0) R1_w=inv(id=0,umax_value=65311,var_off=(0x0; 0xff1f)) R6_w=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????0mmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	85: (bf) r2 = r10
	;
	86: (07) r2 += -24
	; tmp = map_lookup_elem(&IPV4_FRAG_DATAGRAMS_MAP, frag_id);
	87: (18) r1 = 0xffff413b1d08e000
	89: (85) call bpf_map_lookup_elem#1
	; if (!tmp)
	90: (55) if r0 != 0x0 goto pc+1327
	
	from 90 to 1418: R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	; case  4: __it_mob(d, s, 32);
	1418: (61) r1 = *(u32 *)(r0 +0)
	 R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967138 R9=inv(id=0,umin_value=14,umax_value=74,var_off=(0x2; 0x7c)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0m0000 fp-104=mmmmmmmm fp-112=????0000 fp-120=00000000 fp-128=ctx fp-136=mmmm????
	1419: (63) *(u32 *)(r10 -96) = r1
	1420: (05) goto pc-1272
	; map_update_elem(&METRICS_MAP, &key, &new_entry, 0);
	149: (b4) w8 = 0
	150: (b4) w1 = 1
	; if (IS_ERR(ret)) {
	151: (16) if w8 == 0x2 goto pc+1
	last_idx 151 first_idx 149
	regs=100 stack=0 before 150: (b4) w1 = 1
	regs=100 stack=0 before 149: (b4) w8 = 0
	152: (b4) w1 = 0
	153: (bc) w2 = w8
	154: (74) w2 >>= 31
	155: (4c) w2 |= w1
	; if (IS_ERR(ret)) {
	156: (16) if w2 == 0x0 goto pc+8
	; if (ret == DROP_NO_SERVICE || ret == DROP_UNKNOWN_L4)
	165: (63) *(u32 *)(r10 -148) = r9
	; key->address = tuple->daddr;
	166: (61) r1 = *(u32 *)(r10 -104)
	; key->address = tuple->daddr;
	167: (63) *(u32 *)(r10 -120) = r1
	; key->dport = tuple->sport;
	168: (69) r1 = *(u16 *)(r10 -94)
	; key->dport = tuple->sport;
	169: (6b) *(u16 *)(r10 -116) = r1
	170: (b4) w8 = -134
	171: (b4) w9 = 0
	; key->proto = 0;
	172: (73) *(u8 *)(r10 -112) = r9
	last_idx 172 first_idx 165
	regs=200 stack=0 before 171: (b4) w9 = 0
	; return (void *)(unsigned long)ctx->data_end;
	173: (61) r1 = *(u32 *)(r6 +80)
	; return (void *)(unsigned long)ctx->data;
	174: (61) r2 = *(u32 *)(r6 +76)
	; if (data + tot_len > data_end)
	175: (07) r2 += 34
	; if (data + tot_len > data_end)
	176: (2d) if r2 > r1 goto pc+992
	 R0=map_value(id=0,off=0,ks=12,vs=4,imm=0) R1_w=pkt_end(id=0,off=0,imm=0) R2_w=pkt(id=0,off=34,r=34,imm=0) R6=ctx(id=0,off=0,imm=0) R7=pkt(id=0,off=0,r=34,imm=0) R8_w=inv4294967162 R9_w=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????0000 fp-120=00mmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	177: (b4) w6 = 0
	; key->backend_slot = 0;
	178: (6b) *(u16 *)(r10 -114) = r6
	last_idx 178 first_idx 165
	regs=40 stack=0 before 177: (b4) w6 = 0
	; key->scope = LB_LOOKUP_SCOPE_EXT;
	179: (73) *(u8 *)(r10 -111) = r6
	180: (bf) r2 = r10
	;
	181: (07) r2 += -120
	; svc = map_lookup_elem(&LB4_SERVICES_MAP_V2, key);
	182: (18) r1 = 0xffff413a9da6cc00
	184: (85) call bpf_map_lookup_elem#1
	185: (b7) r2 = 0
	; if (svc) {
	186: (15) if r0 == 0x0 goto pc+12
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R2_w=inv0 R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	; return svc->flags2 & SVC_FLAG_TWO_SCOPES;
	187: (71) r1 = *(u8 *)(r0 +9)
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R2_w=inv0 R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	; return svc->flags2 & SVC_FLAG_TWO_SCOPES;
	188: (54) w1 &= 32
	189: (bf) r2 = r0
	; if (!scope_switch || !lb4_svc_is_two_scopes(svc))
	190: (16) if w1 == 0x0 goto pc+8
	 R0=map_value(id=0,off=0,ks=12,vs=12,imm=0) R1_w=inv(id=0,umax_value=32,var_off=(0x0; 0x20)) R2_w=map_value(id=0,off=0,ks=12,vs=12,imm=0) R6=invP0 R7=pkt(id=0,off=0,r=34,imm=0) R8=inv4294967162 R9=invP0 R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmmmmmm fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmm???? fp-152=mmmm????
	191: (b4) w1 = 1
	; key->scope = LB_LOOKUP_SCOPE_INT;
	192: (73) *(u8 *)(r10 -111) = r1
	193: (bf) r2 = r10
	194: (07) r2 += -120
	; svc = map_lookup_elem(&LB4_SERVICES_MAP_V2, key);
	195: (18) r1 = 0xffff413a9da6cc00
	197: (85) call bpf_map_lookup_elem#1
	198: (bf) r2 = r0
	; __u8 flags = tuple->flags;
	199: (71) r7 = *(u8 *)(r10 -91)
	; __be32 saddr = tuple->saddr;
	200: (61) r1 = *(u32 *)(r10 -100)
	; if (tuple->nexthdr == IPPROTO_TCP)
	201: (63) *(u32 *)(r10 -136) = r1
	202: (71) r9 = *(u8 *)(r10 -92)
	; __be32 new_saddr = 0;
	203: (63) *(u32 *)(r10 -88) = r6
	;
	204: (18) r1 = 0xffff413ab6a7c800
	206: (7b) *(u64 *)(r10 -144) = r1
	207: (16) if w9 == 0x6 goto pc+3
	 R0=map_value_or_null(id=5,off=0,ks=12,vs=12,imm=0) R1_w=map_ptr(id=0,off=0,ks=14,vs=56,imm=0) R2_w=map_value_or_null(id=5,off=0,ks=12,vs=12,imm=0) R6=invP0 R7_w=invP0 R8=inv4294967162 R9_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R10=fp0 fp-16=????mmmm fp-24=mmmmmmmm fp-72=00000000 fp-80=00000000 fp-88=mmmm0000 fp-96=??0mmmmm fp-104=mmmmmmmm fp-112=????mmmm fp-120=mmmmmmmm fp-128=ctx fp-136=mmmmmmmm fp-144_w=map_ptr fp-152=mmmm????
	208: (18) r1 = 0xffff413ab6a7c400
	210: (7b) *(u64 *)(r10 -144) = r1
	211: (b4) w8 = -158
	; if (unlikely(svc->count == 0))
	212: (69) r1 = *(u16 *)(r2 +4)
	R2 invalid mem access 'map_value_or_null'
	processed 211 insns (limit 1000000) max_states_per_insn 1 total_states 15 peak_states 15 mark_read 8
level=warning msg="JoinEP: Failed to attach program(s)" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" file-path=705_next/bpf_lxc.o identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=datapath-loader veth=lxc_health
level=error msg="Error while rewriting endpoint BPF program" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting endpoint changes after BPF regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting proxy redirect removals" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting proxy redirect removals" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Reverting xDS network policy update" subsys=envoy-manager
level=debug msg="preparing new cache transaction: upserting 0 entries, deleting 1 entries" subsys=xds xdsCachedVersion=17 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="deleting resource from cache" subsys=xds xdsCachedVersion=17 xdsResourceName=705 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="committing cache transaction and notifying of new version" subsys=xds xdsCachedVersion=17 xdsTypeURL=type.googleapis.com/cilium.NetworkPolicy
level=debug msg="Finished reverting xDS network policy update" subsys=envoy-manager
level=debug msg="Reverting proxy redirect additions" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting proxy redirect additions" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Finished reverting endpoint changes after BPF regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=info msg="Wrote verifier log to endpoint directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 file-path=705_next/verifier.log identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=info msg="generating BPF for endpoint failed, keeping stale directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" file-path=705_next_fail identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next_fail endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="removing directory" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 directory=705_next endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Completed endpoint regeneration with no pending regeneration requests" code=OK containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=ready identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=0
level=warning msg="Regeneration of endpoint failed" bpfCompilation=0s bpfLoadProg=29.375666ms bpfWaitForELF="12µs" bpfWriteELF=1.887708ms containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ mapSync="50.25µs" policyCalculation="132.959µs" prepareBuild="946.875µs" proxyConfiguration="54.459µs" proxyPolicyCalculation="132.209µs" proxyWaitForAck=0s reason="retrying regeneration" subsys=endpoint total=39.911667ms waitingForCTClean=3.461875ms waitingForLock="3.459µs"
level=debug msg="Error regenerating endpoint: loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" code=Failure containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 endpointState=ready identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ policyRevision=0 subsys=endpoint type=200
level=debug msg="EventQueue event processing statistics" eventConsumeOffQueueWaitTime="21.5µs" eventEnqueueWaitTime="4.416µs" eventHandlingDuration=40.222833ms eventType="*endpoint.EndpointRegenerationEvent" name=endpoint-705 subsys=eventqueue
level=error msg="endpoint regeneration failed" containerID= datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 error="loading eBPF collection into the kernel: program tail_handle_ipv4: load program: permission denied: 212: (69) r1 = *(u16 *)(r2 +4): R2 invalid mem access 'map_value_or_null' (240 line(s) omitted)" identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpoint
level=debug msg="Controller func execution time: 41.4795ms" name=endpoint-705-regeneration-recovery subsys=controller uuid=4ccac62f-bde0-4fd5-820e-748cf19b0bd1
level=debug msg="Controller run failed" consecutiveErrors=5 error="regeneration recovery failed" name=endpoint-705-regeneration-recovery subsys=controller uuid=4ccac62f-bde0-4fd5-820e-748cf19b0bd1
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Controller func execution time: 13.99875ms" name=k8s-heartbeat subsys=controller uuid=8b179a2a-bc87-4c5e-a743-24af6100c990
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Controller func execution time: 397.25µs" name=metricsmap-bpf-prom-sync subsys=controller uuid=e93fb8e5-7d52-4e3b-a7c4-8bc7f60ca14d
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Skipping CiliumEndpoint update because it has no k8s pod name" containerID= controller="sync-to-k8s-ciliumendpoint (115)" datapathPolicyRevision=1 desiredPolicyRevision=1 endpointID=115 identity=1 ipv4= ipv6= k8sPodName=/ subsys=endpointsynchronizer
level=debug msg="Controller func execution time: 1.221791ms" name="sync-to-k8s-ciliumendpoint (115)" subsys=controller uuid=55b3147b-84ec-49ec-bbb8-6a00014f0e98
level=debug msg="Controller func execution time: 18.959µs" name=neighbor-table-refresh subsys=controller uuid=0eb6e128-86c5-4262-b8bb-0e4370feeb67
level=debug msg="Controller func execution time: 150.833µs" name=link-cache subsys=controller uuid=6343ab4f-0ec4-4e9c-b348-16ed3270a4cd
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Cannot find socket" error="stat /var/run/cilium/health.sock: no such file or directory" file-path=/var/run/cilium/health.sock subsys=cilium-health-launcher
level=debug msg="Skipping CiliumEndpoint update because it has no k8s pod name" containerID= controller="sync-to-k8s-ciliumendpoint (705)" datapathPolicyRevision=0 desiredPolicyRevision=1 endpointID=705 identity=4 ipv4=10.244.3.193 ipv6= k8sPodName=/ subsys=endpointsynchronizer
level=debug msg="Controller func execution time: 289.834µs" name="sync-to-k8s-ciliumendpoint (705)" subsys=controller uuid=5ad2e8d2-4085-4019-b249-dd5bcaf8e742
